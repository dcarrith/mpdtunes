!function(b,a){function d(a,h){for(var f,e=[],q=0;q<a.length;++q){var l;if(!(l=g[a[q]]))a:{l=b;for(var c=a[q].split(/[.\/]/),d=0;d<c.length;++d){if(!l[c[d]]){l=void 0;break a}l=l[c[d]]}}if(f=l,!f)throw"module definition dependecy not found: "+a[q];e.push(f)}h.apply(null,e)}function c(b,h,f){if("string"!=typeof b)throw"invalid module definition, module id must be defined and be a string";if(h===a)throw"invalid module definition, dependencies must be specified";if(f===a)throw"invalid module definition, definition function must be specified";
d(h,function(){g[b]=f.apply(null,arguments)})}var g={};c("moxie/core/utils/Basic",[],function(){var a=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},b=function(q){return f(arguments,function(l,c){0<c&&f(l,function(f,l){void 0!==f&&(a(q[l])===a(f)&&~e(a(f),["array","object"])?b(q[l],f):q[l]=f)})}),q},f=function(a,e){var f,b;if(a){try{f=a.length}catch(h){f=void 0}if(void 0===f)for(b in a){if(a.hasOwnProperty(b)&&
!1===e(a[b],b))break}else for(b=0;f>b&&!1!==e(a[b],b);b++);}},e=function(a,e){if(e){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(e,a);for(var f=0,b=e.length;b>f;f++)if(e[f]===a)return f}return-1};return{guid:function(){var a=0;return function(e){var f=(new Date).getTime().toString(32),b;for(b=0;5>b;b++)f+=Math.floor(65535*Math.random()).toString(32);return(e||"o_")+f+(a++).toString(32)}}(),typeOf:a,extend:b,each:f,isEmptyObj:function(e){var f;if(!e||"object"!==a(e))return!0;for(f in e)return!1;
return!0},inSeries:function(e,f){function b(c){"function"===a(e[c])&&e[c](function(a){++c<h&&!a?b(c):f(a)})}var h=e.length;"function"!==a(f)&&(f=function(){});e&&e.length||f();b(0)},inArray:e,arrayDiff:function(f,b){var h=[];"array"!==a(f)&&(f=[f]);"array"!==a(b)&&(b=[b]);for(var c in f)-1===e(f[c],b)&&h.push(f[c]);return h.length?h:!1},arrayIntersect:function(a,b){var h=[];return f(a,function(a){-1!==e(a,b)&&h.push(a)}),h.length?h:null},toArray:function(a){var e,f=[];for(e=0;e<a.length;e++)f[e]=
a[e];return f},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},parseSizeStr:function(a){if("string"!=typeof a)return a;var e={t:1099511627776,g:1073741824,m:1048576,k:1024},f;return a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,"")),f=a[2],a=+a[1],e.hasOwnProperty(f)&&(a*=e[f]),a}}});c("moxie/core/I18n",["moxie/core/utils/Basic"],function(a){var b={};return{addI18n:function(f){return a.extend(b,
f)},translate:function(a){return b[a]||a},_:function(a){return this.translate(a)},sprintf:function(f){var e=[].slice.call(arguments,1),b="";return a.each(f.split(/%[a-z]/),function(a){b+=a;e.length&&(b+=e.shift())}),b}}});c("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(a,b){var f={mimes:{},extensions:{},addMimeType:function(a){a=a.split(/,/);var f,b,h;for(f=0;f<a.length;f+=2){h=a[f+1].split(/ /);for(b=0;b<h.length;b++)this.mimes[h[b]]=a[f];this.extensions[a[f]]=h}},
extList2mimes:function(e,f){var b,h,c,d,p=[];for(h=0;h<e.length;h++)for(b=e[h].extensions.split(/\s*,\s*/),c=0;c<b.length;c++){if("*"===b[c])return[];if(d=this.mimes[b[c]])-1===a.inArray(d,p)&&p.push(d);else{if(!f||!/^\w+$/.test(b[c]))return[];p.push("."+b[c])}}return p},mimes2extList:function(e){var f=this,c=[],d=[];return e=a.trim(e).split(/\s*,\s*/),"*"!==e&&a.each(e,function(e){var b=e.match(/^(\w+)\/(\*|\w+)$/);b&&("*"===b[2]?a.each(f.extensions,function(a,e){RegExp("^"+b[1]+"/").test(e)&&[].push.apply(c,
f.extensions[e])}):f.extensions[e]&&[].push.apply(c,f.extensions[e]))}),d.push({title:b.translate("Files"),extensions:c.length?c.join(","):"*"}),d.mimes=e,d},getFileExtension:function(a){return(a=a&&a.match(/\.([^.]+)$/))?a[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};return f.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/mp4,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe"),
f});c("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(a){function b(a){for(var e,f,h=0;h<a.length;h++)if(e=a[h].s1,f=a[h].prop,d=a[h].sv||a[h].id,e){if(-1!=e.indexOf(a[h].s2))return a[h].id}else if(f)return a[h].id}function f(a){var e=a.indexOf(d);if(-1!=e)return parseFloat(a.substring(e+d.length+1))}var e=[{s1:navigator.userAgent,s2:"Android",id:"Android Browser",sv:"Version"},{s1:navigator.userAgent,s2:"Chrome",id:"Chrome"},{s1:navigator.vendor,s2:"Apple",id:"Safari",sv:"Version"},{prop:window.opera&&
window.opera.buildNumber,id:"Opera",sv:"Version"},{s1:navigator.vendor,s2:"KDE",id:"Konqueror"},{s1:navigator.userAgent,s2:"Firefox",id:"Firefox"},{s1:navigator.vendor,s2:"Camino",id:"Camino"},{s1:navigator.userAgent,s2:"Netscape",id:"Netscape"},{s1:navigator.userAgent,s2:"MSIE",id:"IE",sv:"MSIE"},{s1:navigator.userAgent,s2:"Gecko",id:"Mozilla",sv:"rv"}],c=[{s1:navigator.platform,s2:"Win",id:"Windows"},{s1:navigator.platform,s2:"Mac",id:"Mac"},{s1:navigator.userAgent,s2:"iPhone",id:"iOS"},{s1:navigator.userAgent,
s2:"iPad",id:"iOS"},{s1:navigator.userAgent,s2:"Android",id:"Android"},{s1:navigator.platform,s2:"Linux",id:"Linux"}],d,r={can:function(){var e={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(e){try{if(-1!==a.inArray(e,["","text","document"]))return!0;if(window.XMLHttpRequest){var f=new XMLHttpRequest;if(f.open("get","/"),"responseType"in f)return f.responseType=e,f.responseType!==e?!1:
!0}}catch(b){}return!1},use_data_uri:function(){var a=new Image;return a.onload=function(){e.use_data_uri=1===a.width&&1===a.height},setTimeout(function(){a.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return e.use_data_uri&&("IE"!==r.browser||9<=r.version)},use_data_uri_of:function(a){return e.use_data_uri&&33E3>a||e.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");return a.setAttribute("type",
"file"),!a.disabled}};return function(f){var b=[].slice.call(arguments);return b.shift(),"function"===a.typeOf(e[f])?e[f].apply(this,b):!!e[f]}}(),browser:b(e),version:f(navigator.userAgent)||f(navigator.appVersion),OS:b(c),swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return r});c("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(a){var b=function(a,e){var b;return""===a.className?!1:(b=RegExp("(^|\\s+)"+
e+"(\\s+|$)"),b.test(a.className))};return{get:function(a){return"string"!=typeof a?a:document.getElementById(a)},hasClass:b,addClass:function(a,e){b(a,e)||(a.className=""===a.className?e:a.className.replace(/\s+$/,"")+" "+e)},removeClass:function(a,e){a.className=a.className.replace(RegExp("(^|\\s+)"+e+"(\\s+|$)"),function(a,e,f){return" "===e&&" "===f?" ":""})},getStyle:function(a,e){return a.currentStyle?a.currentStyle[e]:window.getComputedStyle?window.getComputedStyle(a,null)[e]:void 0},getPos:function(f,
e){function b(a){var e,f,h=0,c=0;return a&&(f=a.getBoundingClientRect(),e="CSS1Compat"===k.compatMode?k.documentElement:k.body,h=f.left+e.scrollLeft,c=f.top+e.scrollTop),{x:h,y:c}}var h=0,c=0,d,k=document,p;if(e=e||k.body,f&&f.getBoundingClientRect&&"IE"===a.browser&&(!k.documentMode||8>k.documentMode))return d=b(f),p=b(e),{x:d.x-p.x,y:d.y-p.y};for(d=f;d&&d!=e&&d.nodeType;)h+=d.offsetLeft||0,c+=d.offsetTop||0,d=d.offsetParent;for(d=f.parentNode;d&&d!=e&&d.nodeType;)h-=d.scrollLeft||0,c-=d.scrollTop||
0,d=d.parentNode;return{x:h,y:c}},getSize:function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight}}}});c("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(a){function b(a,e){for(var h in a)if(a[h]===e)return h;return null}return{RuntimeError:function(){function f(a){this.code=a;this.name=b(e,a);this.message=this.name+": RuntimeError "+this.code}var e={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return a.extend(f,e),f.prototype=Error.prototype,f}(),OperationNotAllowedException:function(){function f(a){this.code=
a;this.name="OperationNotAllowedException"}return a.extend(f,{NOT_ALLOWED_ERR:1}),f.prototype=Error.prototype,f}(),ImageError:function(){function f(a){this.code=a;this.name=b(e,a);this.message=this.name+": ImageError "+this.code}var e={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return a.extend(f,e),f.prototype=Error.prototype,f}(),FileException:function(){function f(a){this.code=a;this.name=b(e,a);this.message=this.name+": FileException "+this.code}var e={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,
ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return a.extend(f,e),f.prototype=Error.prototype,f}(),DOMException:function(){function f(a){this.code=a;this.name=b(e,a);this.message=this.name+": DOMException "+this.code}var e={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,
INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return a.extend(f,e),f.prototype=Error.prototype,f}(),EventException:function(){function f(a){this.code=a;this.name="EventException"}return a.extend(f,{UNSPECIFIED_EVENT_TYPE_ERR:0}),f.prototype=Error.prototype,f}()}});c("moxie/core/EventTarget",["moxie/core/Exceptions",
"moxie/core/utils/Basic"],function(a,b){function f(){var e={};b.extend(this,{uid:null,init:function(){this.uid||(this.uid=b.guid("uid_"))},addEventListener:function(a,f,c,d){var n=this,p;return a=b.trim(a),/\s/.test(a)?(b.each(a.split(/\s+/),function(a){n.addEventListener(a,f,c,d)}),void 0):(a=a.toLowerCase(),c=parseInt(c,10)||0,p=e[this.uid]&&e[this.uid][a]||[],p.push({fn:f,priority:c,scope:d||this}),e[this.uid]||(e[this.uid]={}),e[this.uid][a]=p,void 0)},hasEventListener:function(a){return a?!(!e[this.uid]||
!e[this.uid][a]):!!e[this.uid]},removeEventListener:function(a,f){a=a.toLowerCase();var c=e[this.uid]&&e[this.uid][a],d;if(c){if(f)for(d=c.length-1;0<=d;d--){if(c[d].fn===f){c.splice(d,1);break}}else c=[];c.length||(delete e[this.uid][a],b.isEmptyObj(e[this.uid])&&delete e[this.uid])}},removeAllEventListeners:function(){e[this.uid]&&delete e[this.uid]},dispatchEvent:function(f){var c,d,m,k={};if("string"!==b.typeOf(f)){if(d=f,"string"!==b.typeOf(d.type))throw new a.EventException(a.EventException.UNSPECIFIED_EVENT_TYPE_ERR);
f=d.type;d.total&&d.loaded&&(k.total=d.total,k.loaded=d.loaded);k.async=d.async||!1}if(-1!==f.indexOf("::")?function(a){c=a[0];f=a[1]}(f.split("::")):c=this.uid,f=f.toLowerCase(),d=e[c]&&e[c][f]){d.sort(function(a,e){return e.priority-a.priority});m=[].slice.call(arguments);m.shift();k.type=f;m.unshift(k);var p=[];b.each(d,function(a){m[0].target=a.scope;k.async?p.push(function(e){setTimeout(function(){e(!1===a.fn.apply(a.scope,m))},1)}):p.push(function(e){e(!1===a.fn.apply(a.scope,m))})});p.length&&
b.inSeries(p)}return!0},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var e;"array"!==b.typeOf(a)&&(a=[a]);for(var f=0;f<a.length;f++)e="on"+a[f],"function"===b.typeOf(this[e])?this.addEventListener(a[f],this[e]):"undefined"===b.typeOf(this[e])&&
(this[e]=null)}})}return f.instance=new f,f});c("moxie/core/utils/Encode",[],function(){var a=function(a){return unescape(encodeURIComponent(a))},b=function(a){return decodeURIComponent(escape(a))};return{utf8_encode:a,utf8_decode:b,atob:function(a,e){if("function"==typeof window.atob)return e?b(window.atob(a)):window.atob(a);var c,d,n,m,k,p=0,s=0,y="",x=[];if(!a)return a;a+="";do c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(p++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(p++)),
m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(p++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(p++)),n=c<<18|d<<12|m<<6|k,c=255&n>>16,d=255&n>>8,n&=255,x[s++]=64==m?String.fromCharCode(c):64==k?String.fromCharCode(c,d):String.fromCharCode(c,d,n);while(p<a.length);return y=x.join(""),e?b(y):y},btoa:function(f,e){if(e&&a(f),"function"==typeof window.btoa)return window.btoa(f);var b,c,d,h,k=0,p=0,s="",s=[];if(!f)return f;
do b=f.charCodeAt(k++),c=f.charCodeAt(k++),d=f.charCodeAt(k++),h=b<<16|c<<8|d,b=63&h>>18,c=63&h>>12,d=63&h>>6,h&=63,s[p++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h);while(k<f.length);s=s.join("");k=f.length%3;return(k?s.slice(0,k-3):
s)+"===".slice(k||3)}}});c("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(a,b,f){function e(f,c,q,p,s){var y=this,x,t=a.guid(c+"_");d[t]=this;q=a.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,
send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},q);x=function(){var e={};return{exec:function(a,f,b,c){return x[f]&&(e[a]||(e[a]={context:this,instance:new x[f]}),e[a].instance[b])?e[a].instance[b].apply(this,c):void 0},removeInstance:function(a){delete e[a]},removeAllInstances:function(){var f=this;a.each(e,function(e,b){"function"===a.typeOf(e.instance.destroy)&&e.instance.destroy.call(e.context);
f.removeInstance(b)})}}}();a.extend(this,{initialized:!1,uid:t,type:c,mode:null,shimid:t+"_container",clients:0,options:f,can:function(f,b,c){c=c||q;if("string"===a.typeOf(f)&&"undefined"===a.typeOf(b)&&(f=e.parseCaps(f)),"object"===a.typeOf(f)){for(var d in f)if(!this.can(d,f[d],c))return!1;return!0}return"function"===a.typeOf(c[f])?c[f].call(this,b):b===c[f]},getShimContainer:function(){var e,f=b.get(this.shimid);return f||(e=this.options.container?b.get(this.options.container):document.body,f=
document.createElement("div"),f.id=this.shimid,f.className="moxie-shim moxie-shim-"+this.type,a.extend(f.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),e.appendChild(f)),f},getShim:function(){return x},shimExec:function(a,e){var f=[].slice.call(arguments,2);return y.getShim().exec.call(this,this.uid,a,e,f)},exec:function(a,e){var f=[].slice.call(arguments,2);return y[a]&&y[a][e]?y[a][e].apply(this,f):y.shimExec.apply(this,arguments)},destroy:function(){if(y){var a=
b.get(this.shimid);a&&a.parentNode.removeChild(a);x&&x.removeAllInstances();this.unbindAll();delete d[this.uid];t=y=x=this.uid=null}}});(function(e,b){var c=null,d=f&&f.required_caps;return b=b||"browser",null!==this.mode?this.mode:(d&&!a.isEmptyObj(e)&&(a.each(d,function(f,b){if(e.hasOwnProperty(b)){var d=e[b](f);if("string"==typeof d&&(d=[d]),c){if(!(c=a.arrayIntersect(c,d)))return c=!1}else c=d}}),c?this.mode=-1!==a.inArray(b,c)?b:c[0]:!1===c&&(this.mode=!1)),null===this.mode&&(this.mode=b),this.mode&&
d&&!this.can(d)&&(this.mode=!1),void 0)}).call(this,p,s)}var c={},d={};return e.order="html5,flash,silverlight,html4",e.getRuntime=function(a){return d[a]?d[a]:!1},e.addConstructor=function(a,e){e.prototype=f.instance;c[a]=e},e.getConstructor=function(a){return c[a]||null},e.getInfo=function(a){var f=e.getRuntime(a);return f?{uid:f.uid,type:f.type,can:function(){return f.can.apply(f,arguments)}}:null},e.parseCaps=function(e){var f={};return"string"!==a.typeOf(e)?e||{}:(a.each(e.split(","),function(a){f[a]=
!0}),f)},e.can=function(a,f){var b,c=e.getConstructor(a),d;return c?(b=new c({required_caps:f}),d=b.mode,b.destroy(),!!d):!1},e.thatCan=function(a,f){var b=(f||e.order).split(/\s*,\s*/),c;for(c in b)if(e.can(b[c],a))return b[c];return null},e.capTrue=function(){return!0},e.capFalse=function(){return!1},e.capTest=function(a){return function(){return!!a}},e});c("moxie/runtime/RuntimeClient",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(a,b,f){return function(){var e;
b.extend(this,{connectRuntime:function(c){function d(b){var h,s;return b.length?(h=b.shift(),(s=f.getConstructor(h))?(e=new s(c),e.bind("Init",function(){e.initialized=!0;setTimeout(function(){e.clients++;r.trigger("RuntimeInit",e)},1)}),e.bind("Error",function(){e.destroy();d(b)}),e.mode?(e.init(),void 0):(e.trigger("Error"),void 0)):(d(b),void 0)):(r.trigger("RuntimeError",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR)),e=null,void 0)}var r=this,m;if("string"===b.typeOf(c)?m=c:"string"===b.typeOf(c.ruid)&&
(m=c.ruid),m){if(e=f.getRuntime(m))return e.clients++,e;throw new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR);}d((c.runtime_order||f.order).split(/\s*,\s*/))},getRuntime:function(){return e&&e.uid?e:(e=null,null)},disconnectRuntime:function(){e&&0>=--e.clients&&(e.destroy(),e=null)}})}});c("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(a,b,f){function e(d,r){function m(f,b,d){var h,l=c[this.uid];return"string"===a.typeOf(l)&&l.length?
(h=new e(null,{type:d,size:b-f}),h.detach(l.substr(f,h.size)),h):null}f.call(this);d&&this.connectRuntime(d);r?"string"===a.typeOf(r)&&(r={data:r}):r={};a.extend(this,{uid:r.uid||a.guid("uid_"),ruid:d,size:r.size||0,type:r.type||"",slice:function(a,e,f){return this.isDetached()?m.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,e,f)},getSource:function(){return c[this.uid]?c[this.uid]:null},detach:function(a){this.ruid&&(this.getRuntime().exec.call(this,"Blob",
"destroy",c[this.uid]),this.disconnectRuntime(),this.ruid=null);a=a||"";var e=a.match(/^data:([^;]*);base64,/);e&&(this.type=e[1],a=b.atob(a.substring(a.indexOf("base64,")+7)));this.size=a.length;c[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===a.typeOf(c[this.uid])},destroy:function(){this.detach();delete c[this.uid]}});r.data?this.detach(r.data):c[this.uid]=r}var c={};return e});c("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(a,
b,f){function e(e,c){var d,m;(c||(c={}),m=c.type&&""!==c.type?c.type:b.getFileMime(c.name),c.name)?(d=c.name.replace(/\\/g,"/"),d=d.substr(d.lastIndexOf("/")+1)):(d=m.split("/")[0],d=a.guid((""!==d?d:"file")+"_"),b.extensions[m]&&(d+="."+b.extensions[m][0]));f.apply(this,arguments);a.extend(this,{type:m||"",name:d||a.guid("file_"),lastModifiedDate:c.lastModifiedDate||(new Date).toLocaleString()})}return e.prototype=f.prototype,e});c("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/file/File moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),
function(a,b,f,e,c,d,r,m,k){function p(c){var q=this,p;if(-1!==a.inArray(a.typeOf(c),["string","node"])&&(c={browse_button:c}),p=f.get(c.browse_button),!p)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR);p={accept:[{title:d.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:p.parentNode||document.body};c=a.extend({},p,c);"string"==typeof c.required_caps&&(c.required_caps=m.parseCaps(c.required_caps));"string"==typeof c.accept&&(c.accept=b.mimes2extList(c.accept));
(p=f.get(c.container))||(p=document.body);"static"===f.getStyle(p,"position")&&(p.style.position="relative");p=p=null;k.call(q);a.extend(q,{uid:a.guid("uid_"),ruid:null,files:null,init:function(){q.convertEventPropsToHandlers(s);q.bind("RuntimeInit",function(e,b){q.ruid=b.uid;q.bind("Ready",function(){q.trigger("Refresh")},999);q.bind("Change",function(){var e=b.exec.call(q,"FileInput","getFiles");q.files=[];a.each(e,function(a){q.files.push(new r(q.ruid,a))})},999);q.bind("Refresh",function(){var e,
d,h,q;h=f.get(c.browse_button);q=f.get(b.shimid);h&&(e=f.getPos(h,f.get(c.container)),d=f.getSize(h),q&&a.extend(q.style,{top:e.y+"px",left:e.x+"px",width:d.w+"px",height:d.h+"px"}))});b.exec.call(q,"FileInput","init",c)});q.connectRuntime(a.extend({},c,{required_caps:{select_file:!0}}))},disable:function(e){var f=this.getRuntime();f&&f.exec.call(this,"FileInput","disable","undefined"===a.typeOf(e)?!0:e)},refresh:function(){q.trigger("Refresh")},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,
"FileInput","destroy"),this.disconnectRuntime());"array"===a.typeOf(this.files)&&a.each(this.files,function(a){a.destroy()});this.files=null}})}var s="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");return p.prototype=c.instance,p});c("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),function(a,b,f,e,c,d,r,m){function k(f){var k=
this,r;"string"==typeof f&&(f={drop_zone:f});r={accept:[{title:a.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};f="object"==typeof f?e.extend({},r,f):r;f.container=b.get(f.drop_zone)||document.body;"static"===b.getStyle(f.container,"position")&&(f.container.style.position="relative");"string"==typeof f.accept&&(f.accept=m.mimes2extList(f.accept));d.call(k);e.extend(k,{uid:e.guid("uid_"),ruid:null,files:null,init:function(){k.convertEventPropsToHandlers(p);k.bind("RuntimeInit",
function(a,b){k.ruid=b.uid;k.bind("Drop",function(){var a=b.exec.call(k,"FileDrop","getFiles");k.files=[];e.each(a,function(a){k.files.push(new c(k.ruid,a))})},999);b.exec.call(k,"FileDrop","init",f);k.dispatchEvent("ready")});k.connectRuntime(f)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null}})}var p=["ready","dragenter","dragleave","drop","error"];return k.prototype=r.instance,k});c("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic",
"moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(a,b,f){function e(){this.uid=a.guid("uid_");b.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}return e.prototype=f.instance,e});c("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/runtime/RuntimeTarget".split(" "),function(a,b,f,e,c,d,r){function m(){function e(a,n){function p(a){d.readyState=m.DONE;
d.error=a;d.trigger("error");g()}function g(){l.destroy();l=null;d.trigger("loadend")}function w(e){l.bind("Error",function(a,e){p(e)});l.bind("Progress",function(a){d.result=e.exec.call(l,"FileReader","getResult");d.trigger(a)});l.bind("Load",function(a){d.readyState=m.DONE;d.result=e.exec.call(l,"FileReader","getResult");d.trigger(a);g()});e.exec.call(l,"FileReader","read",a,n)}if(l=new r,this.convertEventPropsToHandlers(k),this.readyState===m.LOADING)return p(new f.DOMException(f.DOMException.INVALID_STATE_ERR));
if(this.readyState=m.LOADING,this.trigger("loadstart"),n instanceof c)if(n.isDetached()){var u=n.getSource();switch(a){case "readAsText":case "readAsBinaryString":this.result=u;break;case "readAsDataURL":this.result="data:"+n.type+";base64,"+b.btoa(u)}this.readyState=m.DONE;this.trigger("load");g()}else w(l.connectRuntime(n.ruid));else p(new f.DOMException(f.DOMException.NOT_FOUND_ERR))}var d=this,l;a.extend(this,{uid:a.guid("uid_"),readyState:m.EMPTY,result:null,error:null,readAsBinaryString:function(a){e.call(this,
"readAsBinaryString",a)},readAsDataURL:function(a){e.call(this,"readAsDataURL",a)},readAsText:function(a){e.call(this,"readAsText",a)},abort:function(){this.result=null;-1===a.inArray(this.readyState,[m.EMPTY,m.DONE])&&(this.readyState===m.LOADING&&(this.readyState=m.DONE),l&&l.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();l&&(l.getRuntime().exec.call(this,"FileReader","destroy"),l.disconnectRuntime());d=l=null}})}
var k="loadstart progress load abort error loadend".split(" ");return m.EMPTY=0,m.LOADING=1,m.DONE=2,m.prototype=e.instance,m});c("moxie/core/utils/Url",[],function(){var a=function(a){var f="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),e=f.length,b={http:80,https:443},c={};for(a=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(a||
"");e--;)a[e]&&(c[f[e]]=a[e]);/^[^\/]/.test(c.path)&&!c.scheme&&(f=document.location.pathname,/(\/|\/[^\.]+)$/.test(f)||(f=f.replace(/[^\/]+$/,"")),c.host=document.location.hostname,c.path=f+(c.path||""));return c.scheme||(c.scheme=document.location.protocol.replace(/:$/,"")),c.host||(c.host=document.location.hostname),c.port||(c.port=document.location.port||b[c.scheme]||80),c.port=parseInt(c.port,10),c.path||(c.path="/"),delete c.source,c};return{parseUrl:a,resolveUrl:function(b){b=a(b);return b.scheme+
"://"+b.host+(b.port!=={http:80,https:443}[b.scheme]?":"+b.port:"")+b.path+(b.query?b.query:"")},hasSameOrigin:function(b){function f(a){return[a.scheme,a.host,a.port].join("/")}return"string"==typeof b&&(b=a(b)),f(a())===f(b)}}});c("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(a,b,f){return function(){function e(a,e){if(!e.isDetached()){var b=this.connectRuntime(e.ruid).exec.call(this,"FileReaderSync","read",a,e);return this.disconnectRuntime(),
b}b=e.getSource();switch(a){case "readAsBinaryString":return b;case "readAsDataURL":return"data:"+e.type+";base64,"+f.btoa(b);case "readAsText":for(var c="",d=0,h=b.length;h>d;d++)c+=String.fromCharCode(b[d]);return c}}b.call(this);a.extend(this,{uid:a.guid("uid_"),readAsBinaryString:function(a){return e.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){return e.call(this,"readAsDataURL",a)},readAsText:function(a){return e.call(this,"readAsText",a)}})}});c("moxie/xhr/FormData",["moxie/core/Exceptions",
"moxie/core/utils/Basic","moxie/file/Blob"],function(a,b,f){return function(){var a,c={};b.extend(this,{append:function(d,n){var m=this,k=b.typeOf(n);n instanceof f?(a&&delete c[a],a=d,c[d]=[n]):"array"===k?(d+="[]",b.each(n,function(a){m.append.call(m,d,a)})):"object"===k?b.each(n,function(a,e){m.append.call(m,d+"["+e+"]",a)}):(n=n.toString(),c[d]||(c[d]=[]),c[d].push(n))},hasBlob:function(){return!!a},getBlob:function(){return c[a]&&c[a][0]||null},getBlobName:function(){return a||null},each:function(a){b.each(c,
function(e,f){b.each(e,function(e){a(e,f)})})},destroy:function(){a=null;c={}}})}});c("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),function(a,b,f,e,c,d,r,m,k,p,s,y){function x(){this.uid=a.guid("uid_")}function g(){function f(a,b){return B.hasOwnProperty(a)?
1===arguments.length?s.can("define_property")?B[a]:v[a]:(s.can("define_property")?B[a]=b:v[a]=b,void 0):void 0}function k(b){function e(){D.destroy();D=null;h.dispatchEvent("loadend");h=null}function c(d){D.bind("LoadStart",function(a){f("readyState",g.LOADING);h.dispatchEvent("readystatechange");h.dispatchEvent(a);M&&h.upload.dispatchEvent(a)});D.bind("Progress",function(a){f("readyState")!==g.LOADING&&(f("readyState",g.LOADING),h.dispatchEvent("readystatechange"));h.dispatchEvent(a)});D.bind("UploadProgress",
function(a){M&&h.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});D.bind("Load",function(b){f("readyState",g.DONE);f("status",Number(d.exec.call(D,"XMLHttpRequest","getStatus")||0));f("statusText",A[f("status")]||"");f("response",d.exec.call(D,"XMLHttpRequest","getResponse",f("responseType")));~a.inArray(f("responseType"),["text",""])?f("responseText",f("response")):"document"===f("responseType")&&f("responseXML",f("response"));J=d.exec.call(D,"XMLHttpRequest",
"getAllResponseHeaders");h.dispatchEvent("readystatechange");0<f("status")?(M&&h.upload.dispatchEvent(b),h.dispatchEvent(b)):(K=!0,h.dispatchEvent("error"));e()});D.bind("Abort",function(a){h.dispatchEvent(a);e()});D.bind("Error",function(a){K=!0;f("readyState",g.DONE);h.dispatchEvent("readystatechange");N=!0;h.dispatchEvent(a);e()});d.exec.call(D,"XMLHttpRequest","send",{url:F,method:G,async:C,user:R,password:S,headers:H,mimeType:O,encoding:T,responseType:h.responseType,withCredentials:h.withCredentials,
options:E},b)}var h=this;(new Date).getTime();D=new r;"string"==typeof E.required_caps&&(E.required_caps=d.parseCaps(E.required_caps));E.required_caps=a.extend({},E.required_caps,{return_response_type:h.responseType});b instanceof p&&(E.required_caps.send_multipart=!0);P||(E.required_caps.do_cors=!0);E.ruid?c(D.connectRuntime(E)):(D.bind("RuntimeInit",function(a,b){c(b)}),D.bind("RuntimeError",function(a,b){h.dispatchEvent("RuntimeError",b)}),D.connectRuntime(E))}var v=this,B={timeout:0,readyState:g.UNSENT,
withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},C=!0,F,G,H={},R,S,T=null,O=null,Q=!1,L=!1,M=!1,N=!1,K=!1,P=!1,E={},D,J="",I;a.extend(this,B,{uid:a.guid("uid_"),upload:new x,open:function(d,k,l,p,m){var s;if(!d||!k)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(d)||e.utf8_encode(d)!==d)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(~a.inArray(d.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&
(G=d.toUpperCase()),~a.inArray(G,["CONNECT","TRACE","TRACK"]))throw new b.DOMException(b.DOMException.SECURITY_ERR);if(k=e.utf8_encode(k),s=c.parseUrl(k),P=c.hasSameOrigin(s),F=c.resolveUrl(k),(p||m)&&!P)throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);if(R=p||s.user,S=m||s.pass,C=l||!0,!1===C&&(f("timeout")||f("withCredentials")||""!==f("responseType")))throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);Q=!C;L=!1;H={};f("responseText","");f("responseXML",null);f("response",null);
f("status",0);f("statusText","");f("readyState",g.OPENED);this.convertEventPropsToHandlers(["readystatechange"]);this.dispatchEvent("readystatechange")},setRequestHeader:function(c,d){if(f("readyState")!==g.OPENED||L)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(c)||e.utf8_encode(c)!==c)throw new b.DOMException(b.DOMException.SYNTAX_ERR);return c=a.trim(c).toLowerCase(),~a.inArray(c,"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||
/^(proxy\-|sec\-)/.test(c)?!1:(H[c]?H[c]+=", "+d:H[c]=d,!0)},getAllResponseHeaders:function(){return J||""},getResponseHeader:function(b){return b=b.toLowerCase(),K||~a.inArray(b,["set-cookie","set-cookie2"])?null:J&&""!==J&&(I||(I={},a.each(J.split(/\r\n/),function(b){b=b.split(/:\s+/);2===b.length&&(b[0]=a.trim(b[0]),I[b[0].toLowerCase()]={header:b[0],value:a.trim(b[1])})})),I.hasOwnProperty(b))?I[b].header+": "+I[b].value:null},overrideMimeType:function(e){var c;if(~a.inArray(f("readyState"),[g.LOADING,
g.DONE]))throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(e=a.trim(e.toLowerCase()),/;/.test(e)&&(c=e.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(e=c[1]),!y.mimes[e])throw new b.DOMException(b.DOMException.SYNTAX_ERR);},send:function(f,c){if(E="string"===a.typeOf(c)?{ruid:c}:c?c:{},this.convertEventPropsToHandlers(z),this.upload.convertEventPropsToHandlers(z),this.readyState!==g.OPENED||L)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(f instanceof m)E.ruid=f.ruid,O=f.type||
"application/octet-stream";else if(f instanceof p){if(f.hasBlob()){var d=f.getBlob();E.ruid=d.ruid;O=d.type||"application/octet-stream"}}else"string"==typeof f&&(T="UTF-8",O="text/plain;charset=UTF-8",f=e.utf8_encode(f));this.withCredentials||(this.withCredentials=E.required_caps&&E.required_caps.send_browser_cookies&&!P);M=!Q&&this.upload.hasEventListener();K=!1;N=!f;Q||(L=!0);k.call(this,f)},abort:function(){if(K=!0,Q=!1,~a.inArray(f("readyState"),[g.UNSENT,g.OPENED,g.DONE]))f("readyState",g.UNSENT);
else{if(f("readyState",g.DONE),L=!1,!D)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);D.getRuntime().exec.call(D,"XMLHttpRequest","abort",N);N=!0}},destroy:function(){D&&("function"===a.typeOf(D.destroy)&&D.destroy(),D=null);this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var A={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",
207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",
415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};x.prototype=f.instance;var z="loadstart progress abort error load timeout loadend".split(" ");return g.UNSENT=
0,g.OPENED=1,g.HEADERS_RECEIVED=2,g.LOADING=3,g.DONE=4,g.prototype=f.instance,g});c("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(a,b,f,e){function c(){function e(b,f){var h=this;k=f;h.bind("TransportingProgress",function(b){y=b.loaded;s>y&&-1===a.inArray(h.state,[c.IDLE,c.DONE])&&d.call(h)},999);h.bind("TransportingComplete",function(){y=s;h.state=c.DONE;p=null;h.result=k.exec.call(h,"Transporter",
"getAsBlob",b||"")},999);h.state=c.BUSY;h.trigger("TransportingStarted");d.call(h)}function d(){var a;a=s-y;x>a&&(x=a);a=b.btoa(p.substr(y,x));k.exec.call(this,"Transporter","receive",a,s)}var m,k,p,s,y,x;f.call(this);a.extend(this,{uid:a.guid("uid_"),state:c.IDLE,result:null,transport:function(b,f,c){var d=this;c=a.extend({chunk_size:204798},c);(m=c.chunk_size%3)&&(c.chunk_size+=3-m);x=c.chunk_size;s=y=0;p=this.result=null;if(p=b,s=b.length,"string"===a.typeOf(c)||c.ruid)e.call(d,f,this.connectRuntime(c));
else{var h=function(a,b){d.unbind("RuntimeInit",h);e.call(d,f,b)};this.bind("RuntimeInit",h);this.connectRuntime(c)}},abort:function(){this.state=c.IDLE;k&&(k.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));s=y=0;p=this.result=null},destroy:function(){this.unbindAll();k=null;this.disconnectRuntime();s=y=0;p=this.result=null}})}return c.IDLE=0,c.BUSY=1,c.DONE=2,c.prototype=e.instance,c});c("moxie/core/JSON",[],function(){return!!window.JSON&&JSON.parse||function(){var b,
c,f={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},e,d=function(a){throw{name:"SyntaxError",message:a,at:b,text:e};},l=function(a){return a&&a!==c&&d("Expected '"+a+"' instead of '"+c+"'"),c=e.charAt(b),b+=1,c},r=function(){var a,b="";for("-"===c&&(b="-",l("-"));"0"<=c&&"9">=c;)b+=c,l();if("."===c)for(b+=".";l()&&"0"<=c&&"9">=c;)b+=c;if("e"===c||"E"===c)for(b+=c,l(),"-"!==c&&"+"!==c||(b+=c,l());"0"<=c&&"9">=c;)b+=c,l();return a=+b,isFinite(a)?a:(d("Bad number"),void 0)},m=function(){var a,
b,e="",k;if('"'===c)for(;l();){if('"'===c)return l(),e;if("\\"===c)if(l(),"u"===c){for(b=k=0;4>b&&(a=parseInt(l(),16),isFinite(a));b+=1)k=16*k+a;e+=String.fromCharCode(k)}else{if("string"!=typeof f[c])break;e+=f[c]}else e+=c}d("Bad string")},k=function(){for(;c&&" ">=c;)l()},p=function(){switch(c){case "t":return l("t"),l("r"),l("u"),l("e"),!0;case "f":return l("f"),l("a"),l("l"),l("s"),l("e"),!1;case "n":return l("n"),l("u"),l("l"),l("l"),null}d("Unexpected '"+c+"'")},s;return s=function(){switch(k(),
c){case "{":var a;a:{var b={};if("{"===c){if(l("{"),k(),"}"===c){a=(l("}"),b);break a}for(;c;){if(a=m(),k(),l(":"),Object.hasOwnProperty.call(b,a)&&d('Duplicate key "'+a+'"'),b[a]=s(),k(),"}"===c){a=(l("}"),b);break a}l(",");k()}}d("Bad object");a=void 0}return a;case "[":a:{a=[];if("["===c){if(l("["),k(),"]"===c){a=(l("]"),a);break a}for(;c;){if(a.push(s()),k(),"]"===c){a=(l("]"),a);break a}l(",");k()}}d("Bad array");a=void 0}return a;case '"':return m();case "-":return r();default:return"0"<=c&&
"9">=c?r():p()}},function(f,l){var p;return e=f,b=0,c=" ",p=s(),k(),c&&d("Syntax error"),"function"==typeof l?function z(b,c){var f,e,d=b[c];if(d&&"object"==typeof d)for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&(e=z(d,f),e!==a?d[f]=e:delete d[f]);return l.call(b,c,d)}({"":p},""):p}}()});c("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode moxie/core/JSON".split(" "),
function(a,b,c,e,d,l,r,m,k,p,s,g,x,t){function A(){function e(b){var d=a.typeOf(b);try{if(b instanceof A){if(!b.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);p.apply(this,arguments)}else if(b instanceof s){if(!~a.inArray(b.type,["image/jpeg","image/png"]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);v.apply(this,arguments)}else if(-1!==a.inArray(d,["blob","file"]))e.call(this,new g(null,b),arguments[1]);else if("string"===d)/^data:[^;]*;base64,/.test(b)?e.call(this,new s(null,
{data:b}),arguments[1]):B.apply(this,arguments);else{if("node"!==d||"img"!==b.nodeName.toLowerCase())throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);e.call(this,b.src,arguments[1])}}catch(h){this.trigger("error",h)}}function p(b,c){var e=this.connectRuntime(b.ruid);this.ruid=e.uid;e.exec.call(this,"Image","loadFromImage",b,"undefined"===a.typeOf(c)?!0:c)}function v(b,c){function e(a){f.ruid=a.uid;a.exec.call(f,"Image","loadFromBlob",b)}var f=this;f.name=b.name||"";b.isDetached()?(this.bind("RuntimeInit",
function(a,b){e(b)}),c&&"string"==typeof c.required_caps&&(c.required_caps=l.parseCaps(c.required_caps)),this.connectRuntime(a.extend({required_caps:{access_image_binary:!0,resize_image:!0}},c))):e(this.connectRuntime(b.ruid))}function B(a,b){var c=this,e;e=new d;e.open("get",a);e.responseType="blob";e.onprogress=function(a){c.trigger(a)};e.onload=function(){v.call(c,e.response,!0)};e.onerror=function(a){c.trigger(a)};e.onloadend=function(){e.destroy()};e.bind("RuntimeError",function(a,b){c.trigger("RuntimeError",
b)});e.send(null,b)}r.call(this);a.extend(this,{uid:a.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){var b=void 0;if(b||(b=this.getRuntime().exec.call(this,"Image","getInfo")),b)if("string"===a.typeOf(b.meta))try{this.meta=t(b.meta)}catch(c){}else this.meta=b.meta;a.extend(this,{size:parseInt(b.size,10),width:parseInt(b.width,10),height:parseInt(b.height,10),type:b.type});""===
this.name&&(this.name=b.name)},999);this.convertEventPropsToHandlers(z);e.apply(this,arguments)},downsize:function(b,e,d,h){try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>A.MAX_RESIZE_WIDTH||this.height>A.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);(b||e)&&"undefined"!==a.typeOf(d)||(d=!1);b=b||this.width;e=e||this.height;h="undefined"===a.typeOf(h)?!0:!!h;this.getRuntime().exec.call(this,"Image","downsize",b,e,d,h)}catch(k){this.trigger("error",
k)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!k.can("create_canvas"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return a||(a="image/jpeg"),"image/jpeg"!==a||b||(b=90),this.getRuntime().exec.call(this,"Image","getAsBlob",a,b)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);
return this.getRuntime().exec.call(this,"Image","getAsDataURL",a,b)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return x.atob(c.substring(c.indexOf("base64,")+7))},embed:function(e,d){function q(){if(k.can("create_canvas")){var b=p.getAsCanvas();if(b)return e.appendChild(b),b=null,p.destroy(),l.trigger("embedded"),void 0}b=p.getAsDataURL(s,r);if(!b)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(k.can("use_data_uri_of",b.length))e.innerHTML='<img src="'+b+'" width="'+p.width+
'" height="'+p.height+'" />',p.destroy(),l.trigger("embedded");else{var d=new m;d.bind("TransportingComplete",function(){B=l.connectRuntime(this.result.ruid);l.bind("Embedded",function(){a.extend(B.getShimContainer().style,{top:"0px",left:"0px",width:p.width+"px",height:p.height+"px"});B=null},999);B.exec.call(l,"ImageView","display",this.result.uid,v,t);p.destroy()});d.transport(x.atob(b.substring(b.indexOf("base64,")+7)),s,a.extend({},y,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",
container:e}))}}var l=this,p,s,r,g,y=d||{},v=this.width,t=this.height,B;try{if(!(e=b.get(e)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>A.MAX_RESIZE_WIDTH||this.height>A.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);if(s=y.type||this.type||"image/jpeg",r=y.quality||90,g="undefined"!==a.typeOf(y.crop)?y.crop:!1,y.width)v=y.width,t=y.height||v;else{var z=b.getSize(e);
z.w&&z.h&&(v=z.w,t=z.h)}return p=new A,p.bind("Resize",function(){q.call(l)}),p.bind("Load",function(){p.downsize(v,t,g,!1)}),p.clone(this,!1),p}catch(u){this.trigger("error",u)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}})}var z=["progress","load","error","resize","embedded"];return A.MAX_RESIZE_WIDTH=6500,A.MAX_RESIZE_HEIGHT=6500,A.prototype=p.instance,A});c("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic",
"moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(a,b,c,e){var d={};return c.addConstructor("html5",function(b,h,m){var k=this,p=c.capTest,s=c.capTrue;m=a.extend({access_binary:p(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return k.can("access_binary")&&!!d.Image},display_media:p(e.can("create_canvas")||e.can("use_data_uri_over32kb")),do_cors:p(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:p(function(){var a=
document.createElement("div");return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&("IE"!==e.browser||9<e.version)}()),filter_by_extension:p("Chrome"===e.browser&&28<=e.version||"IE"===e.browser&&10<=e.version),return_response_headers:s,return_response_type:function(a){return"json"===a?!0:e.can("return_response_type",a)},report_upload_progress:p(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return k.can("access_binary")&&e.can("create_canvas")},select_file:function(){return e.can("use_fileinput")&&
window.File},select_folder:function(){return k.can("select_file")&&"Chrome"===e.browser&&21<=e.version},select_multiple:function(){return k.can("select_file")&&!("Safari"===e.browser&&"Windows"===e.OS)},send_binary_string:p(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:p(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||k.can("send_binary_string")},
slice_blob:p(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return k.can("slice_blob")&&k.can("send_multipart")},summon_file_dialog:p("Firefox"===e.browser&&4<=e.version||"Opera"===e.browser&&12<=e.version||"IE"===e.browser&&10<=e.version||!!~a.inArray(e.browser,["Chrome","Safari"])),upload_filesize:s},m);c.call(this,b,h||"html5",m);a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(k);
a=k=null}}(this.destroy)});a.extend(this.getShim(),d)}),d});c("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(a,b){return a.Blob=function(){function a(b,c,f){var d;if(!window.File.prototype.slice)return(d=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?d.call(b,c,f):null;try{return b.slice(),b.slice(c,f)}catch(h){return b.slice(c,f-c)}}this.slice=function(){return new b(this.getRuntime().uid,a.apply(this,arguments))}}});c("moxie/core/utils/Events",
["moxie/core/utils/Basic"],function(a){function b(){this.returnValue=!1}function c(){this.cancelBubble=!0}var e={},d="moxie_"+a.guid(),l=function(b,c,f){var h;if(c=c.toLowerCase(),b[d]&&e[b[d]]&&e[b[d]][c]){h=e[b[d]][c];for(var l=h.length-1;0<=l&&(h[l].orig!==f&&h[l].key!==f||(b.removeEventListener?b.removeEventListener(c,h[l].func,!1):b.detachEvent&&b.detachEvent("on"+c,h[l].func),h[l].orig=null,h[l].func=null,h.splice(l,1),void 0===f));l--);if(h.length||delete e[b[d]][c],a.isEmptyObj(e[b[d]])){delete e[b[d]];
try{delete b[d]}catch(g){b[d]=void 0}}}};return{addEvent:function(l,m,k,p){var s;m=m.toLowerCase();l.addEventListener?(s=k,l.addEventListener(m,s,!1)):l.attachEvent&&(s=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=b;a.stopPropagation=c;k(a)},l.attachEvent("on"+m,s));l[d]||(l[d]=a.guid());e.hasOwnProperty(l[d])||(e[l[d]]={});l=e[l[d]];l.hasOwnProperty(m)||(l[m]=[]);l[m].push({func:s,orig:k,key:p})},removeEvent:l,removeAllEvents:function(b,c){b&&b[d]&&a.each(e[b[d]],
function(a,e){l(b,e,c)})}}});c("moxie/runtime/html5/file/FileInput","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(a,b,c,e,d,l){return a.FileInput=function(){var a=[],m;b.extend(this,{init:function(k){var p=this,s=p.getRuntime(),n,g,t;m=k;a=[];k=m.accept.mimes||d.extList2mimes(m.accept,s.can("filter_by_extension"));n=s.getShimContainer();n.innerHTML='<input id="'+s.uid+'" type="file" style="font-size:999px;opacity:0;"'+
(m.multiple&&s.can("select_multiple")?"multiple":"")+(m.directory&&s.can("select_folder")?"webkitdirectory directory":"")+(k?' accept="'+k.join(",")+'"':"")+" />";k=c.get(s.uid);b.extend(k.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});g=c.get(m.browse_button);s.can("summon_file_dialog")&&("static"===c.getStyle(g,"position")&&(g.style.position="relative"),t=parseInt(c.getStyle(g,"z-index"),10)||1,g.style.zIndex=t,n.style.zIndex=t-1,e.addEvent(g,"click",function(a){var b=c.get(s.uid);
b&&!b.disabled&&b.click();a.preventDefault()},p.uid));t=s.can("summon_file_dialog")?g:n;e.addEvent(t,"mouseover",function(){p.trigger("mouseenter")},p.uid);e.addEvent(t,"mouseout",function(){p.trigger("mouseleave")},p.uid);e.addEvent(t,"mousedown",function(){p.trigger("mousedown")},p.uid);e.addEvent(c.get(m.container),"mouseup",function(){p.trigger("mouseup")},p.uid);k.onchange=function z(){if(a=[],m.directory?b.each(this.files,function(b){"."!==b.name&&a.push(b)}):a=[].slice.call(this.files),"IE"!==
l.browser)this.value="";else{var c=this.cloneNode(!0);this.parentNode.replaceChild(c,this);c.onchange=z}p.trigger("change")};p.trigger({type:"ready",async:!0});n=null},getFiles:function(){return a},disable:function(a){var b=this.getRuntime(),e;(e=c.get(b.uid))&&(e.disabled=!!a)},destroy:function(){var b=this.getRuntime().getShimContainer();e.removeAllEvents(b,this.uid);e.removeAllEvents(m&&c.get(m.container),this.uid);e.removeAllEvents(m&&c.get(m.browse_button),this.uid);b&&(b.innerHTML="");a=m=null}})}});
c("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(a,b,c,e,d){return a.FileDrop=function(){function a(c){var e=s.accept.mimes||d.extList2mimes(s.accept);c=c.type||d.getFileMime(c.name)||"";return e.length&&-1===b.inArray(c,e)?!1:!0}function n(a,c){var e=[];b.each(a,function(a){e.push(function(b){m(a,b)})});b.inSeries(e,function(){c()})}function m(b,c){b.isFile?b.file(function(b){a(b)&&
p.push(b);c()},function(){c()}):b.isDirectory?k(b,c):c()}function k(a,b){function c(a){f.readEntries(function(b){b.length?([].push.apply(e,b),c(a)):a()},a)}var e=[],f=a.createReader();c(function(){n(e,b)})}var p=[],s;b.extend(this,{init:function(c){var f=this;s=c;c=s.container;e.addEvent(c,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},f.uid);e.addEvent(c,"drop",function(c){if(c.preventDefault(),c.stopPropagation(),p=[],c.dataTransfer.items&&c.dataTransfer.items[0].webkitGetAsEntry){var e=
[];b.each(c.dataTransfer.items,function(a){e.push(a.webkitGetAsEntry())});n(e,function(){f.trigger("drop")})}else b.each(c.dataTransfer.files,function(b){a(b)&&p.push(b)}),f.trigger("drop")},f.uid);e.addEvent(c,"dragenter",function(a){a.preventDefault();a.stopPropagation();f.trigger("dragenter")},f.uid);e.addEvent(c,"dragleave",function(a){a.preventDefault();a.stopPropagation();f.trigger("dragleave")},f.uid)},getFiles:function(){return p},destroy:function(){e.removeAllEvents(s&&c.get(s.container),
this.uid);p=s=null}})}});c("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(a,b,c){return a.FileReader=function(){var a,d=!1;c.extend(this,{read:function(b,h){var n=this;a=new window.FileReader;a.addEventListener("progress",function(a){n.trigger(a)});a.addEventListener("load",function(a){n.trigger(a)});a.addEventListener("error",function(b){n.trigger(b,a.error)});a.addEventListener("loadend",function(){a=null});"function"===
c.typeOf(a[b])?(d=!1,a[b](h.getSource())):"readAsBinaryString"===b&&(d=!0,a.readAsDataURL(h.getSource()))},getResult:function(){return a&&a.result?d?b.atob(a.result.substring(a.result.indexOf("base64,")+7)):a.result:null},abort:function(){a&&a.abort()},destroy:function(){a=null}})}});c("moxie/runtime/html5/xhr/XMLHttpRequest","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env moxie/core/JSON".split(" "),
function(a,b,c,e,d,l,g,m,k){return a.XMLHttpRequest=function(){function a(b,c){var e=this,f,h;f=c.getBlob().getSource();h=new window.FileReader;h.onload=function(){c.append(c.getBlobName(),new d(null,{type:f.type,data:h.result}));x.send.call(e,b,c)};h.readAsBinaryString(f)}function n(){var a;if(!window.XMLHttpRequest||"IE"===m.browser&&8>m.version)a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break a}catch(e){}a=void 0}else a=new window.XMLHttpRequest;
return a}function y(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new g.RuntimeError(g.RuntimeError.NOT_SUPPORTED_ERR);return t.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),a.each(function(a,e){c+=a instanceof d?"--"+b+'\r\nContent-Disposition: form-data; name="'+e+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+a.type+"\r\n\r\n"+a.getSource()+"\r\n":"--"+b+'\r\nContent-Disposition: form-data; name="'+
e+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n"}),c+="--"+b+"--\r\n"}var x=this,t,A;b.extend(this,{send:function(e,k){var g=this,r="Mozilla"===m.browser&&4<=m.version&&7>m.version,x="Android Browser"===m.browser,C=!1;if(A=e.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),t=n(),t.open(e.method,e.url,e.async,e.user,e.password),k instanceof d)k.isDetached()&&(C=!0),k=k.getSource();else if(k instanceof l){if(k.hasBlob())if(k.getBlob().isDetached())k=y.call(g,k),C=!0;else if((r||x)&&"blob"===
b.typeOf(k.getBlob().getSource())&&window.FileReader)return a.call(g,e,k),void 0;if(k instanceof l){var F=new window.FormData;k.each(function(a,b){a instanceof d?F.append(b,a.getSource()):F.append(b,a)});k=F}}t.upload?(e.withCredentials&&(t.withCredentials=!0),t.addEventListener("load",function(a){g.trigger(a)}),t.addEventListener("error",function(a){g.trigger(a)}),t.addEventListener("progress",function(a){g.trigger(a)}),t.upload.addEventListener("progress",function(a){g.trigger({type:"UploadProgress",
loaded:a.loaded,total:a.total})})):t.onreadystatechange=function(){switch(t.readyState){case 3:var a,b;try{c.hasSameOrigin(e.url)&&(a=t.getResponseHeader("Content-Length")||0),t.responseText&&(b=t.responseText.length)}catch(d){a=b=0}g.trigger({type:"progress",lengthComputable:!!a,total:parseInt(a,10),loaded:b});break;case 4:t.onreadystatechange=function(){},0===t.status?g.trigger("error"):g.trigger("load")}};b.isEmptyObj(e.headers)||b.each(e.headers,function(a,b){t.setRequestHeader(b,a)});""!==e.responseType&&
"responseType"in t&&(t.responseType="json"!==e.responseType||m.can("return_response_type","json")?e.responseType:"text");C?t.sendAsBinary?t.sendAsBinary(k):function(){for(var a=new Uint8Array(k.length),b=0;b<k.length;b++)a[b]=255&k.charCodeAt(b);t.send(a.buffer)}():t.send(k);g.trigger("loadstart")},getStatus:function(){try{if(t)return t.status}catch(a){}return 0},getResponse:function(a){var b=this.getRuntime();try{switch(a){case "blob":var c=new e(b.uid,t.response),f=t.getResponseHeader("Content-Disposition");
if(f){var d=f.match(/filename=([\'\"'])([^\1]+)\1/);d&&(A=d[2])}return c.name=A,c;case "json":return m.can("return_response_type","json")?t.response:200===t.status?k(t.responseText):null;case "document":var h=t.responseXML,l=t.responseText;return"IE"===m.browser&&l&&h&&!h.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(t.getResponseHeader("Content-Type"))&&(h=new window.ActiveXObject("Microsoft.XMLDOM"),h.async=!1,h.validateOnParse=!1,h.loadXML(l)),h&&("IE"===m.browser&&0!==h.parseError||!h.documentElement||
"parsererror"===h.documentElement.tagName)?null:h;default:return""!==t.responseText?t.responseText:null}}catch(q){return null}},getAllResponseHeaders:function(){try{return t.getAllResponseHeaders()}catch(a){}return""},abort:function(){t&&t.abort()},destroy:function(){x=A=null}})}});c("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function b(a,c){var d=f?0:-8*(c-1),h=0,k;for(k=0;c>k;k++)h|=e.charCodeAt(a+k)<<Math.abs(d+8*k);return h}function c(a,b,f){f=3===arguments.length?
f:e.length-b-1;e=e.substr(0,b)+a+e.substr(f+b)}var f=!1,e;return{II:function(b){return b===a?f:(f=b,void 0)},init:function(a){f=!1;e=a},SEGMENT:function(a,b,f){switch(arguments.length){case 1:return e.substr(a,e.length-a-1);case 2:return e.substr(a,b);case 3:c(f,a,b);break;default:return e}},BYTE:function(a){return b(a,1)},SHORT:function(a){return b(a,2)},LONG:function(e,d){var g;if(d===a)g=b(e,4);else{g="";var m=f?0:-24,k;for(k=0;4>k;k++)g+=String.fromCharCode(255&d>>Math.abs(m+8*k));c(g,e,4);g=
void 0}return g},SLONG:function(a){a=b(a,4);return 2147483647<a?a-4294967296:a},STRING:function(a,c){var e="";for(c+=a;c>a;a++)e+=String.fromCharCode(b(a,1));return e}}}});c("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],function(a){return function f(b){var c=[],d,g,m,k=0;if(d=new a,d.init(b),65496===d.SHORT(0)){for(g=2;g<=b.length;)if(m=d.SHORT(g),65488<=m&&65495>=m)g+=2;else{if(65498===m||65497===m)break;k=d.SHORT(g+2)+2;65505<=m&&65519>=m&&c.push({hex:m,name:"APP"+
(15&m),start:g,length:k,segment:d.SEGMENT(g,k)});g+=k}return d.init(null),{headers:c,restore:function(a){var b,e;d.init(a);g=65504==d.SHORT(2)?4+d.SHORT(4):2;e=0;for(b=c.length;b>e;e++)d.SEGMENT(g,0,c[e].segment),g+=c[e].length;return a=d.SEGMENT(),d.init(null),a},strip:function(a){var b,c;c=new f(a);b=c.headers;c.purge();d.init(a);for(c=b.length;c--;)d.SEGMENT(b[c].start,b[c].length,"");return a=d.SEGMENT(),d.init(null),a},get:function(a){for(var b=[],e=0,d=c.length;d>e;e++)c[e].name===a.toUpperCase()&&
b.push(c[e].segment);return b},set:function(a,b){var e=[],d,f,k;"string"==typeof b?e.push(b):e=b;d=f=0;for(k=c.length;k>d&&(c[d].name===a.toUpperCase()&&(c[d].segment=e[f],c[d].length=e[f].length,f++),!(f>=e.length));d++);},purge:function(){c=[];d.init(null);d=null}}}}});c("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(b,c){return function(){function d(b,c){var f=e.SHORT(b),h,g,l,n,q,w,u=[],v={};for(h=0;f>h;h++)if(w=b+12*h+2,l=c[e.SHORT(w)],
l!==a){switch(n=e.SHORT(w+=2),q=e.LONG(w+=2),w+=4,u=[],n){case 1:case 7:4<q&&(w=e.LONG(w)+r.tiffHeader);for(g=0;q>g;g++)u[g]=e.BYTE(w+g);break;case 2:4<q&&(w=e.LONG(w)+r.tiffHeader);v[l]=e.STRING(w,q-1);continue;case 3:2<q&&(w=e.LONG(w)+r.tiffHeader);for(g=0;q>g;g++)u[g]=e.SHORT(w+2*g);break;case 4:1<q&&(w=e.LONG(w)+r.tiffHeader);for(g=0;q>g;g++)u[g]=e.LONG(w+4*g);break;case 5:w=e.LONG(w)+r.tiffHeader;for(g=0;q>g;g++)u[g]=e.LONG(w+4*g)/e.LONG(w+4*g+4);break;case 9:w=e.LONG(w)+r.tiffHeader;for(g=0;q>
g;g++)u[g]=e.SLONG(w+4*g);break;case 10:w=e.LONG(w)+r.tiffHeader;for(g=0;q>g;g++)u[g]=e.SLONG(w+4*g)/e.SLONG(w+4*g+4);break;default:continue}g=1==q?u[0]:u;v[l]=m.hasOwnProperty(l)&&"object"!=typeof g?m[l][g]:g}return v}var e,g,l,r={},m;return e=new c,g={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",
33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},m={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",
2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},
Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",
32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",
95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",
W:"West longitude"}},{init:function(b){r={tiffHeader:10};if(b!==a&&b.length)if(e.init(b),65505===e.SHORT(0)&&"EXIF\x00"===e.STRING(4,5).toUpperCase()){var c=r.tiffHeader;b=(e.II(18761==e.SHORT(c)),42!==e.SHORT(c+=2)?!1:(r.IFD0=r.tiffHeader+e.LONG(c+2),l=d(r.IFD0,g.tiff),"ExifIFDPointer"in l&&(r.exifIFD=r.tiffHeader+l.ExifIFDPointer,delete l.ExifIFDPointer),"GPSInfoIFDPointer"in l&&(r.gpsIFD=r.tiffHeader+l.GPSInfoIFDPointer,delete l.GPSInfoIFDPointer),!0))}else b=!1;else b=!1;return b},TIFF:function(){return l},
EXIF:function(){var a;if(a=d(r.exifIFD,g.exif),a.ExifVersion&&"array"===b.typeOf(a.ExifVersion)){for(var c=0,e="";c<a.ExifVersion.length;c++)e+=String.fromCharCode(a.ExifVersion[c]);a.ExifVersion=e}return a},GPS:function(){var a;return a=d(r.gpsIFD,g.gps),a.GPSVersionID&&"array"===b.typeOf(a.GPSVersionID)&&(a.GPSVersionID=a.GPSVersionID.join(".")),a},setExif:function(a,b){var c;if("PixelXDimension"!==a&&"PixelYDimension"!==a)c=!1;else{c=a;var d,f,h,l=0;if("string"==typeof c)for(f in d=g.exif,d)if(d[f]===
c){c=f;break}d=r.exifIFD;f=e.SHORT(d);for(var n=0;f>n;n++)if(h=d+12*n+2,e.SHORT(h)==c){l=h+8;break}c=l?(e.LONG(l,b),!0):!1}return c},getBinary:function(){return e.SEGMENT()},purge:function(){e.init(null);e=l=null;r={}}}}});c("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(a,b,c,e,d){return function(g){var r,m,k,p,s,y;if(r=g,m=new e,m.init(r),
65496!==m.SHORT(0))throw new b.ImageError(b.ImageError.WRONG_FORMAT);k=new c(g);p=new d;y=!!p.init(k.get("app1")[0]);s=function(){for(var a=0,b,c;a<=r.length;){if(b=m.SHORT(a+=2),65472<=b&&65475>=b)return a+=5,{height:m.SHORT(a),width:m.SHORT(a+2)};c=m.SHORT(a+=2);a+=c-2}return null}.call(this);a.extend(this,{type:"image/jpeg",size:r.length,width:s&&s.width||0,height:s&&s.height||0,setExif:function(b,c){return y?("object"===a.typeOf(b)?a.each(b,function(a,b){p.setExif(b,a)}):p.setExif(b,c),k.set("app1",
p.getBinary()),void 0):!1},writeHeaders:function(){return arguments.length?k.restore(arguments[0]):r=k.restore(r)},stripHeaders:function(a){return k.strip(a)},purge:function(){p&&k&&m&&(p.purge(),k.purge(),m.init(null),r=s=k=p=m=null)}});y&&(this.meta={tiff:p.TIFF(),exif:p.EXIF(),gps:p.GPS()})}});c("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(a,b,c){return function(e){function d(){r&&(r.init(null),g=m=r=null)}
var g,r,m;g=e;r=new c;r.init(g);(function(){for(var b=0,c=0,e=[35152,20039,3338,6666],c=0;c<e.length;c++,b+=2)if(e[c]!=r.SHORT(b))throw new a.ImageError(a.ImageError.WRONG_FORMAT);})();m=function(){var a,b,c=8,e,d,f,h;return a=(e=r.LONG(c),d=r.STRING(c+=4,4),f=c+=4,h=r.LONG(c+e),{length:e,type:d,start:f,CRC:h}),"IHDR"==a.type?(b=a.start,{width:r.LONG(b),height:r.LONG(b+4)}):null}.call(this);b.extend(this,{type:"image/png",size:g.length,width:m.width,height:m.height,purge:function(){d.call(this)}});
d.call(this)}});c("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(a,b,c,e){return function(d){var g=[c,e],r;r=function(){for(var a=0;a<g.length;a++)try{return new g[a](d)}catch(c){}throw new b.ImageError(b.ImageError.WRONG_FORMAT);}();a.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){}});
a.extend(this,r);this.purge=function(){r.purge();r=null}}});c("moxie/runtime/html5/image/MegaPixel",[],function(){function a(b){var c=b.naturalWidth;if(1048576<c*b.naturalHeight){var e=document.createElement("canvas");e.width=e.height=1;e=e.getContext("2d");return e.drawImage(b,-c+1,0),0===e.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:a,renderTo:function(b,c,e){var d=b.naturalWidth,g=b.naturalHeight,r=e.width,m=e.height,k=e.x||0;e=e.y||0;c=c.getContext("2d");a(b)&&(d/=2,g/=2);var p=
document.createElement("canvas");p.width=p.height=1024;var s=p.getContext("2d"),y;y=g;var x=document.createElement("canvas");x.width=1;x.height=y;x=x.getContext("2d");x.drawImage(b,0,0);for(var x=x.getImageData(0,0,1,y).data,t=0,A=y,z=y;z>t;)0===x[4*(z-1)+3]?A=z:t=z,z=A+t>>1;y=z/y;y=0===y?1:y;for(x=0;g>x;){t=x+1024>g?g-x:1024;for(A=0;d>A;){z=A+1024>d?d-A:1024;s.clearRect(0,0,1024,1024);s.drawImage(b,-A,-x);var w=A*r/d+k<<0,u=Math.ceil(z*r/d),v=x*m/g/y+e<<0,B=Math.ceil(t*m/g/y);c.drawImage(p,0,0,z,
t,w,v,u,B);A+=1024}x+=1024}}}});c("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/Blob moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(a,b,c,e,d,g,r,m,k){return a.Image=function(){function a(){if(!v&&!w)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);return v||w}function n(a){return e.atob(a.substring(a.indexOf("base64,")+
7))}function y(a){var b=this;w=new Image;w.onerror=function(){A.call(this);b.trigger("error",new c.ImageError(c.ImageError.WRONG_FORMAT))};w.onload=function(){b.trigger("load")};w.src=/^data:[^;]*;base64,/.test(a)?a:"data:"+(C.type||"")+";base64,"+e.btoa(a)}function x(a,b){var e=this,d;return window.FileReader?(d=new FileReader,d.onload=function(){b(this.result)},d.onerror=function(){e.trigger("error",new c.FileException(c.FileException.NOT_READABLE_ERR))},d.readAsDataURL(a),void 0):b(a.getAsDataURL())}
function t(c,e,d,f){var g,l,n;if(G=f,n=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==b.inArray(n,[5,6,7,8]))l=c,c=e,e=l;l=a();g=(d?Math.max:Math.min)(c/l.width,e/l.height);if(1<g&&(!d||f))l=(this.trigger("Resize"),void 0);else{f=Math.round(l.width*g);g=Math.round(l.height*g);v||(v=document.createElement("canvas"));v.getContext("2d");d?(v.width=c,v.height=e):(v.width=f,v.height=g);e=f>v.width?Math.round((f-v.width)/2):0;c=g>v.height?Math.round((g-v.height)/2):0;if(!G){d=v.width;var m=
v.height;switch(n){case 5:case 6:case 7:case 8:v.width=m;v.height=d;break;default:v.width=d,v.height=m}var q=v.getContext("2d");switch(n){case 2:q.translate(d,0);q.scale(-1,1);break;case 3:q.translate(d,m);q.rotate(Math.PI);break;case 4:q.translate(0,m);q.scale(1,-1);break;case 5:q.rotate(0.5*Math.PI);q.scale(1,-1);break;case 6:q.rotate(0.5*Math.PI);q.translate(0,-m);break;case 7:q.rotate(0.5*Math.PI);q.translate(d,-m);q.scale(-1,1);break;case 8:q.rotate(-0.5*Math.PI),q.translate(-d,0)}}n=v;e=-e;
c=-c;"iOS"===k.OS?r.renderTo(l,n,{width:f,height:g,x:e,y:c}):n.getContext("2d").drawImage(l,e,c,f,g);l=(this.width=v.width,this.height=v.height,F=!0,this.trigger("Resize"),void 0)}return l}function A(){u&&(u.purge(),u=null);B=w=v=null;F=!1}var z=this,w,u,v,B,C,F=!1,G=!0;b.extend(this,{loadFromBlob:function(a){var b=this,e=b.getRuntime(),d=1<arguments.length?arguments[1]:!0;if(!e.can("access_binary"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);return a.isDetached()?(C={name:a.name,size:a.size,
type:a.type},B=a.getSource(),y.call(this,B),void 0):(C=a.getSource(),x.call(this,C,function(a){d&&(B=n(a));y.call(b,a)}),void 0)},loadFromImage:function(a,b){this.meta=a.meta;C={name:a.name,size:a.size,type:a.type};y.call(this,b?B=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var b=this.getRuntime();return!u&&B&&b.can("access_image_binary")&&(u=new g(B)),{width:a().width||0,height:a().height||0,type:C.type||m.getFileMime(C.name),size:B&&B.length||C.size||0,name:C.name||"",meta:u&&u.meta||
this.meta||{}}},downsize:function(){t.apply(this,arguments)},getAsCanvas:function(){return v&&(v.id=this.uid+"_canvas"),v},getAsBlob:function(a,b){return a!==this.type&&t.call(this,this.width,this.height,!1),new d(null,{type:a,data:z.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a,b){var c=b||90;if(!F)return w.src;if("image/jpeg"!==a)return v.toDataURL("image/png");try{return v.toDataURL("image/jpeg",c/100)}catch(e){return v.toDataURL("image/jpeg")}},getAsBinaryString:function(a,b){if(!F)return B||
(B=n(z.getAsDataURL(a,b))),B;if("image/jpeg"!==a)B=n(z.getAsDataURL(a,b));else{var c;b||(b=90);try{c=v.toDataURL("image/jpeg",b/100)}catch(e){c=v.toDataURL("image/jpeg")}B=n(c);u&&(B=u.stripHeaders(B),G&&(u.meta&&u.meta.exif&&u.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),B=u.writeHeaders(B)),u.purge(),u=null)}return F=!1,B},destroy:function(){z=null;A.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});c("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic",
"moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(a,b,c,e,d){function g(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+"."+a[1])}var r={};return d.addConstructor("flash",function(m){var k=this,p;m=a.extend({swf_url:b.swf_url},m);d.call(this,m,"flash",{access_binary:function(a){return a&&
"browser"===k.mode},access_image_binary:function(a){return a&&"browser"===k.mode},display_media:d.capTrue,do_cors:d.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===k.mode},resize_image:d.capTrue,return_response_headers:!1,return_response_type:function(b){return!a.arrayDiff(b,["","text","json","document"])||"browser"===k.mode},return_status_code:function(b){return"browser"===k.mode||!a.arrayDiff(b,[200,404])},select_file:d.capTrue,select_multiple:d.capTrue,send_binary_string:function(a){return a&&
"browser"===k.mode},send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"browser"===k.mode},send_multipart:d.capTrue,slice_blob:d.capTrue,stream_upload:function(a){return a&&"browser"===k.mode},summon_file_dialog:!1,upload_filesize:function(b){return 2097152>=a.parseSizeStr(b)||"client"===k.mode},use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}},{access_binary:function(a){return a?"browser":"client"},access_image_binary:function(a){return a?
"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(b){return a.arrayDiff(b,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(b){return a.arrayDiff(b,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"browser":"client"},stream_upload:function(a){return a?
"client":"browser"},upload_filesize:function(b){return 2097152<=a.parseSizeStr(b)?"client":"browser"}},"client");10>g()&&(this.mode=!1);a.extend(this,{getShim:function(){return c.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var c,d,f;f=this.getShimContainer();a.extend(f.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});c='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+
m.swf_url+'" ';"IE"===b.browser&&(c+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');c+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+m.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+b.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';"IE"===b.browser?(d=document.createElement("div"),f.appendChild(d),d.outerHTML=c,d=f=null):f.innerHTML=c;p=setTimeout(function(){k&&
!k.initialized&&k.trigger("Error",new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(p);m=p=a=k=null}}(this.destroy)},r)}),r});c("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(a,b){return a.Blob={slice:function(a,c,d,g){var n=this.getRuntime();return 0>c?c=Math.max(a.size+c,0):0<c&&(c=Math.min(c,a.size)),0>d?d=Math.max(a.size+d,0):0<d&&(d=Math.min(d,a.size)),a=n.shimExec.call(this,"Blob",
"slice",c,d,g||""),a&&(a=new b(n.uid,a)),a}}});c("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(a){return a.FileInput={init:function(a){this.getRuntime().shimExec.call(this,"FileInput","init",{name:a.name,accept:a.accept,multiple:a.multiple});this.trigger("ready")}}});c("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(a,b){function c(a,e){switch(e){case "readAsText":return b.atob(a,"utf8");case "readAsBinaryString":return b.atob(a);
case "readAsDataURL":return a}return null}var e="";return a.FileReader={read:function(a,b){var d=this.getRuntime();return"readAsDataURL"===a&&(e="data:"+(b.type||"")+";base64,"),this.bind("Progress",function(b,d){d&&(e+=c(d,a))}),d.shimExec.call(this,"FileReader","readAsBase64",b.uid)},getResult:function(){return e},destroy:function(){e=null}}});c("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(a,b){function c(a,d){switch(d){case "readAsText":return b.atob(a,
"utf8");case "readAsBinaryString":return b.atob(a);case "readAsDataURL":return a}return null}return a.FileReaderSync={read:function(a,b){var d;return(d=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",b.uid))?("readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,"+d),c(d,a,b.type)):null}}});c("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter moxie/core/JSON".split(" "),
function(a,b,c,e,d,g,r,m){return a.XMLHttpRequest={send:function(a,d){function e(){a.transport=A.mode;A.shimExec.call(q,"XMLHttpRequest","send",a,d)}function n(a,b){A.shimExec.call(q,"XMLHttpRequest","appendBlob",a,b.uid);d=null;e()}function m(a,b){var c=new r;c.bind("TransportingComplete",function(){b(this.result)});c.transport(a.getSource(),a.type,{ruid:A.uid})}var q=this,A=q.getRuntime();if(b.isEmptyObj(a.headers)||b.each(a.headers,function(a,b){A.shimExec.call(q,"XMLHttpRequest","setRequestHeader",
b,a.toString())}),d instanceof g){var z;if(d.each(function(a,b){a instanceof c?z=b:A.shimExec.call(q,"XMLHttpRequest","append",b,a)}),d.hasBlob()){var w=d.getBlob();w.isDetached()?m(w,function(a){w.destroy();n(z,a)}):n(z,w)}else d=null,e()}else d instanceof c?d.isDetached()?m(d,function(a){d.destroy();d=a.uid;e()}):(d=d.uid,e()):e()},getResponse:function(a){var c,f,g=this.getRuntime();if(f=g.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(f=new e(g.uid,f),"blob"===a)return f;if(~b.inArray(a,
["","text"]))return c=new d,c.readAsText(f);if("arraybuffer"!==a&&"json"===a){c=new d;try{return m(c.readAsText(f))}catch(l){}}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});c("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(a,b){return a.Transporter={getAsBlob:function(a){var c=this.getRuntime();return(a=c.shimExec.call(this,"Transporter",
"getAsBlob",a))?new b(c.uid,a):null}}});c("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(a,b,c,d,g){return a.Image={loadFromBlob:function(a){function b(a){e.shimExec.call(d,"Image","loadFromBlob",a.uid);d=e=null}var d=this,e=d.getRuntime();if(a.isDetached()){var h=new c;h.bind("TransportingComplete",function(){b(h.result.getSource())});h.transport(a.getSource(),a.type,{ruid:e.uid})}else b(a.getSource())},
loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(a,b){var c=this.getRuntime(),f=c.shimExec.call(this,"Image","getAsBlob",a,b);return f?new d(c.uid,f):null},getAsDataURL:function(){var a=this.getRuntime().Image.getAsBlob.apply(this,arguments),b;return a?(b=new g,b.readAsDataURL(a)):null}}});c("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],
function(a,b,c,d,g){function l(a){var b=!1,c=null,d,e,f,g,h,l=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(n){var q=navigator.plugins["Silverlight Plug-In"];if(q){d=q.description;"1.0.30226.2"===d&&(d="2.0.30226.2");for(e=d.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(f=a.split(".");4<f.length;)f.pop();do g=parseInt(f[l],10),h=parseInt(e[l],10),l++;while(l<f.length&&g===h);h>=g&&!isNaN(g)&&(b=!0)}}}catch(r){b=!1}return b}var r={};return g.addConstructor("silverlight",
function(m){var k=this,p;m=a.extend({xap_url:b.xap_url},m);g.call(this,m,"silverlight",{access_binary:g.capTrue,access_image_binary:g.capTrue,display_media:g.capTrue,do_cors:g.capTrue,drag_and_drop:!1,report_upload_progress:g.capTrue,resize_image:g.capTrue,return_response_headers:function(a){return a&&"client"===k.mode},return_response_type:g.capTrue,return_status_code:function(b){return"client"===k.mode||!a.arrayDiff(b,[200,404])},select_file:g.capTrue,select_multiple:g.capTrue,send_binary_string:g.capTrue,
send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"client"===k.mode},send_multipart:g.capTrue,slice_blob:g.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:g.capTrue,use_http_method:function(b){return"client"===k.mode||!a.arrayDiff(b,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(b){return a.arrayDiff(b,[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?
"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(b){return a.arrayDiff(b,["GET","POST"])?"client":["client","browser"]}});l("2.0.31005.0")&&"Opera"!==b.browser||(this.mode=!1);a.extend(this,{getShim:function(){return c.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+
m.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+b.global_event_dispatcher+'"/></object>';p=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR))},"Windows"!==b.OS?1E4:5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(p);m=p=a=k=null}}(this.destroy)},r)}),r});c("moxie/runtime/silverlight/file/Blob",
["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(a,b,c){return a.Blob=b.extend({},c)});c("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(a){return a.FileInput={init:function(a){this.getRuntime().shimExec.call(this,"FileInput","init",function(a){for(var b="",c=0;c<a.length;c++)b+=(""!==b?"|":"")+a[c].title+" | *."+a[c].extensions.replace(/,/g,";*.");return b}(a.accept),a.name,a.multiple);this.trigger("ready")}}});
c("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(a,b,c){return a.FileDrop={init:function(){var a=this.getRuntime(),d;return d=a.getShimContainer(),c.addEvent(d,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},this.uid),c.addEvent(d,"dragenter",function(c){c.preventDefault();b.get(a.uid).dragEnter(c)&&c.stopPropagation()},this.uid),c.addEvent(d,"drop",function(c){c.preventDefault();
b.get(a.uid).dragDrop(c)&&c.stopPropagation()},this.uid),a.shimExec.call(this,"FileDrop","init")}}});c("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(a,b,c){return a.FileReader=b.extend({},c)});c("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(a,b,c){return a.FileReaderSync=b.extend({},
c)});c("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(a,b,c){return a.XMLHttpRequest=b.extend({},c)});c("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(a,b,c){return a.Transporter=b.extend({},c)});c("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime",
"moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(a,b,c){return a.Image=b.extend({},c)});c("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(a,b,c,d){var g={};return c.addConstructor("html4",function(b){var h=this,m=c.capTest,k=c.capTrue;c.call(this,b,"html4",{access_binary:m(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:m(g.Image&&(d.can("create_canvas")||
d.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:m("Chrome"===d.browser&&28<=d.version||"IE"===d.browser&&10<=d.version),resize_image:function(){return g.Image&&h.can("access_binary")&&d.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(b){return!!~a.inArray(b,["json","text","document",""])},return_status_code:function(b){return!a.arrayDiff(b,[200,404])},select_file:function(){return d.can("use_fileinput")},select_multiple:!1,
send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return h.can("select_file")},summon_file_dialog:m("Firefox"===d.browser&&4<=d.version||"Opera"===d.browser&&12<=d.version||"IE"===d.browser&&10<=d.version||!!~a.inArray(d.browser,["Chrome","Safari"])),upload_filesize:k,use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}});a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(h);a=h=null}}(this.destroy)});
a.extend(this.getShim(),g)}),g});c("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(a,b,c,d,g,l){return a.FileInput=function(){function a(){var g=this,q=g.getRuntime(),t,A,z,w,u,v;v=b.guid("uid_");t=q.getShimContainer();m&&(z=c.get(m+"_form"),z&&b.extend(z.style,{top:"100%"}));w=document.createElement("form");w.setAttribute("id",v+"_form");w.setAttribute("method",
"post");w.setAttribute("enctype","multipart/form-data");w.setAttribute("encoding","multipart/form-data");b.extend(w.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});u=document.createElement("input");u.setAttribute("id",v);u.setAttribute("type","file");u.setAttribute("name","Filedata");u.setAttribute("accept",n.join(","));b.extend(u.style,{fontSize:"999px",opacity:0});w.appendChild(u);t.appendChild(w);b.extend(u.style,{position:"absolute",top:0,left:0,width:"100%",
height:"100%"});"IE"===l.browser&&10>l.version&&b.extend(u.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});u.onchange=function(){var b;this.value&&(b=this.files?this.files[0]:{name:this.value},k=[b],this.onchange=function(){},a.call(g),g.bind("change",function(){var a=c.get(v),b=c.get(v+"_form"),d;g.files.length&&a&&b&&(d=g.files[0],a.setAttribute("id",d.uid),b.setAttribute("id",d.uid+"_form"),b.setAttribute("target",d.uid+"_iframe"))},998),u=w=null,g.trigger("change"))};q.can("summon_file_dialog")&&
(A=c.get(s.browse_button),d.removeEvent(A,"click",g.uid),d.addEvent(A,"click",function(a){u&&!u.disabled&&u.click();a.preventDefault()},g.uid));m=v;t=z=A=null;g.trigger({type:"ready",async:!0})}var m,k=[],n=[],s;b.extend(this,{init:function(b){var h=this,k=h.getRuntime(),l;s=b;n=b.accept.mimes||g.extList2mimes(b.accept,k.can("filter_by_extension"));l=k.getShimContainer();(function(){var a,g;a=c.get(b.browse_button);k.can("summon_file_dialog")&&("static"===c.getStyle(a,"position")&&(a.style.position=
"relative"),g=parseInt(c.getStyle(a,"z-index"),10)||1,a.style.zIndex=g,l.style.zIndex=g-1);a=k.can("summon_file_dialog")?a:l;d.addEvent(a,"mouseover",function(){h.trigger("mouseenter")},h.uid);d.addEvent(a,"mouseout",function(){h.trigger("mouseleave")},h.uid);d.addEvent(a,"mousedown",function(){h.trigger("mousedown")},h.uid);d.addEvent(c.get(b.container),"mouseup",function(){h.trigger("mouseup")},h.uid);a=null})();a.call(this);l=null},getFiles:function(){return k},disable:function(a){var b;(b=c.get(m))&&
(b.disabled=!!a)},destroy:function(){var a=this.getRuntime().getShimContainer();d.removeAllEvents(a,this.uid);d.removeAllEvents(s&&c.get(s.container),this.uid);d.removeAllEvents(s&&c.get(s.browse_button),this.uid);a&&(a.innerHTML="");m=k=n=s=null}})}});c("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(a,b){return a.FileReader=b});c("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData moxie/core/JSON".split(" "),
function(a,b,c,d,g,l,r,m,k){return a.XMLHttpRequest=function(){function a(b){var d=this,e,g,h,k=!1;if(x){if(e=x.id.replace(/_iframe$/,""),g=c.get(e+"_form")){e=g.getElementsByTagName("input");for(h=e.length;h--;)switch(e[h].getAttribute("type")){case "hidden":e[h].parentNode.removeChild(e[h]);break;case "file":k=!0}e=[];k||g.parentNode.removeChild(g);g=null}setTimeout(function(){l.removeEvent(x,"load",d.uid);x.parentNode&&x.parentNode.removeChild(x);var a=d.getRuntime().getShimContainer();a.children.length||
a.parentNode.removeChild(a);x=null;b()},1)}}var n,y,x;b.extend(this,{send:function(k,A){var z=this,w=z.getRuntime(),u,v,B,C;if(n=y=null,A instanceof m&&A.hasBlob()){if(C=A.getBlob(),u=C.uid,B=c.get(u),v=c.get(u+"_form"),!v)throw new g.DOMException(g.DOMException.NOT_FOUND_ERR);}else u=b.guid("uid_"),v=document.createElement("form"),v.setAttribute("id",u+"_form"),v.setAttribute("method",k.method),v.setAttribute("enctype","multipart/form-data"),v.setAttribute("encoding","multipart/form-data"),v.setAttribute("target",
u+"_iframe"),w.getShimContainer().appendChild(v);A instanceof m&&A.each(function(a,c){if(a instanceof r)B&&B.setAttribute("name",c);else{var d=document.createElement("input");b.extend(d,{type:"hidden",name:c,value:a});v.appendChild(d)}});v.setAttribute("action",k.url);(function(){var c=w.getShimContainer()||document.body,f=document.createElement("div");f.innerHTML='<iframe id="'+u+'_iframe" name="'+u+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';x=f.firstChild;c.appendChild(x);
l.addEvent(x,"load",function(){var c;try{c=x.contentWindow.document||x.contentDocument||window.frames[x.id].document,/^4\d{2}\s/.test(c.title)&&c.getElementsByTagName("address").length?n=c.title.replace(/^(\d+).*$/,"$1"):(n=200,y=b.trim(c.body.innerHTML),z.trigger({type:"progress",loaded:y.length,total:y.length}),C&&z.trigger({type:"uploadprogress",loaded:C.size||1025,total:C.size||1025}))}catch(f){if(!d.hasSameOrigin(k.url))return a.call(z,function(){z.trigger("error")}),void 0;n=404}a.call(z,function(){z.trigger("load")})},
z.uid)})();v.submit();z.trigger("loadstart")},getStatus:function(){return n},getResponse:function(a){if("json"===a&&"string"===b.typeOf(y))try{return k(y.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(c){return null}return y},abort:function(){var b=this;x&&x.contentWindow&&(x.contentWindow.stop?x.contentWindow.stop():x.contentWindow.document.execCommand?x.contentWindow.document.execCommand("Stop"):x.src="about:blank");a.call(this,function(){b.dispatchEvent("abort")})}})}});c("moxie/runtime/html4/image/Image",
["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(a,b){return a.Image=b});(function(c){for(var d=0;d<c.length;d++){for(var f=b,e=c[d],q=e.split(/[.\/]/),l=0;l<q.length-1;++l)f[q[l]]===a&&(f[q[l]]={}),f=f[q[l]];f[q[q.length-1]]=g[e]}})("moxie/core/utils/Basic moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Env moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/file/File moxie/file/FileInput moxie/file/FileDrop moxie/runtime/RuntimeTarget moxie/file/FileReader moxie/core/utils/Url moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/core/JSON moxie/image/Image moxie/core/utils/Events".split(" "))}(this);
(function(){var b={},a=moxie.core.utils.Basic.inArray;return function c(g){var n,h;for(n in g)h=typeof g[n],"object"!==h||~a(n,["Exceptions","Env","Mime"])?"function"===h&&(b[n]=g[n]):c(g[n])}(window.moxie),b.Env=window.moxie.core.utils.Env,b.Mime=window.moxie.core.utils.Mime,b.Exceptions=window.moxie.core.Exceptions,window.mOxie=b,window.o||(window.o=b),b})();
(function(b,a,d){function c(a){function b(a,c,e){var f={chunks:"slice_blob",resize:"send_binary_string",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",max_file_size:"access_binary",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};f[a]?d[f[a]]=c:e||(d[a]=c)}var c=a.required_features,d={};return"string"==typeof c?h.each(c.split(/\s*,\s*/),
function(a){b(a,!0)}):"object"==typeof c?h.each(c,function(a,c){b(c,a)}):!0===c&&(a.multipart||(d.send_binary_string=!0),0<a.chunk_size&&(d.slice_blob=!0),h.each(a,function(a,c){b(c,!!a,!0)})),d}var g=b.setTimeout,n={},h={VERSION:"2.0.0beta",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,
IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:a.mimes,ua:a.ua,typeOf:a.typeOf,extend:a.extend,guid:a.guid,each:a.each,getPos:a.getPos,getSize:a.getSize,xmlEncode:function(a){var b={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},c=/[<>&\"\']/g;return a?(""+a).replace(c,function(a){return b[a]?"&"+b[a]+";":a}):a},toArray:a.toArray,inArray:a.inArray,addI18n:a.addI18n,translate:a.translate,isEmptyObj:a.isEmptyObj,hasClass:a.hasClass,addClass:a.addClass,removeClass:a.removeClass,getStyle:a.getStyle,addEvent:a.addEvent,
removeEvent:a.removeEvent,removeAllEvents:a.removeAllEvents,cleanName:function(a){var b,c;c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<c.length;b+=2)a=a.replace(c[b],c[b+1]);return a=a.replace(/\s+/g,"_"),a=a.replace(/[^a-z0-9_\-\.]+/gi,""),a},buildUrl:function(a,b){var c="";return h.each(b,function(a,
b){c+=(c?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)}),c&&(a+=(0<a.indexOf("?")?"&":"?")+c),a},formatSize:function(a){return a===d||/\D/.test(a)?h.translate("N/A"):1099511627776<a?Math.round(a/1099511627776,1)+" "+h.translate("tb"):1073741824<a?Math.round(a/1073741824,1)+" "+h.translate("gb"):1048576<a?Math.round(a/1048576,1)+" "+h.translate("mb"):1024<a?Math.round(a/1024,1)+" "+h.translate("kb"):a+" "+h.translate("b")},parseSize:a.parseSizeStr,predictRuntime:function(a,b){var c,d;return b&&
(a.runtimes=b),c=new h.Uploader(a),d=c.runtime,c.destroy(),d},addFileFilter:function(a,b){n[a]=b}};h.addFileFilter("mime_types",function(){function a(b){var c=[];return h.each(b,function(a){h.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?c.push("\\.*"):c.push("\\."+a.replace(RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),RegExp("("+c.join("|")+")$","i")}var b,c;return function(d,g){c&&d==b||(c=a(d),b=[].slice.call(d));return c.test(g.name)?!0:(this.trigger("Error",
{code:h.FILE_EXTENSION_ERROR,message:h.translate("File extension error."),file:g}),!1)}}());h.addFileFilter("max_file_size",function(a,b){return void 0!==b.size&&a&&b.size>a?(this.trigger("Error",{code:h.FILE_SIZE_ERROR,message:h.translate("File size error."),file:b}),!1):!0});h.addFileFilter("prevent_duplicates",function(a,b){if(a)for(var c=this.files.length;c--;)if(b.name===this.files[c].name&&b.size===this.files[c].size)return this.trigger("Error",{code:h.FILE_DUPLICATE_ERROR,message:h.translate("Duplicate file error."),
file:b}),!1;return!0});h.Uploader=function(b){function e(){var a,b=0,c;if(this.state==h.STARTED){for(c=0;c<p.length;c++)a||p[c].status!=h.QUEUED?b++:(a=p[c],this.trigger("BeforeUpload",a)&&(a.status=h.UPLOADING,this.trigger("UploadFile",a)));b==p.length&&(this.state!==h.STOPPED&&(this.state=h.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",p))}}function q(a){a.percent=0<a.size?Math.ceil(100*(a.loaded/a.size)):100;l()}function l(){var a,b;t.reset();for(a=0;a<p.length;a++)b=p[a],
b.size!==d?(t.size+=b.origSize,t.loaded+=b.loaded*b.origSize/b.size):t.size=d,b.status==h.DONE?t.uploaded++:b.status==h.FAILED?t.failed++:t.queued++;t.size===d?t.percent=0<p.length?Math.ceil(100*(t.uploaded/p.length)):0:(t.bytesPerSec=Math.ceil(t.loaded/((+new Date-x||1)/1E3)),t.percent=0<t.size?Math.ceil(100*(t.loaded/t.size)):0)}function r(){var c=this,d=0,e={accept:b.filters.mime_types,runtime_order:b.runtimes,required_caps:y,swf_url:b.flash_swf_url,xap_url:b.silverlight_xap_url};h.each(b.runtimes.split(/\s*,\s*/),
function(a){b[a]&&(e[a]=b[a])});a.inSeries([function(g){b.browse_button?(z=new a.FileInput(h.extend({},e,{name:b.file_data_name,multiple:b.multi_selection,container:b.container,browse_button:b.browse_button})),z.onready=function(){var b=a.Runtime.getInfo(this.ruid);a.extend(c.features,{chunks:b.can("slice_blob"),multipart:b.can("send_multipart"),multi_selection:b.can("select_multiple")});d++;g()},z.onchange=function(){c.addFile(this.files)},z.bind("mouseenter mouseleave mousedown mouseup",function(c){if(!A){var d=
a.get(b.browse_button);d&&(b.browse_button_hover&&("mouseenter"===c.type?a.addClass(d,b.browse_button_hover):"mouseleave"===c.type&&a.removeClass(d,b.browse_button_hover)),b.browse_button_active&&("mousedown"===c.type?a.addClass(d,b.browse_button_active):"mouseup"===c.type&&a.removeClass(d,b.browse_button_active)))}}),z.bind("error runtimeerror",function(){z=null;g()}),z.init()):g()},function(g){b.drop_element?(w=new a.FileDrop(h.extend({},e,{drop_zone:b.drop_element})),w.onready=function(){var b=
a.Runtime.getInfo(this.ruid);c.features.dragdrop=b.can("drag_and_drop");d++;g()},w.ondrop=function(){c.addFile(this.files)},w.bind("error runtimeerror",function(){w=null;g()}),w.init()):g()}],function(){"function"==typeof b.init?b.init(c):h.each(b.init,function(a,b){c.bind(b,a)});d?c.trigger("PostInit"):c.trigger("Error",{code:h.INIT_ERROR,message:h.translate("Init error.")})})}function m(b,c){if(b.ruid){var d=a.Runtime.getInfo(b.ruid);if(d)return d.can(c)}return!1}function k(b,c,d){var e=new a.Image;
try{e.onload=function(){e.downsize(c.width,c.height,c.crop,c.preserve_headers)},e.onresize=function(){d(this.getAsBlob(b.type,c.quality));this.destroy()},e.onerror=function(){d(b)},e.load(b)}catch(f){d(b)}}var p=[],s={},y={},x,t,A=!1,z,w,u;t=new h.QueueProgress;b=h.extend({runtimes:a.Runtime.order,max_retries:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",send_chunk_number:!0},b);b.resize&&(b.resize=h.extend({preserve_headers:!0,
crop:!1},b.resize));b.chunk_size=h.parseSize(b.chunk_size)||0;"array"===h.typeOf(b.filters)&&(b.filters={mime_types:b.filters});b.filters=h.extend({mime_types:[],prevent_duplicates:!!b.prevent_duplicates,max_file_size:h.parseSize(b.max_file_size)||0},b.filters);b.required_features=y=c(h.extend({},b));h.extend(this,{id:h.guid(),state:h.STOPPED,features:{},runtime:a.Runtime.thatCan(y,b.runtimes),files:p,settings:b,total:t,init:function(){var c=this;b.browse_button=a.get(b.browse_button);b.drop_element=
a.get(b.drop_element);"function"==typeof b.preinit?b.preinit(c):h.each(b.preinit,function(a,b){c.bind(b,a)});b.browse_button&&b.url?(c.bind("BeforeAdd",function(a,b){var c,d=a.settings.filters;for(c in d)if(n[c]&&!n[c].call(this,d[c],b))return!1}),c.bind("FilesAdded",function(a,b){[].push.apply(p,b);g(function(){c.trigger("QueueChanged");c.refresh()},1)}),c.bind("CancelUpload",function(){u&&u.abort()}),b.unique_names&&c.bind("BeforeUpload",function(a,b){var c=b.name.match(/\.([^.]+)$/),d="part";c&&
(d=c[1]);b.target_name=b.id+"."+d}),c.bind("UploadFile",function(c,d){function e(){0<r--?g(l,1):(d.loaded=v,c.trigger("Error",{code:h.HTTP_ERROR,message:h.translate("HTTP Error."),file:d,response:u.responseText,status:u.status,responseHeaders:u.getAllResponseHeaders()}))}function l(){var k,m,r,t;d.status!=h.DONE&&(d.status!=h.FAILED&&c.state!=h.STOPPED)&&(r={name:d.target_name||d.name},q&&p.chunks&&s.size>q?(t=Math.min(q,s.size-v),k=s.slice(v,v+t)):(t=s.size,k=s),q&&p.chunks&&(b.send_chunk_number?
(r.chunk=Math.ceil(v/q),r.chunks=Math.ceil(s.size/q)):(r.offset=v,r.total=s.size)),u=new a.XMLHttpRequest,u.upload&&(u.upload.onprogress=function(a){d.loaded=Math.min(d.size,v+a.loaded);c.trigger("UploadProgress",d)}),u.onload=function(){400<=u.status?e():(t<s.size?(k.destroy(),v+=t,d.loaded=Math.min(v,s.size),c.trigger("ChunkUploaded",d,{offset:d.loaded,total:s.size,response:u.responseText,status:u.status,responseHeaders:u.getAllResponseHeaders()}),"Android Browser"===a.Env.browser&&c.trigger("UploadProgress",
d)):d.loaded=d.size,k=m=null,!v||v>=s.size?(d.size!=d.origSize&&(s.destroy(),s=null),c.trigger("UploadProgress",d),d.status=h.DONE,c.trigger("FileUploaded",d,{response:u.responseText,status:u.status,responseHeaders:u.getAllResponseHeaders()})):g(l,1))},u.onerror=function(){e()},u.onloadend=function(){this.destroy();u=null},c.settings.multipart&&p.multipart?(r.name=d.target_name||d.name,u.open("post",n,!0),h.each(c.settings.headers,function(a,b){u.setRequestHeader(b,a)}),m=new a.FormData,h.each(h.extend(r,
c.settings.multipart_params),function(a,b){m.append(b,a)}),m.append(c.settings.file_data_name,k),u.send(m,{runtime_order:c.settings.runtimes,required_caps:y,swf_url:c.settings.flash_swf_url,xap_url:c.settings.silverlight_xap_url})):(n=h.buildUrl(c.settings.url,h.extend(r,c.settings.multipart_params)),u.open("post",n,!0),u.setRequestHeader("Content-Type","application/octet-stream"),h.each(c.settings.headers,function(a,b){u.setRequestHeader(b,a)}),u.send(k,{runtime_order:c.settings.runtimes,required_caps:y,
swf_url:c.settings.flash_swf_url,xap_url:c.settings.silverlight_xap_url})))}var n=c.settings.url,p=c.features,q=b.chunk_size,r=b.max_retries,s,v=0;d.loaded&&(v=d.loaded=q*Math.floor(d.loaded/q));s=d.getSource();!a.isEmptyObj(c.settings.resize)&&m(s,"send_binary_string")&&~a.inArray(s.type,["image/jpeg","image/png"])?k.call(this,s,c.settings.resize,function(a){s=a;d.size=a.size;l()}):l()}),c.bind("UploadProgress",function(a,b){q(b)}),c.bind("StateChanged",function(a){if(a.state==h.STARTED)x=+new Date;
else if(a.state==h.STOPPED)for(var b=a.files.length-1;0<=b;b--)a.files[b].status==h.UPLOADING&&(a.files[b].status=h.QUEUED,l())}),c.bind("QueueChanged",l),c.bind("Error",function(a,b){b.file&&(b.file.status=h.FAILED,q(b.file),a.state==h.STARTED&&g(function(){e.call(c)},1))}),c.bind("FileUploaded",function(){l();g(function(){e.call(c)},1)}),c.trigger("Init",{runtime:this.runtime}),r.call(this)):this.trigger("Error",{code:h.INIT_ERROR,message:h.translate("Init error.")})},refresh:function(){z&&z.trigger("Refresh");
this.trigger("Refresh")},start:function(){this.state!=h.STARTED&&(this.state=h.STARTED,this.trigger("StateChanged"),e.call(this))},stop:function(){this.state!=h.STOPPED&&(this.state=h.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(a){A=a!==d?a:!0;z&&z.disable(A);this.trigger("DisableBrowse",A)},getFile:function(a){var b;for(b=p.length-1;0<=b;b--)if(p[b].id===a)return p[b]},addFile:function(b,c){function d(b){var k=a.typeOf(b);if(b instanceof a.File){if(!b.ruid){if(!g)return!1;
b.ruid=g;b.connectRuntime(g)}d(new h.File(b))}else b instanceof a.Blob?(d(b.getSource()),b.destroy()):b instanceof h.File?(c&&(b.name=c),e.trigger("BeforeAdd",b)&&f.push(b)):-1!==a.inArray(k,["file","blob"])?d(new a.File(null,b)):"node"===k&&"filelist"===a.typeOf(b.files)?a.each(b.files,d):"array"===k&&(c=null,a.each(b,d))}var e=this,f=[],g;g=function(){var a=w||z;return a?a.getRuntime().uid:!1}();d(b);f.length&&this.trigger("FilesAdded",f)},removeFile:function(a){a="string"==typeof a?a:a.id;for(var b=
p.length-1;0<=b;b--)if(p[b].id===a)return this.splice(b,1)[0]},splice:function(a,b){var c=p.splice(a===d?0:a,b===d?p.length:b);return this.trigger("FilesRemoved",c),this.trigger("QueueChanged"),h.each(c,function(a){a.destroy()}),c},trigger:function(a){var b=s[a.toLowerCase()],c,d;if(b)for(d=Array.prototype.slice.call(arguments),d[0]=this,c=0;c<b.length;c++)if(!1===b[c].func.apply(b[c].scope,d))return!1;return!0},hasEventListener:function(a){return!!s[a.toLowerCase()]},bind:function(a,b,c){var d;a=
a.toLowerCase();d=s[a]||[];d.push({func:b,scope:c||this});s[a]=d},unbind:function(a,b){a=a.toLowerCase();var c=s[a],e;if(c){if(b!==d)for(e=c.length-1;0<=e;e--){if(c[e].func===b){c.splice(e,1);break}}else c=[];c.length||delete s[a]}},unbindAll:function(){var a=this;h.each(s,function(b,c){a.unbind(c)})},destroy:function(){this.stop();h.each(p,function(a){a.destroy()});p=[];z&&(z.destroy(),z=null);w&&(w.destroy(),w=null);y={};x=t=A=u=null;this.trigger("Destroy");this.unbindAll();s={}}})};h.File=function(){var b=
{};return function(c){h.extend(this,{id:h.guid(),name:c.name||c.fileName,type:c.type||"",size:c.size||c.fileSize,origSize:c.size||c.fileSize,loaded:0,percent:0,status:h.QUEUED,lastModifiedDate:c.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var b=this.getSource().getSource();return-1!==a.inArray(a.typeOf(b),["blob","file"])?b:null},getSource:function(){return b[this.id]?b[this.id]:null},destroy:function(){var a=this.getSource();a&&(a.destroy(),delete b[this.id])}});b[this.id]=
c}}();h.QueueProgress=function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}};b.plupload=h})(window,mOxie);(function(b){function a(a){return plupload.translate(a)||a}function d(c,d){d.contents().each(function(a,c){c=b(c);c.is(".plupload")||c.remove()});d.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+c+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+a("Select files")+'</div><div class="plupload_header_text">'+a("Add files to queue and click upload.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+
a("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+a("Status")+'</span></div><div class="plupload_file_size">'+a("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+c+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add" id="'+c+'_browse">'+a("Add")+'</a><a href="#" class="plupload_button plupload_start">'+
a("Upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+
c+'_count" name="'+c+'_count" value="0" /></div>')}var c={};b.fn.pluploadQueue=function(g){return g?(this.each(function(){function n(a){var c;a.status==plupload.DONE&&(c="plupload_done");a.status==plupload.FAILED&&(c="plupload_failed");a.status==plupload.QUEUED&&(c="plupload_delete");a.status==plupload.UPLOADING&&(c="plupload_uploading");c=b("#"+a.id).attr("class",c).find("a").css("display","block");a.hint&&c.attr("title",a.hint)}function h(){b("span.plupload_total_status",q).html(e.total.percent+
"%");b("div.plupload_progress_bar",q).css("width",e.total.percent+"%");b("span.plupload_upload_status",q).html(a("Uploaded %d/%d files").replace(/%d\/%d/,e.total.uploaded+"/"+e.files.length))}function f(){var c=b("ul.plupload_filelist",q).html(""),d=0,f;b.each(e.files,function(a,g){f="";g.status==plupload.DONE&&(g.target_name&&(f+='<input type="hidden" name="'+l+"_"+d+'_tmpname" value="'+plupload.xmlEncode(g.target_name)+'" />'),f+='<input type="hidden" name="'+l+"_"+d+'_name" value="'+plupload.xmlEncode(g.name)+
'" />',f+='<input type="hidden" name="'+l+"_"+d+'_status" value="'+(g.status==plupload.DONE?"done":"failed")+'" />',d++,b("#"+l+"_count").val(d));c.append('<li id="'+g.id+'"><div class="plupload_file_name"><span>'+g.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+g.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(g.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+f+"</li>");n(g);b("#"+g.id+".plupload_delete a").click(function(a){b("#"+
g.id).remove();e.removeFile(g);a.preventDefault()})});b("span.plupload_total_file_size",q).html(plupload.formatSize(e.total.size));0===e.total.queued?b("span.plupload_add_text",q).html(a("Add")):b("span.plupload_add_text",q).html(a("%d files queued").replace(/%d/,e.total.queued));b("a.plupload_start",q).toggleClass("plupload_disabled",e.files.length==e.total.uploaded+e.total.failed);c[0].scrollTop=c[0].scrollHeight;h();!e.files.length&&(e.features.dragdrop&&e.settings.dragdrop)&&b("#"+l+"_filelist").append('<li class="plupload_droptext">'+
a("Drag files here.")+"</li>")}var e,q,l,r;q=b(this);l=q.attr("id");l||(l=plupload.guid(),q.attr("id",l));r=q.html();d(l,q);e=new plupload.Uploader(b.extend({dragdrop:!0,browse_button:l+"_browse",container:l},g));c[l]=e;e.bind("UploadFile",function(a,c){b("#"+c.id).addClass("plupload_current_file")});e.bind("Init",function(a,c){if(!g.unique_names&&g.rename)q.on("click","#"+l+"_filelist div.plupload_file_name span",function(c){var d=b(c.target),e,f,g="";e=a.getFile(d.parents("li")[0].id);f=e.name;
if(c=/^(.+)(\.[^.]+)$/.exec(f))f=c[1],g=c[2];d.hide().after('<input type="text" />');d.next().val(f).focus().blur(function(){d.show().next().remove()}).keydown(function(a){var c=b(this);13==a.keyCode&&(a.preventDefault(),e.name=c.val()+g,d.html(e.name),c.blur())})});a.settings.dragdrop&&(a.settings.drop_element=l+"_filelist");b("#"+l+"_container").attr("title","Using runtime: "+c.runtime);b("a.plupload_start",q).click(function(a){b(this).hasClass("plupload_disabled")||e.start();a.preventDefault()});
b("a.plupload_stop",q).click(function(a){a.preventDefault();e.stop()});b("a.plupload_start",q).addClass("plupload_disabled")});e.bind("Error",function(d,f){var g=f.file,h;g&&(h=f.message,f.details&&(h+=" ("+f.details+")"),f.code==plupload.FILE_SIZE_ERROR&&alert(a("Error: File too large:")+" "+g.name),f.code==plupload.FILE_EXTENSION_ERROR&&alert(a("Error: Invalid file extension:")+" "+g.name),g.hint=h,b("#"+g.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",h));f.code===
plupload.INIT_ERROR&&setTimeout(function(){delete c[l];e.destroy();q.html(r);e=q=r=null},1)});e.bind("PostInit",function(c){c.settings.dragdrop&&c.features.dragdrop&&b("#"+l+"_filelist").append('<li class="plupload_droptext">'+a("Drag files here.")+"</li>")});e.init();e.bind("StateChanged",function(){e.state===plupload.STARTED?(b("li.plupload_delete a,div.plupload_buttons",q).hide(),b("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",q).css("display","block"),b("span.plupload_upload_status",
q).html("Uploaded "+e.total.uploaded+"/"+e.files.length+" files"),g.multiple_queues&&b("span.plupload_total_status,span.plupload_total_file_size",q).show()):(f(),b("a.plupload_stop,div.plupload_progress",q).hide(),b("a.plupload_delete",q).css("display","block"),g.multiple_queues&&e.total.uploaded+e.total.failed==e.files.length&&(b(".plupload_buttons,.plupload_upload_status",q).css("display","inline"),b(".plupload_start",q).addClass("plupload_disabled"),b("span.plupload_total_status,span.plupload_total_file_size",
q).hide()))});e.bind("QueueChanged",f);e.bind("FileUploaded",function(a,b){n(b)});e.bind("UploadProgress",function(a,c){b("#"+c.id+" div.plupload_file_status",q).html(c.percent+"%");n(c);h()});g.setup&&g.setup(e)}),this):c[b(this[0]).attr("id")]}})(jQuery);(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):b(window.jQuery)})(function(b){var a=0;b.ajaxTransport("iframe",function(d){if(d.async){var c,g,n;return{send:function(h,f){c=b('<form style="display:none;"></form>');c.attr("accept-charset",d.formAcceptCharset);n=/\?/.test(d.url)?"&":"?";"DELETE"===d.type?(d.url=d.url+n+"_method=DELETE",d.type="POST"):"PUT"===d.type?(d.url=d.url+n+"_method=PUT",d.type="POST"):"PATCH"===d.type&&(d.url=d.url+n+"_method=PATCH",d.type="POST");a+=
1;g=b('<iframe src="javascript:false;" name="iframe-transport-'+a+'"></iframe>').bind("load",function(){var a,h=b.isArray(d.paramName)?d.paramName:[d.paramName];g.unbind("load").bind("load",function(){var a;try{if(a=g.contents(),!a.length||!a[0].firstChild)throw Error();}catch(d){a=void 0}f(200,"success",{iframe:a});b('<iframe src="javascript:false;"></iframe>').appendTo(c);window.setTimeout(function(){c.remove()},0)});c.prop("target",g.prop("name")).prop("action",d.url).prop("method",d.type);d.formData&&
b.each(d.formData,function(a,d){b('<input type="hidden"/>').prop("name",d.name).val(d.value).appendTo(c)});d.fileInput&&(d.fileInput.length&&"POST"===d.type)&&(a=d.fileInput.clone(),d.fileInput.after(function(b){return a[b]}),d.paramName&&d.fileInput.each(function(a){b(this).prop("name",h[a]||d.paramName)}),c.append(d.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"));c.submit();a&&a.length&&d.fileInput.each(function(c,d){var f=b(a[c]);b(d).prop("name",f.prop("name"));
f.replaceWith(d)})});c.append(g).appendTo(document.body)},abort:function(){g&&g.unbind("load").prop("src","javascript".concat(":false;"));c&&c.remove()}}}});b.ajaxSetup({converters:{"iframe text":function(a){return a&&b(a[0].body).text()},"iframe json":function(a){return a&&b.parseJSON(b(a[0].body).text())},"iframe html":function(a){return a&&b(a[0].body).html()},"iframe xml":function(a){return(a=a&&a[0])&&b.isXMLDoc(a)?a:b.parseXML(a.XMLDocument&&a.XMLDocument.xml||b(a.body).html())},"iframe script":function(a){return a&&
b.globalEval(b(a[0].body).text())}}})});(function(b){"function"===typeof define&&define.amd?define(["jquery","jquery.ui.widget"],b):b(window.jQuery)})(function(b){b.support.fileInput=!(RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||b('<input type="file">').prop("disabled"));b.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader);b.support.xhrFormDataFileUpload=!!window.FormData;
b.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);b.widget("blueimp.fileupload",{options:{dropZone:b(document),pasteZone:b(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,
progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(a,d){a=this.messages[a]||a.toString();d&&b.each(d,function(b,d){a=a.replace("{"+b+"}",d)});return a},formData:function(a){return a.serializeArray()},add:function(a,d){(d.autoUpload||!1!==d.autoUpload&&b(this).fileupload("option","autoUpload"))&&d.process().done(function(){d.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone",
"multipart","forceIframeTransport"],_blobSlice:b.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.bitrate=this.loaded=0;this.getBitrate=function(a,b,c){var g=a-this.timestamp;if(!this.bitrate||!c||g>c)this.bitrate=8*(b-this.loaded)*(1E3/g),this.loaded=b,this.timestamp=a;return this.bitrate}},_isXHRUpload:function(a){return!a.forceIframeTransport&&(!a.multipart&&
b.support.xhrFileUpload||b.support.xhrFormDataFileUpload)},_getFormData:function(a){var d;return"function"===typeof a.formData?a.formData(a.form):b.isArray(a.formData)?a.formData:"object"===b.type(a.formData)?(d=[],b.each(a.formData,function(a,b){d.push({name:a,value:b})}),d):[]},_getTotal:function(a){var d=0;b.each(a,function(a,b){d+=b.size||1});return d},_initProgressObject:function(a){var d={loaded:0,total:0,bitrate:0};a._progress?b.extend(a._progress,d):a._progress=d},_initResponseObject:function(a){var b;
if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&delete a._response[b];else a._response={}},_onProgress:function(a,b){if(a.lengthComputable){var c=Date.now?Date.now():(new Date).getTime(),g;b._time&&b.progressInterval&&c-b._time<b.progressInterval&&a.loaded!==a.total||(b._time=c,g=Math.floor(a.loaded/a.total*(b.chunkSize||b._progress.total))+(b.uploadedBytes||0),this._progress.loaded+=g-b._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(c,this._progress.loaded,
b.bitrateInterval),b._progress.loaded=b.loaded=g,b._progress.bitrate=b.bitrate=b._bitrateTimer.getBitrate(c,g,b.bitrateInterval),this._trigger("progress",a,b),this._trigger("progressall",a,this._progress))}},_initProgressListener:function(a){var d=this,c=a.xhr?a.xhr():b.ajaxSettings.xhr();c.upload&&(b(c.upload).bind("progress",function(b){var c=b.originalEvent;b.lengthComputable=c.lengthComputable;b.loaded=c.loaded;b.total=c.total;d._onProgress(b,a)}),a.xhr=function(){return c})},_isInstanceOf:function(a,
b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(a){var d=this,c,g=a.files[0],n=a.multipart||!b.support.xhrFileUpload,h=a.paramName[0];a.headers=b.extend({},a.headers);a.contentRange&&(a.headers["Content-Range"]=a.contentRange);n&&!a.blob&&this._isInstanceOf("File",g)||(a.headers["Content-Disposition"]='attachment; filename="'+encodeURI(g.name)+'"');n?b.support.xhrFormDataFileUpload&&(a.postMessage?(c=this._getFormData(a),a.blob?c.push({name:h,value:a.blob}):b.each(a.files,
function(b,d){c.push({name:a.paramName[b]||h,value:d})})):(d._isInstanceOf("FormData",a.formData)?c=a.formData:(c=new FormData,b.each(this._getFormData(a),function(a,b){c.append(b.name,b.value)})),a.blob?c.append(h,a.blob,g.name):b.each(a.files,function(b,e){(d._isInstanceOf("File",e)||d._isInstanceOf("Blob",e))&&c.append(a.paramName[b]||h,e,e.name)})),a.data=c):(a.contentType=g.type,a.data=a.blob||g);a.blob=null},_initIframeSettings:function(a){var d=b("<a></a>").prop("href",a.url).prop("host");
a.dataType="iframe "+(a.dataType||"");a.formData=this._getFormData(a);a.redirect&&(d&&d!==location.host)&&a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(a){var d=b(a.fileInput),c=a.paramName;c?b.isArray(c)||(c=[c]):(c=[],
d.each(function(){for(var a=b(this),d=a.prop("name")||"files[]",a=(a.prop("files")||[1]).length;a;)c.push(d),a-=1}),c.length||(c=[d.prop("name")||"files[]"]));return c},_initFormSettings:function(a){a.form&&a.form.length||(a.form=b(a.fileInput.prop("form")),a.form.length||(a.form=b(this.options.fileInput.prop("form"))));a.paramName=this._getParamName(a);a.url||(a.url=a.form.prop("action")||location.href);a.type=(a.type||a.form.prop("method")||"").toUpperCase();"POST"!==a.type&&("PUT"!==a.type&&"PATCH"!==
a.type)&&(a.type="POST");a.formAcceptCharset||(a.formAcceptCharset=a.form.attr("accept-charset"))},_getAJAXSettings:function(a){a=b.extend({},this.options,a);this._initFormSettings(a);this._initDataSettings(a);return a},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?"rejected":"pending"},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(a,d,c){var g=b.Deferred(),n=g.promise();d=d||this.options.context||
n;!0===a?g.resolveWith(d,c):!1===a&&g.rejectWith(d,c);n.abort=g.promise;return this._enhancePromise(n)},_addConvenienceMethods:function(a,d){var c=this;d.process=function(a,n){if(a||n)d._processQueue=this._processQueue=(this._processQueue||b.Deferred().resolveWith(c,[this]).promise()).pipe(a,n);return this._processQueue||b.Deferred().resolveWith(c,[this]).promise()};d.submit=function(){"pending"!==this.state()&&(d.jqXHR=this.jqXHR=!1!==c._trigger("submit",a,this)&&c._onSend(a,this));return this.jqXHR||
c._getXHRPromise()};d.abort=function(){return this.jqXHR?this.jqXHR.abort():c._getXHRPromise()};d.state=function(){if(this.jqXHR)return c._getDeferredState(this.jqXHR);if(this._processQueue)return c._getDeferredState(this._processQueue)};d.progress=function(){return this._progress};d.response=function(){return this._response}},_getUploadedBytes:function(a){return(a=(a=(a=a.getResponseHeader("Range"))&&a.split("-"))&&1<a.length&&parseInt(a[1],10))&&a+1},_chunkedUpload:function(a,d){a.uploadedBytes=
a.uploadedBytes||0;var c=this,g=a.files[0],n=g.size,h=a.uploadedBytes,f=a.maxChunkSize||n,e=this._blobSlice,q=b.Deferred(),l=q.promise(),r,m;if(!(this._isXHRUpload(a)&&e&&(h||f<n))||a.data)return!1;if(d)return!0;if(h>=n)return g.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",g.error]);m=function(){var d=b.extend({},a),l=d._progress.loaded;d.blob=e.call(g,h,h+f,g.type);d.chunkSize=d.blob.size;d.contentRange="bytes "+h+"-"+(h+d.chunkSize-1)+"/"+n;c._initXHRData(d);c._initProgressListener(d);
r=(!1!==c._trigger("chunksend",null,d)&&b.ajax(d)||c._getXHRPromise(!1,d.context)).done(function(e,f,g){h=c._getUploadedBytes(g)||h+d.chunkSize;l+d.chunkSize-d._progress.loaded&&c._onProgress(b.Event("progress",{lengthComputable:!0,loaded:h-d.uploadedBytes,total:h-d.uploadedBytes}),d);a.uploadedBytes=d.uploadedBytes=h;d.result=e;d.textStatus=f;d.jqXHR=g;c._trigger("chunkdone",null,d);c._trigger("chunkalways",null,d);h<n?m():q.resolveWith(d.context,[e,f,g])}).fail(function(a,b,e){d.jqXHR=a;d.textStatus=
b;d.errorThrown=e;c._trigger("chunkfail",null,d);c._trigger("chunkalways",null,d);q.rejectWith(d.context,[a,b,e])})};this._enhancePromise(l);l.abort=function(){return r.abort()};m();return l},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(b);this._initProgressObject(b);b._progress.loaded=b.loaded=b.uploadedBytes||0;b._progress.total=b.total=
this._getTotal(b.files)||1;b._progress.bitrate=b.bitrate=0;this._active+=1;this._progress.loaded+=b.loaded;this._progress.total+=b.total},_onDone:function(a,d,c,g){var n=g._progress.total,h=g._response;g._progress.loaded<n&&this._onProgress(b.Event("progress",{lengthComputable:!0,loaded:n,total:n}),g);h.result=g.result=a;h.textStatus=g.textStatus=d;h.jqXHR=g.jqXHR=c;this._trigger("done",null,g)},_onFail:function(a,b,c,g){var n=g._response;g.recalculateProgress&&(this._progress.loaded-=g._progress.loaded,
this._progress.total-=g._progress.total);n.jqXHR=g.jqXHR=a;n.textStatus=g.textStatus=b;n.errorThrown=g.errorThrown=c;this._trigger("fail",null,g)},_onAlways:function(a,b,c,g){this._trigger("always",null,g)},_onSend:function(a,d){d.submit||this._addConvenienceMethods(a,d);var c=this,g,n,h,f,e=c._getAJAXSettings(d),q=function(){c._sending+=1;e._bitrateTimer=new c._BitrateTimer;return g=g||((n||!1===c._trigger("send",a,e))&&c._getXHRPromise(!1,e.context,n)||c._chunkedUpload(e)||b.ajax(e)).done(function(a,
b,d){c._onDone(a,b,d,e)}).fail(function(a,b,d){c._onFail(a,b,d,e)}).always(function(a,b,d){c._onAlways(a,b,d,e);c._sending-=1;c._active-=1;if(e.limitConcurrentUploads&&e.limitConcurrentUploads>c._sending)for(a=c._slots.shift();a;){if("pending"===c._getDeferredState(a)){a.resolve();break}a=c._slots.shift()}0===c._active&&c._trigger("stop")})};this._beforeSend(a,e);return this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(1<this.options.limitConcurrentUploads?
(h=b.Deferred(),this._slots.push(h),f=h.pipe(q)):f=this._sequence=this._sequence.pipe(q,q),f.abort=function(){n=[void 0,"abort","abort"];return g?g.abort():(h&&h.rejectWith(e.context,n),q())},this._enhancePromise(f)):q()},_onAdd:function(a,d){var c=this,g=!0,n=b.extend({},this.options,d),h=n.limitMultiFileUploads,f=this._getParamName(n),e,q,l;if((n.singleFileUploads||h)&&this._isXHRUpload(n))if(!n.singleFileUploads&&h)for(q=[],e=[],l=0;l<d.files.length;l+=h)q.push(d.files.slice(l,l+h)),n=f.slice(l,
l+h),n.length||(n=f),e.push(n);else e=f;else q=[d.files],e=[f];d.originalFiles=d.files;b.each(q||d.files,function(f,h){var k=b.extend({},d);k.files=q?h:[h];k.paramName=e[f];c._initResponseObject(k);c._initProgressObject(k);c._addConvenienceMethods(a,k);return g=c._trigger("add",a,k)});return g},_replaceFileInput:function(a){var d=a.clone(!0);b("<form></form>").append(d)[0].reset();a.after(d).detach();b.cleanData(a.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(b,g){return g===
a[0]?d[0]:g});a[0]===this.element[0]&&(this.element=d)},_handleFileTreeEntry:function(a,d){var c=this,g=b.Deferred(),n=function(b){b&&!b.entry&&(b.entry=a);g.resolve([b])},h;d=d||"";a.isFile?a._file?(a._file.relativePath=d,g.resolve(a._file)):a.file(function(a){a.relativePath=d;g.resolve(a)},n):a.isDirectory?(h=a.createReader(),h.readEntries(function(b){c._handleFileTreeEntries(b,d+a.name+"/").done(function(a){g.resolve(a)}).fail(n)},n)):g.resolve([]);return g.promise()},_handleFileTreeEntries:function(a,
d){var c=this;return b.when.apply(b,b.map(a,function(a){return c._handleFileTreeEntry(a,d)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(a){a=a||{};var d=a.items;return d&&d.length&&(d[0].webkitGetAsEntry||d[0].getAsEntry)?this._handleFileTreeEntries(b.map(d,function(a){var b;if(a.webkitGetAsEntry){if(b=a.webkitGetAsEntry())b._file=a.getAsFile();return b}return a.getAsEntry()})):b.Deferred().resolve(b.makeArray(a.files)).promise()},_getSingleFileInputFiles:function(a){a=
b(a);var d=a.prop("webkitEntries")||a.prop("entries");if(d&&d.length)return this._handleFileTreeEntries(d);d=b.makeArray(a.prop("files"));if(d.length)void 0===d[0].name&&d[0].fileName&&b.each(d,function(a,b){b.name=b.fileName;b.size=b.fileSize});else{a=a.prop("value");if(!a)return b.Deferred().resolve([]).promise();d=[{name:a.replace(/^.*\\/,"")}]}return b.Deferred().resolve(d).promise()},_getFileInputFiles:function(a){return a instanceof b&&1!==a.length?b.when.apply(b,b.map(a,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],
arguments)}):this._getSingleFileInputFiles(a)},_onChange:function(a){var d=this,c={fileInput:b(a.target),form:b(a.target.form)};this._getFileInputFiles(c.fileInput).always(function(b){c.files=b;d.options.replaceFileInput&&d._replaceFileInput(c.fileInput);!1!==d._trigger("change",a,c)&&d._onAdd(a,c)})},_onPaste:function(a){var d=a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.items,c={files:[]};d&&d.length&&(b.each(d,function(a,b){var d=b.getAsFile&&b.getAsFile();d&&c.files.push(d)}),
!1!==this._trigger("paste",a,c)&&this._onAdd(a,c))},_onDrop:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var b=this,c=a.dataTransfer,g={};c&&(c.files&&c.files.length)&&(a.preventDefault(),this._getDroppedFiles(c).always(function(c){g.files=c;!1!==b._trigger("drop",a,g)&&b._onAdd(a,g)}))},_onDragOver:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var d=a.dataTransfer,c={dropEffect:"copy",preventDefault:!0};d&&(-1!==b.inArray("Files",d.types)&&!1!==
this._trigger("dragover",a,c))&&(d.dropEffect=c.dropEffect,c.preventDefault&&a.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste}));b.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,
"change")},_setOption:function(a,d){var c=-1!==b.inArray(a,this._specialOptions);c&&this._destroyEventHandlers();this._super(a,d);c&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var a=this.options;void 0===a.fileInput?a.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):a.fileInput instanceof b||(a.fileInput=b(a.fileInput));a.dropZone instanceof b||(a.dropZone=b(a.dropZone));a.pasteZone instanceof b||(a.pasteZone=
b(a.pasteZone))},_getRegExp:function(a){a=a.split("/");var b=a.pop();a.shift();return RegExp(a.join("/"),b)},_isRegExpOption:function(a,d){return"url"!==a&&"string"===b.type(d)&&/^\/.*\/[igm]{0,3}$/.test(d)},_initDataAttributes:function(){var a=this,d=this.options;b.each(b(this.element[0].cloneNode(!1)).data(),function(b,g){a._isRegExpOption(b,g)&&(g=a._getRegExp(g));d[b]=g})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);
this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(a){var d=this;a&&!this.options.disabled&&(a.fileInput&&!a.files?this._getFileInputFiles(a.fileInput).always(function(b){a.files=b;d._onAdd(null,a)}):(a.files=b.makeArray(a.files),this._onAdd(null,a)))},send:function(a){if(a&&!this.options.disabled){if(a.fileInput&&!a.files){var d=this,c=b.Deferred(),g=c.promise(),n,h;
g.abort=function(){h=!0;if(n)return n.abort();c.reject(null,"abort","abort");return g};this._getFileInputFiles(a.fileInput).always(function(b){h||(b.length?(a.files=b,n=d._onSend(null,a).then(function(a,b,d){c.resolve(a,b,d)},function(a,b,d){c.reject(a,b,d)})):c.reject())});return this._enhancePromise(g)}a.files=b.makeArray(a.files);if(a.files.length)return this._onSend(null,a)}return this._getXHRPromise(!1,a&&a.context)}})});$(document).ready(function(){$("#playerOne").jPlayer({errorAlerts:!1,warningAlerts:!1,preload:"auto",swfPath:"includes/js",ready:function(){},progress:function(a){1==primary_player&&(seekPercent=a.jPlayer.status.seekPercent,null==seekPercent&&(seekPercent=100,consoleLog("seekPercent was null, so setting it to ",seekPercent)),100>seekPercent||!load_progress_complete)&&(consoleLog("Inside progress event handler",a),consoleLog("Updating load progress display to ",seekPercent),updateLoadProgressDisplay(seekPercent),
100==seekPercent&&(load_progress_complete=!0,updateLoadProgressDisplay(100)))},stalled:function(a){playing&&1==primary_player&&$.mobile.showPageLoadingMsg(theme.bars,"Stalled")},waiting:function(a){1==primary_player&&(consoleLog("Inside waiting event handler",a),$.mobile.showPageLoadingMsg(theme.bars,"Waiting"))},abort:function(a){1==primary_player&&$.mobile.showPageLoadingMsg(theme.bars,"Aborting")},error:function(a){consoleLog("Inside error event handler for playerOne",a.jPlayer.error)},warning:function(a){consoleLog("Inside warning event handler for playerOne",
a.jPlayer.warning)},loadstart:function(a){playing&&(1==primary_player&&""!=a.jPlayer.status.src)&&(consoleLog("current track position",current_track_position),0<current_track_position&&(a.jPlayer.status.src==playlist.tracks[track_position].oggurl||a.jPlayer.status.src==playlist.tracks[track_position].url)&&!shuffle_queue?$.mobile.showPageLoadingMsg(theme.bars,"Resuming"):$.mobile.showPageLoadingMsg(theme.bars,"Loading"))},loadedmetadata:function(a){1==primary_player&&(consoleLog("Inside loadedmetadata event handler",
a),$.mobile.showPageLoadingMsg(theme.bars,"Metadata loaded"))},durationchange:function(a){consoleLog("Inside durationchange event handler for playerOne",a)},playing:function(a){1==primary_player&&(consoleLog("Inside playing event handler",a),$.mobile.showPageLoadingMsg(theme.bars,"Playing"))},timeupdate:function(a){1==primary_player&&(currentTime=a.jPlayer.status.currentTime,totalDuration=a.jPlayer.status.duration,playProgress=a.jPlayer.status.currentPercentAbsolute,0==playProgress&&(playProgress=
a.jPlayer.status.currentPercentRelative),processTimeUpdate(currentTime,totalDuration,playProgress))},ended:function(a){next_track_already_added?(consoleLog("Updating the currently playing track info",playlist.tracks[track_position]),updateCurrentTrackInfo(playlist.tracks[track_position]),next_track_already_added=!1,out_volume_left_to_fade=volume_fade-1,in_volume_left_to_fade=volume_fade-1,crossfade_is_in_progress=!1,primary_player=1==primary_player?2:1,consoleLog("Primary player set to "+primary_player),
tmpPlayerSelector=activePlayerSelector,activePlayerSelector=inactivePlayerSelector,inactivePlayerSelector=tmpPlayerSelector,consoleLog("Active player selector is now: "+activePlayerSelector),consoleLog("Inactive player selector is now: "+inactivePlayerSelector),$(inactivePlayerSelector).jPlayer("volume",1),load_progress_complete=!1):repeat_track?skipto("same"):skipto("next")},volumechange:function(a){consoleLog("Player volume set to "+a.jPlayer.options.volume)}});$("#playerTwo").jPlayer({errorAlerts:!1,
warningAlerts:!1,preload:"auto",swfPath:"includes/js",cssSelectorAncestor:"#jukebox",ready:function(){},progress:function(a){2==primary_player&&(seekPercent=a.jPlayer.status.seekPercent,null==seekPercent&&(seekPercent=100,consoleLog("seekPercent was null, so setting it to ",seekPercent)),100>seekPercent||!load_progress_complete)&&(consoleLog("Inside progress event handler",a),consoleLog("Updating load progress display to ",seekPercent),updateLoadProgressDisplay(seekPercent),100==seekPercent&&(load_progress_complete=
!0,updateLoadProgressDisplay(100)))},stalled:function(a){playing&&2==primary_player&&$.mobile.showPageLoadingMsg(theme.bars,"Stalled")},waiting:function(a){2==primary_player&&(consoleLog("Inside waiting event handler",a),$.mobile.showPageLoadingMsg(theme.bars,"Waiting"))},abort:function(a){2==primary_player&&$.mobile.showPageLoadingMsg(theme.bars,"Aborting")},error:function(a){consoleLog("Inside error event handler for playerTwo",a.jPlayer.error)},warning:function(a){consoleLog("Inside warning event handler for playerTwo",
a.jPlayer.warning)},loadstart:function(a){playing&&(2==primary_player&&""!=a.jPlayer.status.src)&&(consoleLog("current track position",current_track_position),0<current_track_position&&(a.jPlayer.status.src==playlist.tracks[track_position].oggurl||a.jPlayer.status.src==playlist.tracks[track_position].url)&&!shuffle_queue?$.mobile.showPageLoadingMsg(theme.bars,"Resuming"):$.mobile.showPageLoadingMsg(theme.bars,"Loading"))},loadedmetadata:function(a){2==primary_player&&(consoleLog("Inside loadedmetadata event handler",
a),$.mobile.showPageLoadingMsg(theme.bars,"Metadata loaded"))},durationchange:function(a){consoleLog("Inside durationchange event handler for playerTwo",a)},playing:function(a){2==primary_player&&(consoleLog("Inside playing event handler",a),$.mobile.showPageLoadingMsg(theme.bars,"Playing"))},timeupdate:function(a){2==primary_player&&(currentTime=a.jPlayer.status.currentTime,totalDuration=a.jPlayer.status.duration,playProgress=a.jPlayer.status.currentPercentAbsolute,0==playProgress&&(playProgress=
a.jPlayer.status.currentPercentRelative),processTimeUpdate(currentTime,totalDuration,playProgress))},ended:function(a){next_track_already_added?(consoleLog("Updating the currently playing track info",playlist.tracks[track_position]),updateCurrentTrackInfo(playlist.tracks[track_position]),next_track_already_added=!1,out_volume_left_to_fade=volume_fade-1,in_volume_left_to_fade=volume_fade-1,crossfade_is_in_progress=!1,primary_player=1==primary_player?2:1,consoleLog("Primary player set to "+primary_player),
tmpPlayerSelector=activePlayerSelector,activePlayerSelector=inactivePlayerSelector,inactivePlayerSelector=tmpPlayerSelector,consoleLog("Active player selector is now: "+activePlayerSelector),consoleLog("Inactive player selector is now: "+inactivePlayerSelector),$(inactivePlayerSelector).jPlayer("volume",1),load_progress_complete=!1):repeat_track?skipto("same"):skipto("next")},volumechange:function(a){consoleLog("Player volume set to "+a.jPlayer.options.volume)}});if("undefined"!==typeof playlist&&
"undefined"!==typeof playlist.tracks){$("#artistDiv").html(playlist.tracks[track_position].artist);var b=playlist.tracks[track_position].album,b=b.length>max_album_name_string_length?b.substring(0,max_album_name_string_length)+"...":b;$("#albumDiv").html(b).trigger("updatelayout");0===playlist.tracks[track_position].url.indexOf("http://")?$("#trackDiv").html(playlist.tracks[track_position].url).trigger("updatelayout"):(b=playlist.tracks[track_position].title,b=b.length>max_track_title_string_length?
b.substring(0,max_track_title_string_length)+"...":b,$("#trackDiv").html(b).trigger("updatelayout"))}});function control_mpd(b,a){var d="/musicpd/index",c=!1,g=!1,n=!1,h="Loading",f=0;switch(b){case "play":d="/musicpd/control/play";break;case "pause":d="/musicpd/control/pause";break;case "stop":d="/musicpd/control/stop";break;case "next":d="/musicpd/control/next";break;case "prev":d="/musicpd/control/previous";break;case "set_crossfade":d="/musicpd/control/crossfade";break;case "shuffle":d="/musicpd/control/shuffle";break;case "repeat":d="/musicpd/control/repeat";break;case "set_volume":d="/musicpd/control/volume";
break;case "mute":d="/musicpd/control/mute";break;case "start_over":d="/musicpd/control/reset";break;case "save_playlist":g=!0;h="Saving playlist";d="/musicpd/playlist/save";c=!0;break;case "delete_playlist":g=!0;h="Deleting playlist";d="/musicpd/playlist/delete";c=!0;break;case "track_add":d="/musicpd/playlist/add/track";break;case "move_track":d="/musicpd/playlist/move/track";break;case "track_move":d="/musicpd/playlist/move/track";break;case "track_remove":d="/musicpd/playlist/remove/track";break;
case "remove":f=3E3;g=!0;h="Removing track";d="/musicpd/playlist/remove/track";break;case "clear":f=3E3;g=!0;h="Clearing playlist";d="/musicpd/playlist/clear";break;case "add":f=1E3;g=!0;n=!1;h="Adding track";d="/musicpd/playlist/add/track";break;case "add_url":d="/musicpd/playlist/add/url";break;case "add_all":f=3E3;g=!0;h="Adding tracks";d="/musicpd/playlist/add/tracks";c=!0;break;case "add_albums":f=3E3;g=!0;h="Adding albums";d="/musicpd/playlist/add/albums";c=!0;break;case "skip_to":d="/musicpd/control/skip";
break;case "update":f=3E3;g=!0;h="Refreshing MPD";d="/musicpd/control/refresh";break;default:d="/musicpd/index"}post_data="";if("undefined"!==typeof a){for(parameter in a)post_data+=parameter+"="+encodeURIComponent(a[parameter])+"&";post_data=post_data.substring(0,post_data.length-1)}g&&(0==f&&($.mobile.loadingMessage=h),$.mobile.showPageLoadingMsg("a",h,n));$.ajax({type:"POST",url:d,async:!0,dataType:"json",data:post_data,success:function(a){g&&(""!=a.message?($.mobile.hidePageLoadingMsg(),$.mobile.loadingMessage=
a.message,$.mobile.showPageLoadingMsg(a.success?theme.body:"r",a.message,n),f=3E3,c=!1,setTimeout(function(){$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading"},f)):0==f?($.mobile.hidePageLoadingMsg(),$.mobile.loadingMessage="Loading"):setTimeout(function(){$.mobile.hidePageLoadingMsg()},f));c&&setTimeout(function(){$("#header-back-link").trigger("click")},f);if(a.success)switch(a.action){case "clear":clearQueue();break;case "remove":removeQueuedTrack(a.id,a.index)}}})};function get_timer_display(b){minutes="-";seconds="--";0<b&&(minutes=Math.floor(b/60),seconds=Math.floor(b%60),10>seconds&&(seconds="0"+seconds));time_display=minutes+":"+seconds;if("0:01"==time_display||"0:00"==time_display)time_display="-:--";"Infinity:NaN"==time_display&&(time_display="<font style='font-size:12px;'>\u221e</font>",b="#FFFFFF",b=0==(new Date).getSeconds()%2?"#FFFFFF":"#000000",$("#streamProgressDiv").css("background-color",b));return time_display}
function initialize_timer_display(){$("#trackPlayDuration").html("-:--");$("#playProgressDiv").css("width",0);$("#playProgressDiv").css("background-color","#FFFFFF");$("#loadProgressDiv").css("width","100%");$("#loadProgressDiv").css("background","rgba(0, 0, 0, .4)");$("#loadProgressDiv").css("border","1px inset #888888");$("#trackTotalDuration").html("-:--")}
function fade_out_current_track(){try{0<out_volume_left_to_fade&&(out_faded_volume=out_volume_left_to_fade/volume_fade,consoleLog("Setting "+activePlayerSelector+" volume to: "+out_faded_volume),$(activePlayerSelector).jPlayer("volume",out_faded_volume),out_volume_left_to_fade--)}catch(b){}}
function fade_in_next_track(){try{0<volume_fade-in_volume_left_to_fade&&0<=in_volume_left_to_fade&&(in_faded_volume=(volume_fade-in_volume_left_to_fade)/volume_fade,consoleLog("Setting "+activePlayerSelector+" volume to: "+out_faded_volume),$(activePlayerSelector).jPlayer("volume",out_faded_volume),in_volume_left_to_fade--)}catch(b){}}
function play_station_stream(b){$.ajax({type:"POST",url:"/stations/get_station_details",async:!0,data:"station_id="+b,success:function(a){result=$.parseJSON(a);station=result.station[0];"undefined"!==typeof station&&($("#jukebox .albumart").attr("src",station.icon_url+station.icon),$("#artistDiv").html(station.name),$("#albumDiv").html(station.description),$("#trackDiv").html(station.url).trigger("updatelayout"),$(inactivePlayerSelector).jPlayer("setMedia",{mp3:station.url}),$(inactivePlayerSelector).jPlayer("play"),
consoleLog("Checking to see if srcSet is true or false",$(activePlayerSelector).data("jPlayer").status),$(activePlayerSelector).data("jPlayer").status.srcSet&&$(activePlayerSelector).jPlayer("stop"),tmpPlayerSelector=activePlayerSelector,activePlayerSelector=inactivePlayerSelector,inactivePlayerSelector=tmpPlayerSelector,primary_player=1==primary_player?2:1,updatePlayerDisplay(playing),$("#streamProgressDiv").css("width","100%"),$("#streamProgressDiv").css("background","rgba(0, 0, 0, .4)"),playing=
!0,post={parameters:[{station_url:station.url}]},control_mpd("add_url",post.parameters[0]))}})}function updatePlayProgressDisplay(b,a,d){$("#trackTotalDuration").html(get_timer_display(a));$("#playProgressDiv").css("width",d+"%");$("#trackPlayDuration").html(get_timer_display(b))}function updateLoadProgressDisplay(b){consoleLog("Inside updateLoadProgressDisplay - setting loadProgressDiv to ",b);$("#loadProgressDiv").css("width",b+"%")}
function getNextTrackPosition(b,a,d){consoleLog("Inside getNextTrackPosition - destination ",b);consoleLog("Inside getNextTrackPosition - currentTrackPosition ","'"+a+"'");consoleLog("Inside getNextTrackPosition - currentPlaylistLength ",d);consoleLog("Inside getNextTrackPosition - currentPlaylistLength minus 1 ",d-1);var c=a;switch(b){case "next":a==d-1?c=0:c++;break;case "previous":0==a?c=d-1:c--;break;case "beginning":c=0;break;case "same":break;default:Math.floor(b)==b&&$.isNumeric(b)&&(c=b)}return c}
function processTimeUpdate(b,a,d){1<b&&($.mobile.hidePageLoadingMsg(),$.mobile.loadingMessage="Loading");updatePlayProgressDisplay(b,a,d);0<a&&0<b&&(a-b<=max_crossfade&&0<a&&0<b&&!next_track_already_added?(next_track_already_added=!0,fade_out_current_track(),track_position=getNextTrackPosition("next",track_position,playlist.tracks.length),current_track_position=0,$(inactivePlayerSelector).jPlayer("setMedia",{mp3:playlist.tracks[track_position].url}),$(inactivePlayerSelector).jPlayer("play",current_track_position),
fade_in_next_track()):a-b<=max_crossfade&&(fade_out_current_track(),fade_in_next_track()))}
function updatePlayerDisplay(b,a){b&&"pause"==(a||"play")?($("#jukebox #playpause").attr("data-icon","play"),$("#jukebox #playpause").buttonMarkup("refresh"),$("#playpause-span-one").attr("class","play ui-btn-inner ui-btn-corner-all"),$("#playpause-span-two").attr("class","play ui-btn-text"),$("#playpause-span-three").attr("class","play-inner ui-icon ui-icon-play ui-icon-shadow"),$("#playerCurrentlyPlayingDiv").slideUp({duration:default_easout_duration,easing:default_easout_equation,complete:function(){$("#trackProgressDiv").slideUp({duration:default_easout_duration,
easing:default_easout_equation,complete:function(){}})}})):"none"==$("#playerCurrentlyPlayingDiv").css("display")?($("#jukebox #playpause").attr("data-icon","pause"),$("#jukebox #playpause").buttonMarkup("refresh"),$("#playpause-span-one").attr("class","pause ui-btn-inner ui-btn-corner-all"),$("#playpause-span-two").attr("class","pause ui-btn-text"),$("#playpause-span-three").attr("class","pause-inner ui-icon ui-icon-pause ui-icon-shadow"),$("#playerCurrentlyPlayingDiv").slideDown({duration:default_easin_duration,
easing:default_easin_equation,complete:function(){$("#trackProgressDiv").slideDown({duration:default_easin_duration,easing:default_easin_equation,complete:function(){}})}})):($("#jukebox #playpause").attr("data-icon","pause"),$("#jukebox #playpause").buttonMarkup("refresh"),$("#playpause-span-one").attr("class","pause ui-btn-inner ui-btn-corner-all"),$("#playpause-span-two").attr("class","pause ui-btn-text"),$("#playpause-span-three").attr("class","pause-inner ui-icon ui-icon-pause ui-icon-shadow"))}
function skipto(b){$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading";initialize_timer_display();if("undefined"===typeof playlist.tracks)return!1;load_progress_complete=!1;next_track_already_added&&($(inactivePlayerSelector).data("jPlayer").status.srcSet&&$(inactivePlayerSelector).jPlayer("stop"),$(inactivePlayerSelector).jPlayer("volume",1),$(activePlayerSelector).jPlayer("volume",1));track_position=getNextTrackPosition(b,track_position,playlist.tracks.length);updateCurrentTrackInfo(playlist.tracks[track_position]);
updatePlayerDisplay(playing);$(inactivePlayerSelector).jPlayer("setMedia",{mp3:playlist.tracks[track_position].url});$(inactivePlayerSelector).jPlayer("play");consoleLog("Checking to see if srcSet is true or false",$(activePlayerSelector).data("jPlayer").status);$(activePlayerSelector).data("jPlayer").status.srcSet&&$(activePlayerSelector).jPlayer("stop");tmpPlayerSelector=activePlayerSelector;activePlayerSelector=inactivePlayerSelector;inactivePlayerSelector=tmpPlayerSelector;primary_player=1==primary_player?
2:1;shuffle_queue?(post={parameters:[{index:playlist.tracks[track_position].mpd_index}]},control_mpd("skip_to",post.parameters[0])):"next"==b?control_mpd("next"):"previous"==b?control_mpd("prev"):"beginning"!=b&&(Math.floor(b)==b&&$.isNumeric(b))&&(document.getElementById("currentalbumart"),b=document.getElementById("currentlyPlayingInfoDiv"),document.getElementById("playerCurrentlyPlayingDiv"),"undefined"!==typeof b&&(""!=b&&null!=b)&&($(".currentalbumart").attr("src",playlist.tracks[track_position].art),
$("#currentlyPlayingArtistDiv").html(playlist.tracks[track_position].artist),$("#currentlyPlayingAlbumDiv").html(playlist.tracks[track_position].album),$("#currentlyPlayingTrackDiv").html(playlist.tracks[track_position].title).trigger("updatelayout"),$("#currentlyPlayingInfoDiv").slideDown({duration:default_easin_duration,easing:default_easin_equation,complete:function(){}})),bumped_file=playlist.tracks[track_position].file,0==bumped_file.indexOf("http://")?$("#streamProgressDiv").css("width","100%"):
$("#streamProgressDiv").css("width","0px"),$("#streamProgressDiv").css("background-color","#000000"),$("#currentlyPlayingArtistDiv").css("max-width",0.6*$(window).width()),$("#currentlyPlayingAlbumDiv").css("max-width",0.6*$(window).width()),$("#currentlyPlayingTrackDiv").css("max-width",0.6*$(window).width()),post={parameters:[{index:track_position}]},control_mpd("skip_to",post.parameters[0]));playing||(playing=!0)}
function updateCurrentTrackInfo(b){consoleLog("Trying to set the info about the song being played using the track object",b);$("#currentAlbumArtImg").attr("src",b.art);$("#artistDiv").html(b.artist);var a=b.album,a=a.length>max_album_name_string_length?a.substring(0,max_album_name_string_length)+"...":a;$("#albumDiv").html(a).trigger("updatelayout");0===b.url.indexOf("http://")?$("#trackDiv").html(b.url).trigger("updatelayout"):(a=b.title,a=a.length>max_track_title_string_length?a.substring(0,max_track_title_string_length)+
"...":a,$("#trackDiv").html(a).trigger("updatelayout"));$("#playerCurrentlyPlayingDiv").css("max-width",0.9*$(window).width());0==b.file.indexOf("http://")&&($("#streamProgressDiv").css("width","100%"),$("#streamProgressDiv").css("background","rgba(0, 0, 0, .4)"))}
function crossfadePlayers(b){b/=90;$("#"+priPlayerID).jPlayer("volume",0);$.timer(b,function(a){var b=$("#"+secPlayerID).jPlayer("getData","volume")-1;$("#"+secPlayerID).jPlayer("volume",b);1>b&&($("#"+secPlayerID).jPlayer("stop"),a.stop())});$("#"+secPlayerID+"_elements").hide();$.timer(b/2,function(a){var b=$("#"+priPlayerID).jPlayer("getData","volume")+2;$("#"+priPlayerID).jPlayer("volume",b);90<b&&a.stop()});$("#"+priPlayerID+"_elements").show()}
function consoleLog(b,a){a=a||"";"console"in window&&("log"in window.console&&debug)&&(console.log(b),""!=a&&console.log(a))};function get_mpd_playlist(b){var a;$.ajax({type:"POST",url:"/musicpd/query",async:!1,data:"query=playlist",success:function(d){a=d;b&&(a=shuffle_playlist(a))}});return a}
function shuffle_playlist(b){b=$.parseJSON(b);shuffled_playlist='{ "tracks" : [';count_of_tracks=number_of_tracks=b.tracks.length;for(i=0;i<number_of_tracks;i++){var a=Math.floor(Math.random()*count_of_tracks);shuffled_playlist=1==count_of_tracks?shuffled_playlist+JSON.stringify(b.tracks[a]):shuffled_playlist+(JSON.stringify(b.tracks[a])+", ");count_of_tracks--}return shuffled_playlist+="]}"}function unshuffle_playlist(){return unshuffled_playlist=$.parseJSON(get_mpd_playlist())};function clearQueue(){$.mobile.showPageLoadingMsg();track_position=0;playlist="";$("#jukebox #playpause").attr("data-icon","play");$("#jukebox #playpause").buttonMarkup("refresh");$("#playpause-span-one").attr("class","play ui-btn-inner ui-btn-corner-all");$("#playpause-span-two").attr("class","play ui-btn-text");$("#playpause-span-three").attr("class","play-inner ui-icon ui-icon-play ui-icon-shadow");shuffle_queue=!1;$("#shuffle").attr("data-theme",theme.buttons);$("#shuffle").attr("data-icon","shuffle");
$("#shuffle").removeClass($.mobile.activeBtnClass);1==primary_player?("console"in window&&"log"in window.console&&(console.log("Checking to see if playerOne's srcSet is true or false"),console.log($("#playerOne").data("jPlayer").status)),$("#playerOne").data("jPlayer").status.srcSet&&($("#playerOne").jPlayer("pause"),$("#playerOne").jPlayer("clearMedia"))):("console"in window&&"log"in window.console&&(console.log("Checking to see if playerTwo's srcSet is true or false"),console.log($("#playerTwo").data("jPlayer").status)),
$("#playerTwo").data("jPlayer").status.srcSet&&($("#playerTwo").jPlayer("pause"),$("#playerTwo").jPlayer("clearMedia")));current_track_position=0;playing=!1;paused=!0;setTimeout(function(){$("#trackProgressDiv").slideUp("slow");$("#playerCurrentlyPlayingDiv").slideUp("slow",function(){$.mobile.hidePageLoadingMsg()});initialize_timer_display()},1E3)}function removeQueuedTrack(b,a){$("#"+b).slideUp("slow",function(){delete playlist.tracks[a];$("#"+b).remove()})};$("body").on("pagebeforeshow","#setup",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a")});$("body").on("pagebeforeshow","#edit_site_config",function(b,a){"undefined"!=typeof theme?$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body):$("body").attr("class","ui-mobile-viewport ui-overlay-a");$("div.required-field-error").prev().css("border","2px solid #CC0000")});
$("body").on("pagebeforeshow","#error",function(b,a){"undefined"!=typeof theme?$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body):$("body").attr("class","ui-mobile-viewport ui-overlay-a")});$("body").on("pagebeforeshow","#setup_success",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a")});
$("body").on("pagebeforeshow","#login",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a");$("#login_form a.ui-btn").removeClass("ui-btn-hover-g");$("div.required-field-error").prev().css("border","2px solid #CC0000")});$("body").on("pageinit","#register_form",function(b,a){Recaptcha.destroy();Recaptcha.create(recaptcha_public_key,recaptcha_widget_name,recaptcha_options);set_recaptcha_padding_and_width()});
$("body").on("pagebeforeshow","#register_form",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a");$("div.required-field-error").prev().css("border","2px solid #CC0000")});$("body").on("pagehide","#register_form",function(b,a){});$("body").on("pageshow","#register_form",function(b,a){Recaptcha.destroy();Recaptcha.create(recaptcha_public_key,recaptcha_widget_name,recaptcha_options);set_recaptcha_padding_and_width();$("div.required-field-error").prev().css("border","2px solid #CC0000")});
$("body").on("pagebeforeshow","#paypal",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a")});$("body").on("pagebeforeshow","#paypal_payment_cancelled",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a")});$("body").on("click","#login_form a.ui-btn",function(b){$(this).addClass("ui-btn-hover-g")});$("body").on("click","#register_form a.ui-btn",function(b){$(this).addClass("ui-btn-hover-g")});$("body").on("click","#login_submit",function(b){$("#login_submit").parent().addClass("ui-btn-hover-g")});
$("body").on("click","#register_submit",function(b){$("#register_submit").parent().addClass("ui-btn-hover-g")});$("body").on("click","#paypal_submit",function(b){$("#paypal_submit").parent().addClass("ui-btn-hover-g")});$("body").on("click","#refresh_captcha",function(b){b.preventDefault();$("#refresh_captcha").parent().addClass("ui-btn-hover-g");refresh_recaptcha()});
$("body").on("click","#switch_type_audio",function(b){b.preventDefault();$("#switch_type_audio").parent().addClass("ui-btn-hover-g");setTimeout(function(){$("#switch_type_audio").parent().removeClass("ui-btn-hover-g")},500);Recaptcha.switch_type("audio")});$("body").on("click","#switch_type_image",function(b){b.preventDefault();$("#switch_type_image").parent().addClass("ui-btn-hover-g");setTimeout(function(){$("#switch_type_image").parent().removeClass("ui-btn-hover-g")},500);Recaptcha.switch_type("image")});
$("body").on("orientationchange","#register_form",function(b,a){set_recaptcha_padding_and_width()});function set_recaptcha_padding_and_width(){var b=$('div[role="dialog"]').width(),b=Math.floor(0.98*b);280<b&&(b=Math.floor((b-280)/2),$("#recaptcha_image").css("padding-left",b+"px"),$("#recaptcha_image img").css("cursor","pointer"),$("#recaptcha_image img").css("width","280px !important"),$("#recaptcha_image img:hover").css("width","280px !important"))}
function refresh_recaptcha(){$("#recaptcha_image").fadeOut(100,function(){$("#recaptcha_image").parent().append("<img style='padding-top:15px;' src='images/ajax-loader-fast.gif' />");Recaptcha.reload();set_recaptcha_padding_and_width()});setTimeout(function(){$("img:last").remove();$("#recaptcha_image").fadeIn(500);$("#register_form div.ui-btn").removeClass("ui-btn-hover-g")},2E3)}
function change_page(b,a,d,c,g,n,h,f,e){$.mobile.changePage(b||"home",{transition:a||"fade",reloadPage:d||!1,showLoadMsg:c||!1,changeHash:g||!1,type:n||"get",data:h||"",reverse:f||!1,allowSamePageTransition:e||!1})}function incremental_scroll_up(){var b=$("html,body").height();current_scroll_position=$(window).scrollTop();b=current_scroll_position-b;0>b&&(b=0);$("html,body").animate({scrollTop:b},1E3,function(){})}
function incremental_scroll_down(b){b=$("html,body").height();current_scroll_position=$(window).scrollTop();var a=0;0<current_scroll_position&&(a=current_scroll_position);a+=b;$("html,body").animate({scrollTop:a},1E3,function(){});$("#index").lazyloader("loadMore")}function attach_window_scroll_event(b){$(window).scroll(function(){window_scroll_event_just_fired||mousewheel_event_just_fired||(window_scroll_event_just_fired=!0);setTimeout(function(){window_scroll_event_just_fired=!1},1E3)})};(function(){function b(b,c){return b.section(c.get("json"),c,{block:a},null)}function a(a,b){return a.write("<li class='ui-li-has-thumb'><a href='").reference(b.get("href"),b,"h").write("' class='ui-link-inherit' data-transition='").reference(b.get("transition"),b,"h").write("'><img src='").reference(b.get("art"),b,"h").write("' class='ui-li-thumb album-art-img' /><h3 class='ui-li-heading album-name-heading'>").reference(b.get("name"),b,"h").write("</h3><span class='ui-li-count ui-btn-up-").reference(b.get("theme_buttons"),
b,"h").write(" ui-btn-corner-all'>").reference(b.get("count_bubble_value"),b,"h").write("</span><p class='ui-li-aside ui-li-desc'>").reference(b.get("total_length"),b,"h").write("</p></a></li>")}dust.register("albums",b);return b})();(function(){function b(b,c){return b.section(c.get("json"),c,{block:a},null)}function a(a,b){return a.write("<li><a href='").reference(b.get("href"),b,"h").write("' data-transition='").reference(b.get("transition"),b,"h").write("'>").reference(b.get("name"),b,"h").write("<span class='ui-li-count ui-btn-up-").reference(b.get("theme_buttons"),b,"h").write(" ui-btn-corner-all'>").reference(b.get("count_bubble_value"),b,"h").write("</span></a></li>")}dust.register("artists",b);return b})();(function(){function b(b,c){return b.section(c.get("json"),c,{block:a},null)}function a(a,b){return a.write("<li id='").reference(b.get("id"),b,"h").write("' style='position:relative;' class='ui-li-has-thumb' data-queue-track-index='").reference(b.get("playlist_index"),b,"h").write("' data-queue-track-title='").reference(b.get("title"),b,"h").write("' data-queue-track-file='").reference(b.get("file"),b,"h").write("' data-queue-track-link='").reference(b.get("symbolic_link_filename"),b,"h").write("' class='ui-li-has-thumb ui-btn ui-btn-icon-right'><a href='#queueTrackPopupMenu' data-rel=\"popup\" data-icon=\"none\" class=\"ui-link-inherit\"><img src='").reference(b.get("art"),
b,"h").write("' class='ui-li-thumb track-item-image' /><h3 class='track-title-heading ui-li-heading'>").reference(b.get("title"),b,"h").write("</h3><p class='ui-li-aside ui-li-desc'>").reference(b.get("time"),b,"h").write("</p></a><a href='' data-icon='move' class='").reference(b.get("theme_icon_class"),b,"h").write(" ui-li-link-alt ui-btn ui-btn-up-").reference(b.get("theme_buttons"),b,"h").write(" move' data-theme='").reference(b.get("theme_buttons"),b,"h").write("' title='").reference(b.get("move_tooltip"),
b,"h").write("'>").reference(b.get("move_tooltip"),b,"h").write("</a></li>")}dust.register("queue",b);return b})();(function(){function b(b,c){return b.section(c.get("json"),c,{block:a},null)}function a(a,b){return a.write("<li class='ui-li-has-thumb' data-icon='plus'><a href='' onclick='post = { \"parameters\" : [ { \"file\" : \"").reference(b.get("file"),b,"h").write("\" } ] }; control_mpd( \"add\", post.parameters[0] );' class='ui-link-inherit' title='").reference(b.get("title"),b,"h").write("'><img src='").reference(b.get("art"),b,"h").write("' class='ui-li-thumb track-item-image' /><h3 class='track-title-heading ui-li-heading'>").reference(b.get("name"),
b,"h").write("</h3><p class='ui-li-aside ui-li-desc'>").reference(b.get("length"),b,"h").write("</p></a></li>")}dust.register("tracks",b);return b})();(function(){function b(b,c){return b.section(c.get("json"),c,{block:a},null)}function a(a,b){return a.write("<li id='").reference(b.get("id"),b,"h").write("' style='position:relative;' data-theme='").reference(b.get("theme_buttons"),b,"h").write("' data-playlist-track-index='").reference(b.get("index"),b,"h").write("' data-playlist-track-file='").reference(b.get("file"),b,"h").write("' class='ui-li-has-thumb ui-btn ui-btn-icon-right'><a href='").reference(b.get("href"),b,"h").write("' data-rel='popup'><img src='").reference(b.get("art"),
b,"h").write("' class='ui-li-thumb track-item-image' /><h3 class='track-title-heading ui-li-heading'>").reference(b.get("name"),b,"h").write("</h3><p class='ui-li-aside ui-li-desc'>").reference(b.get("length"),b,"h").write("</p></a><a href='' data-icon='move' class='").reference(b.get("theme_icon_class"),b,"h").write(" ui-li-link-alt ui-btn ui-btn-up-").reference(b.get("theme_buttons"),b,"h").write(" move' data-theme='").reference(b.get("theme_buttons"),b,"h").write("' title='").reference(b.get("title"),
b,"h").write("'>").reference(b.get("title"),b,"h").write("</a></li>")}dust.register("playlistTracks",b);return b})();$("body").on("lazyloadercreate","#index",function(b){});$("body").on("lazyloaderbeforecreate","#index",function(b){});$("body").on("lazyloaderdestroy","#index",function(b){});$("body").on("lazyloaderdoneloading","#index",function(b){$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading"});$("body").on("lazyloaderalldone","#index",function(b){$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading"});
$("body").on("lazyloaderbusy","#index",function(b){$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading"});$("body").on("lazyloadererror","#index",function(b){});$("body").on("lazyloaderreset","#index",function(b){});$("body").on("lazyloaderresetall","#index",function(b){});
$("body").on("pageinit","#index",function(b,a){$("#index").lazyloader();$("#index").lazyloader("reInitialize",{},{clearUrl:"/session/clear"},{});$.mobile.lazyloader.prototype.timeoutOptions.mousewheel=300;$.mobile.lazyloader.prototype.timeoutOptions.scrollstart=700;$.mobile.lazyloader.prototype.timeoutOptions.scrollstop=100;$.mobile.lazyloader.prototype.timeoutOptions.showprogress=100;$("body").enableSelection()});$("body").on("pageinit","#genres",function(b,a){});
$("body").on("pageinit","#queue",function(b,a){threshold=$(window).height();var d={threshold:threshold,retrieve:20,retrieved:20,bubbles:!0,offset:playlist_index_offset},c={retrieve:d.retrieve,retrieved:d.retrieved,offset:d.offset};$("#index").lazyloader("reInitialize",d,{pageId:"queue",templateType:"dust",templateId:"queue",templatePrecompiled:!0,mainId:"queueTracksList",progressDivId:"lazyloaderProgressDiv",moreUrl:"/queue/more",clearUrl:"/session/clear",JSONP:!1,JSONPCallback:"callback"},c);$("#queueTracksList").sortable({disabled:!1,
axis:"y",containment:"parent",distance:1,opacity:0.7,scroll:!0,scrollSensitivity:160,scrollSpeed:30,revert:!0,placeholder:"ui-state-highlight-sortable",items:"li",handle:"a.move .ui-btn-inner",delay:800});$("body").disableSelection()});
$("body").on("pageinit","#artists",function(b,a){$("#index").lazyloader("reset","albums");threshold=$(window).height();var d={threshold:threshold,retrieve:20,retrieved:20,bubbles:!0,offset:0},c={retrieve:d.retrieve,retrieved:d.retrieved,offset:d.offset};$("#index").lazyloader("reInitialize",d,{pageId:"artists",templateType:"dust",templateId:"artists",templatePrecompiled:!0,mainId:"artistsList",progressDivId:"lazyloaderProgressDiv",moreUrl:"/artists/more",clearUrl:"/session/clear"},c)});
$("body").on("pageinit","#save_playlist",function(b,a){$("body").enableSelection();$("#index").lazyloader("reset","queue")});
$("body").on("pageinit","#albums",function(b,a){threshold=$(window).height();var d={threshold:threshold,retrieve:20,retrieved:20,bubbles:!0},c={retrieve:d.retrieve,retrieved:d.retrieved,offset:d.offset};$("#index").lazyloader("reInitialize",d,{pageId:"albums",templateType:"dust",templateId:"albums",templatePrecompiled:!0,mainId:"albumsList",progressDivId:"lazyloaderProgressDiv",moreUrl:"/albums/more",clearUrl:"/session/clear"},c)});
$("body").on("pageinit","#playlists",function(b,a){$("#index").lazyloader("reset","playlistTracksPage");$("body").enableSelection()});
$("body").on("pageinit","#playlistTracksPage",function(b,a){threshold=$(window).height();var d={threshold:threshold,retrieve:50,retrieved:50,bubbles:!0,offset:0},c={retrieve:d.retrieve,retrieved:d.retrieved,offset:d.offset};$("#index").lazyloader("reInitialize",d,{pageId:"playlistTracksPage",templateType:"dust",templateId:"playlistTracks",templatePrecompiled:!0,mainId:"playlistTracks",progressDivId:"lazyloaderProgressDiv",moreUrl:"/playlist/tracks/more",clearUrl:"/session/clear"},c);$("#playlistTracks").sortable({disabled:!1,
axis:"y",containment:"parent",distance:1,opacity:0.7,scroll:!0,scrollSensitivity:160,scrollSpeed:30,revert:!0,placeholder:"ui-state-highlight-sortable",items:"li",handle:"a.move .ui-btn-inner",delay:800});$("body").disableSelection()});$("body").on("pageinit","#settings",function(b,a){$("#settings").on("change","#theme_id",function(a,b){"0"==$("#theme_id :selected").val()&&$.mobile.changePage("/settings/custom/theme",{allowSamePageTransition:!0,transition:"slideup",reloadPage:!1,showLoadMsg:!0,changeHash:!1})})});
$("body").on("pagebeforeshow","#music_uploader",function(b,a){$("div.plupload_header").addClass("ui-bar-"+theme.bars).attr("role","banner")});
$("body").on("pageinit","#music_uploader",function(b,a){$(function(){$("#uploader").pluploadQueue({runtimes:"html5",url:"/upload/music",max_file_size:"128mb",unique_names:!0,multiple_queues:!0,resize:{width:320,height:240,quality:90},filters:[{title:"MP3 files",extensions:"mp3"},{title:"OGG files",extensions:"ogg"}],init:{Refresh:function(a){},StateChanged:function(a){a.state==plupload.STOPPED&&control_mpd("update")},QueueChanged:function(a){},UploadProgress:function(a,b){},FilesAdded:function(a,
b){},FilesRemoved:function(a,b){},FileUploaded:function(a,b,g){},ChunkUploaded:function(a,b,g){},Error:function(a,b){}}});$("form").submit(function(a){var b=$("#uploader").pluploadQueue();0<b.files.length?(b.bind("StateChanged",function(){b.files.length===b.total.uploaded+b.total.failed&&$("form")[0].submit()}),b.start()):alert("You must queue at least one file.");return!1})})});$("body").on("pageshow","#register_form",function(b,a){});
$("body").on("pageshow","#index",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body);$("#playerCurrentlyPlayingDiv").css("max-width",0.9*$(window).width()).trigger("updatelayout");"undefined"!=typeof a.prevPage[0]&&"settings"!=a.prevPage[0].id&&("apply_settings"!=a.prevPage[0].id&&"music_uploader"!=a.prevPage[0].id)&&($.mobile.hidePageLoadingMsg(),current_playlist=$.trim(get_mpd_playlist(shuffle_queue)),playlist=""!=current_playlist?$.parseJSON(current_playlist):"");
$("body").enableSelection();$("#index").lazyloader("resetAll")});$("body").on("pageshow","#artists",function(b,a){$.mobile.hidePageLoadingMsg()});$("body").on("pageshow","#genres",function(b,a){$("#index").lazyloader("reset","artists");$.mobile.hidePageLoadingMsg()});$("body").on("pageshow","#playlists",function(b,a){$.mobile.hidePageLoadingMsg()});$("body").on("pageshow","#stations",function(b,a){$.mobile.hidePageLoadingMsg()});
$("body").on("pageshow","#queue",function(b,a){$.mobile.hidePageLoadingMsg();$("#currentlyPlayingArtistDiv").css("max-width",0.6*$(window).width());$("#currentlyPlayingAlbumDiv").css("max-width",0.6*$(window).width());$("#currentlyPlayingTrackDiv").css("max-width",0.6*$(window).width())});$("body").on("pageshow","#admin",function(b,a){$.mobile.hidePageLoadingMsg();"undefined"!=typeof a.prevPage[0]&&$.mobile.hidePageLoadingMsg();$.mobile.activeBtnClass="ui-btn-hover-"+theme.active});
$("body").on("pageshow","#setup",function(b,a){$.mobile.hidePageLoadingMsg();$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body);$.mobile.activeBtnClass="ui-btn-hover-"+theme.active});$("body").on("pageshow","#music_uploader",function(b,a){$('*[data-role="button"]').each(function(a){$(this).attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+theme.buttons).addClass("ui-btn-up-"+theme.buttons)})});
$("body").on("pageshow","#save_playlist",function(b,a){$("div.required-field-error").prev().css("border","2px solid #CC0000");if("undefined"!=typeof a.prevPage[0]&&"save_playlist"==a.prevPage[0].id){var d=!0;$("div.required-field-error").each(function(a){d=!1});d&&($.mobile.loadingMessage="Please wait",$.mobile.showPageLoadingMsg(),goBackTimer=setTimeout(function(){$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Please wait";history.go(-1)},1E3))}});
$("body").on("pageshow","#admin_payments",function(b,a){$("div.required-field-error").prev().css("border","2px solid #CC0000");"undefined"!=typeof a.prevPage[0]&&"admin_payments"==a.prevPage[0].id&&window.scrollTo(0,1)});$("body").on("pageshow","#edit_site_config",function(b,a){$("div.required-field-error").prev().css("border","2px solid #CC0000");"undefined"!=typeof a.prevPage[0]&&"edit_site_config"==a.prevPage[0].id&&window.scrollTo(0,1)});
$("body").on("pageshow","#edit_user_config",function(b,a){$("div.required-field-error").prev().css("border","2px solid #CC0000");"undefined"!=typeof a.prevPage[0]&&"edit_user_config"==a.prevPage[0].id&&window.scrollTo(0,1)});$("body").on("pageshow","#playlists",function(b,a){});
$("body").on("pageshow","#account",function(b,a){$.mobile.activeBtnClass="ui-btn-hover-"+theme.active;$("div.required-field-error").prev().css("border","2px solid #CC0000");"undefined"!=typeof a.prevPage[0]&&"account"==a.prevPage[0].id&&window.scrollTo(0,1)});
$.widget("blueimp.fileupload",$.blueimp.fileupload,{options:{acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,processQueue:{action:"validate",acceptFileTypes:"@",disabled:"@disableValidation"}},processActions:{validate:function(b,a){if(a.disabled)return b;var d=$.Deferred(),c=b.files[b.index];a.acceptFileTypes.test(c.type)?d.resolveWith(this,[b]):(c.error="Invalid file type.",d.rejectWith(this,[b]));return d.promise()}}});
$("body").on("pageshow","#station",function(b,a){$("#station_image_file").fileupload({url:"/upload/station/icon",replaceFileInput:!1,sequentialUploads:!0,dataType:"json",acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,maxFileSize:5242880,add:function(a,b){var g=[];$("#station_image_file_div").children().removeClass("required-field");$("#station_image_file_div").closest(".station-field-divs").height(80).find("div.required-field-error").remove();consoleLog("The file being uploaded is as follows",b.originalFiles);
/^image\/(gif|jpe?g|png)$/i.test(b.originalFiles[0].type)||g.push("The selected file is not an allowed type");5242880<b.originalFiles[0].size&&g.push("The selected file is larger than 5MB");if(0<g.length){$("#station_image_file_div").children().addClass("required-field");var n='<div class="error-message-divs">'+g.join('</div><div class="error-message-divs">')+"</div>";extraHeight=20*g.length;currentHeight=$("#station_image_file_div").closest(".station-field-divs").height();$("#station_image_file_div").closest(".station-field-divs").height(currentHeight+
extraHeight).append('<div class="required-field-error">'+n+"</div>")}else b.submit()},start:function(a){$.mobile.loadingMessage="Uploading image";$.mobile.showPageLoadingMsg();consoleLog("File upload started")},progress:function(a,b){var g=parseInt(100*(b.loaded/b.total),10);$.mobile.loadingMessage=g+"%";consoleLog(g)},done:function(a,b){consoleLog("File upload complete");consoleLog("e",a);consoleLog("data",b);consoleLog("Setting the uploaded_image element src to: /"+b.result.baseurl+b.result.filename);
$("#uploaded_image").attr("src","/"+b.result.baseurl+b.result.filename);$("#station_icon_id").val(b.result.id);$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading"},fail:function(a,b){consoleLog("File upload failed");$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading"}});$("div.required-field-error").prev().css("border","2px solid #CC0000");$("#saved_successfully").removeClass("success-top-padding");"undefined"!=typeof a.prevPage[0]&&"station"==a.prevPage[0].id&&window.scrollTo(0,
1)});$("body").on("pageshow","#login",function(b,a){});$("body").on("pagehide","#create_new_theme",function(b,a){0==$("#theme_id option:selected").val()&&($("#theme_id option:selected").val("1"),$("#theme_id").selectmenu("refresh",!0))});$("body").on("pagebeforeshow","#index",function(b,a){});$("body").on("pagebeforeshow","#station",function(b,a){"undefined"!=typeof a.prevPage[0]&&"station"==a.prevPage[0].id&&($.mobile.urlHistory.stack.pop(),$.mobile.urlHistory.activeIndex-=1)});
$("body").on("pagebeforeshow","#queue",function(b,a){$("#currentlyPlayingArtistDiv").css("max-width",0.6*$(window).width());$("#currentlyPlayingAlbumDiv").css("max-width",0.6*$(window).width());$("#currentlyPlayingTrackDiv").css("max-width",0.6*$(window).width())});$("body").on("pagebeforeshow","#account",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body);$.mobile.activeBtnClass="ui-btn-hover-"+theme.active});
$("body").on("pagebeforeshow","#admin",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body)});$("body").on("pagebeforechange","#artists",function(b,a){});$("body").on("pagebeforechange","#albums",function(b,a){});$("body").on("pagebeforechange","#tracks",function(b,a){});
$("body").on("change","#volume_control",function(){just_swiped_right=just_swiped_left=!0;waiting_to_adjust_volume||(waiting_to_adjust_volume=!0,setTimeout(function(){new_volume=$("#volume_control").val();post={parameters:[{volume:new_volume}]};control_mpd("set_volume",post.parameters[0]);just_swiped_right=just_swiped_left=waiting_to_adjust_volume=!1},1E3))});
$("body").on("change","#xfade_control",function(){just_swiped_right=just_swiped_left=!0;waiting_to_adjust_xfade||(waiting_to_adjust_xfade=!0,setTimeout(function(){new_xfade_value=$("#xfade_control").val();post={parameters:[{crossfade:new_xfade_value}]};control_mpd("set_crossfade",post.parameters[0]);just_swiped_right=just_swiped_left=waiting_to_adjust_xfade=!1},500))});
$("body").on("change","#volume_fade_control",function(){just_swiped_right=just_swiped_left=!0;waiting_to_adjust_volume_fade||(waiting_to_adjust_volume_fade=!0,setTimeout(function(){new_volume_fade_value=$("#volume_fade_control").val();just_swiped_right=just_swiped_left=waiting_to_adjust_volume_fade=!1},500))});$("body").on("change","#operating_mode",function(b,a){mode="Streaming"==$("#operating_mode :selected").text()?"streaming":"localplay"});
$("body").on("change","#station_visibility",function(b,a){var d="on"==$("#station_visibility").prop("value")?"off":"on";$("#station_visibility").prop("value",d).checkboxradio("refresh")});$("body").on("change","#user_account_active",function(b,a){var d="on"==$("#user_account_active").prop("value")?"off":"on";$("#user_account_active").prop("value",d).checkboxradio("refresh")});
$("body").on("change","#paypal_sandbox_mode",function(b,a){var d="on"==$("#paypal_sandbox_mode").prop("value")?"off":"on";$("#paypal_sandbox_mode").prop("value",d).checkboxradio("refresh")});
$("body").on("click","#playpause",function(b){b.preventDefault();$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading";playing?(updatePlayerDisplay(playing,"pause"),next_track_already_added&&($(inactivePlayerSelector).data("jPlayer").status.srcSet&&$(inactivePlayerSelector).jPlayer("stop"),$(inactivePlayerSelector).jPlayer("volume",1),$(activePlayerSelector).jPlayer("volume",1)),$(activePlayerSelector).jPlayer("pause"),control_mpd("pause"),playing=!1,paused=!0):skipto("same")});
$("body").on("click","#next",function(b){b.preventDefault();skipto("next");return!1});$("body").on("click","#prev",function(b){b.preventDefault();skipto("previous");return!1});
$("body").on("click","#repeat",function(b){repeat_track?($.mobile.showPageLoadingMsg(theme.bars,"Repeat Off",!0),setTimeout(function(){$.mobile.hidePageLoadingMsg()},3E3),repeat_track=!1,$("#repeat").removeClass("ui-btn-"+theme.action).removeClass("ui-btn-up-"+theme.action).removeClass("ui-btn-hover-"+theme.action).attr("data-theme",theme.buttons).attr("data-icon","repeat").addClass("ui-btn-"+theme.buttons).addClass("ui-btn-up-"+theme.buttons),post={parameters:[{repeat:"0"}]}):($.mobile.showPageLoadingMsg(theme.bars,
"Repeat On",!0),setTimeout(function(){$.mobile.hidePageLoadingMsg()},3E3),repeat_track=!0,$("#repeat").removeClass("ui-btn-"+theme.buttons).removeClass("ui-btn-up-"+theme.buttons).removeClass("ui-btn-hover-"+theme.buttons).attr("data-theme",theme.action).attr("data-icon","repeat").addClass("ui-btn-"+theme.action).addClass("ui-btn-up-"+theme.action),post={parameters:[{repeat:"1"}]});control_mpd("repeat",post.parameters[0]);$(activePlayerSelector).jPlayer("loop",!repeat)});
$("body").on("click","#shuffle",function(b){"undefined"!==typeof playlist.tracks?0<playlist.tracks.length?shuffle_queue?($.mobile.showPageLoadingMsg(theme.bars,"Unshuffling the playlist",!0),shuffle_queue=!1,$("#shuffle").removeClass("ui-btn-"+theme.action).removeClass("ui-btn-up-"+theme.action).removeClass("ui-btn-hover-"+theme.action).attr("data-theme",theme.buttons).attr("data-icon","shuffle").addClass("ui-btn-"+theme.buttons).addClass("ui-btn-up-"+theme.buttons),track_position=playlist.tracks[track_position].mpd_index,
playlist=unshuffle_playlist()):($.mobile.showPageLoadingMsg(theme.bars,"Shuffling the playlist",!0),shuffle_queue=!0,$("#shuffle").removeClass("ui-btn-"+theme.buttons).removeClass("ui-btn-up-"+theme.buttons).removeClass("ui-btn-hover-"+theme.buttons).attr("data-theme",theme.action).attr("data-icon","shuffle").addClass("ui-btn-"+theme.action).addClass("ui-btn-up-"+theme.action),playlist=$.parseJSON(shuffle_playlist(JSON.stringify(playlist)))):$.mobile.showPageLoadingMsg(theme.bars,"Nothing to shuffle",
!0):$.mobile.showPageLoadingMsg(theme.bars,"Nothing to shuffle",!0);setTimeout(function(){$.mobile.hidePageLoadingMsg()},2E3)});
$("body").on("click","#settings_form_save",function(b,a){b.preventDefault();var d=$("#is_admin_user").val(),c=$("#theme_id").val(),g=$("#mode").val(),n=$("#language_id").val(),h=$("#volume_control").val(),f=$("#xfade_control").val(),e=$("#volume_fade_control").val();"undefined"!=typeof h&&""!=h||!d||(h=5);if("undefined"==typeof f||""==f)f=5;if("undefined"==typeof e||""==e)e=5;"undefined"!=typeof c&&""!=c&&("undefined"!=typeof g&&""!=g&&"undefined"!=typeof n&&""!=n)&&($.mobile.loadingMessage="Saving Settings",
$.mobile.showPageLoadingMsg(),$.ajax({type:"POST",url:"/settings/save",async:!0,data:"theme_id="+c+"&mode="+g+"&volume="+h+"&crossfade="+f+"&volume_fade="+e+"&language_id="+n,success:function(a){saved=$.parseJSON(a);var b,c,d,g;b=theme.body;c=theme.bars;d=theme.buttons;a=theme.controls;g=theme.action;max_crossfade=f;volume_fade=e;out_volume_left_to_fade=e-1;in_volume_left_to_fade=e-1;theme.body=saved.theme[0].body;theme.bars=saved.theme[0].bars;theme.buttons=saved.theme[0].buttons;theme.controls=
saved.theme[0].controls;theme.action=saved.theme[0].action;theme.active=saved.theme[0].active;$.mobile.loadingMessageTheme=theme.bars;$.mobile.activeBtnClass="ui-btn-hover-"+theme.active;$(".ui-body-"+b).each(function(){$(this).removeClass("ui-body-"+b).addClass("ui-body-"+theme.body)});$(".ui-overlay-"+b).each(function(){$(this).removeClass("ui-overlay-"+b).addClass("ui-overlay-"+theme.body)});$(".ui-bar-"+c).each(function(){$(this).removeClass("ui-bar-"+c).addClass("ui-bar-"+theme.bars)});$("div.ui-select").each(function(a){$(this).find("div").attr("data-theme",
theme.buttons).removeClass("ui-btn-up-"+d).addClass("ui-btn-up-"+theme.buttons);$(this).find("select").attr("data-theme",theme.buttons)});$('input[data-type="range"]').parent().each(function(a){$(this).find("input").attr("data-theme",theme.buttons).attr("data-track-theme",theme.buttons).removeClass("ui-body-"+b).addClass("ui-body-"+theme.body);$(this).find('div[role="application"]').removeClass("ui-btn-down-"+d).addClass("ui-btn-down-"+theme.buttons);$(this).find(".ui-slider-bg").removeClass("ui-btn-hover-"+
g).addClass("ui-btn-hover-"+theme.action);$(this).find("a").attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+d).addClass("ui-btn-up-"+theme.bars)});$('button[type="button"]').parent().attr("data-theme",theme.action).removeClass("ui-btn-up-",g).addClass("ui-btn-up-",theme.action);$('button[type="button"]').attr("data-theme",theme.action);$("#prev").attr("data-theme",theme.controls).removeClass("ui-btn-up-"+d).removeClass("ui-btn-up-"+a).addClass("ui-btn-up-"+theme.controls);$("#playpause").attr("data-theme",
theme.controls).removeClass("ui-btn-up-"+d).removeClass("ui-btn-up-"+a).addClass("ui-btn-up-"+theme.controls);$("#next").attr("data-theme",theme.controls).removeClass("ui-btn-up-"+d).removeClass("ui-btn-up-"+a).addClass("ui-btn-up-"+theme.controls);$('div[data-role="page"]').each(function(a){$(this).attr("data-theme",theme.buttons);$(this).attr("data-divider-theme",theme.bars)});$('div[data-role="header"]').each(function(a){$(this).attr("data-theme",theme.buttons);$(this).attr("data-divider-theme",
theme.bars)});$('div[data-role="content"]').each(function(a){$(this).attr("data-theme",theme.buttons).attr("data-divider-theme",theme.bars)});$('div[data-role="footer"]').each(function(a){$(this).attr("data-theme",theme.buttons).attr("data-divider-theme",theme.bars)});$('*[data-role="button"]').each(function(a){$(this).attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+d).addClass("ui-btn-up-"+theme.buttons)});$("#libraryNav").attr("data-theme",theme.buttons).attr("data-divider-theme",theme.buttons);
$("#libraryNav li").not('li[data-role="list-divider"]').each(function(a){$(this).attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+d).addClass("ui-btn-up-"+theme.buttons)});$('#libraryNav li[data-role="list-divider"]').removeClass("ui-btn-up-"+d).removeClass("ui-btn-up-"+c).removeClass("ui-bar-"+c).addClass("ui-bar-"+theme.bars);$("#adminNav").attr("data-theme",theme.buttons).attr("data-divider-theme",theme.buttons);$("#adminNav li").not('li[data-role="list-divider"]').each(function(a){$(this).attr("data-theme",
theme.buttons).removeClass("ui-btn-up-"+d).addClass("ui-btn-up-"+theme.buttons)});$('#adminNav li[data-role="list-divider"]').removeClass("ui-btn-up-"+d).removeClass("ui-btn-up-"+c).removeClass("ui-bar-"+c).addClass("ui-bar-"+theme.bars);$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading";$("#settings").dialog("close")}}))});
$("body").on("click","#confirm_delete_yes",function(){var b=$("#item_type").val(),a=$("#item_name").val();"playlist"==b?(post={parameters:[{playlist_name:a}]},control_mpd("delete_playlist",post.parameters[0]),history.go(-2)):"station"==b?(b=$("#item_id").val(),$.mobile.loadingMessage="Deleting Station",$.mobile.showPageLoadingMsg(),$.ajax({type:"POST",url:"/stations/delete",async:!0,data:"station_id="+b,success:function(a){$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading";history.go(-2)}})):
"user"==b&&(b=$("#item_id").val(),$.mobile.loadingMessage="Deleting User Account",$.mobile.showPageLoadingMsg(),$.ajax({type:"POST",url:"/user/"+b+"/delete",async:!0,data:"user_id="+b,success:function(a){$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading";history.go(-2)}}))});$("body").on("click","#confirm_delete_no",function(){$(".ui-dialog").dialog("close")});
$("body").on("click","#apply_settings_yes",function(){setTimeout(function(){$.mobile.loadingMessage="Please wait";$.mobile.showPageLoadingMsg();setTimeout(function(){location.reload(!0)},500)},2E3)});$("body").on("click","#apply_settings_no",function(){});
$("body").on("click","#create_theme_save",function(b,a){b.preventDefault();var d=$("#theme_name").val(),c=$("#bars_letter_code").val(),g=$("#buttons_letter_code").val(),n=$("#body_letter_code").val(),h=$("#controls_letter_code").val(),f=$("#action_letter_code").val(),e=$("#active_state_letter_code").val();"undefined"!=typeof d&&""!=d?($.mobile.loadingMessage="Saving Theme",$.mobile.showPageLoadingMsg(),$.ajax({type:"POST",url:"/settings/create/theme",async:!0,data:"theme_name="+d+"&bars_letter_code="+
c+"&buttons_letter_code="+g+"&body_letter_code="+n+"&controls_letter_code="+h+"&action_letter_code="+f+"&active_state_letter_code="+e,success:function(a){$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading";history.go(-1)}})):$("#theme_name").css("border","2px solid #CC0000")});
$("body").on("click","#close_station",function(b,a){b.preventDefault();var d=0,c;for(c in $.mobile.urlHistory.stack)0<$.mobile.urlHistory.stack[c].url.indexOf("stations#&ui-state=dialog")&&(d+=1);window.history.go(-1*(d+1))});$("body").on("click","#close_database",function(b,a){b.preventDefault();var d=0,c;for(c in $.mobile.urlHistory.stack)0<$.mobile.urlHistory.stack[c].url.indexOf("setup/database")&&(d+=1);window.history.go(-1*d)});
$("body").on("click","#close_payments",function(b,a){b.preventDefault();var d=0,c;for(c in $.mobile.urlHistory.stack)0<$.mobile.urlHistory.stack[c].url.indexOf("admin/payments")&&(d+=1);window.history.go(-1*d)});$("body").on("click","#close_user",function(b,a){b.preventDefault();var d=0,c;for(c in $.mobile.urlHistory.stack)0<$.mobile.urlHistory.stack[c].url.indexOf("edit/user")&&(d+=1);window.history.go(-1*d)});
$("body").on("orientationchange","#index",function(b,a){$("#playerCurrentlyPlayingDiv").css("max-width",0.9*$(window).width());$("#playerCurrentlyPlayingDiv").width(0.9*$(window).width())});$("html,body").on("taphold",function(b,a){});
$("body").on("click","#volume_crossfade_form_save",function(b,a){b.preventDefault();var d=$("#is_admin_user").val(),c=$("#volume_control").val(),g=$("#xfade_control").val(),n=$("#volume_fade_control").val();"undefined"!=typeof c&&""!=c||!d||(c=5);if("undefined"==typeof g||""==g)g=5;if("undefined"==typeof n||""==n)n=5;$.mobile.loadingMessage="Saving Settings";$.mobile.showPageLoadingMsg();$.ajax({type:"POST",url:"/settings/save/volume",async:!0,data:"volume="+c+"&crossfade="+g+"&volume_fade="+n,success:function(a){saved=
$.parseJSON(a);$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading";$("#volume_crossfade").dialog("close")}})});$("body").on("click","#settingsPopupMenu ul li #volume_crossfade_button",function(b,a){$.mobile.changePage("/settings/volume",{allowSamePageTransition:!0,transition:"pop",reloadPage:!1,showLoadMsg:!1,changeHash:!0})});
$("body").on("click",'#settingsPopupMenu ul div[data-role="collapsible-set"] div[data-role="collapsible"] ul li a',function(b,a){var d=b.target.getAttribute("data-id"),c=b.target.getAttribute("data-item-id");b.target.getAttribute("data-item-name");"changeLanguage"==d?"undefined"!=typeof c&&($.mobile.loadingMessage="Setting Language",$.mobile.showPageLoadingMsg(),d=$("#currently_selected_theme_id").val(),$.ajax({type:"POST",url:"/settings/save/language",async:!0,data:"language_id="+c+"&theme_id="+
d,success:function(a){saved=$.parseJSON(a);$('div[data-role="collapsible-set"] ul#availableLanguages li a').each(function(a){$(this).attr("data-item-id")==c?($(this).closest("li").attr("data-icon","checked"),$(this).closest("li").find("div span.ui-icon").attr("class","ui-icon ui-icon-check ui-icon-shadow")):($(this).closest("ul").find('li[data-icon="check"]').attr("data-icon","minus"),$(this).closest("li").find("div span.ui-icon-check").attr("class","ui-icon ui-icon-minus ui-icon-shadow"))});$.mobile.hidePageLoadingMsg();
$.mobile.loadingMessage="Loading";$.mobile.changePage("/settings/apply",{allowSamePageTransition:!0,transition:"pop",reloadPage:!1,showLoadMsg:!1,changeHash:!0})}})):"changeTheme"==d&&("0"==c?$.mobile.changePage("/settings/custom/theme",{allowSamePageTransition:!0,transition:"pop",reloadPage:!1,showLoadMsg:!1,changeHash:!0}):"undefined"!=typeof c&&($.mobile.loadingMessage="Applying Theme",$.mobile.showPageLoadingMsg(),d=$("#currently_selected_language_id").val(),$.ajax({type:"POST",url:"/settings/save/theme",
async:!0,data:"theme_id="+c+"&language_id="+d,success:function(a){saved=$.parseJSON(a);var b,d,f,e;b=theme.body;d=theme.bars;f=theme.buttons;a=theme.controls;e=theme.actions;theme.body=saved.body;theme.bars=saved.bars;theme.buttons=saved.buttons;theme.controls=saved.controls;theme.actions=saved.actions;theme.active=saved.active;$.mobile.loadingMessageTheme=theme.bars;$.mobile.activeBtnClass="ui-btn-hover-"+theme.active;$(".ui-body-"+b).each(function(){$(this).removeClass("ui-body-"+b).addClass("ui-body-"+
theme.body)});$(".ui-overlay-"+b).each(function(){$(this).removeClass("ui-overlay-"+b).addClass("ui-overlay-"+theme.body)});$(".ui-bar-"+d).each(function(){$(this).removeClass("ui-bar-"+d).addClass("ui-bar-"+theme.bars)});$("div.ui-select").each(function(a){$(this).find("div").attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+f).addClass("ui-btn-up-"+theme.buttons);$(this).find("select").attr("data-theme",theme.buttons)});$('input[data-type="range"]').parent().each(function(a){$(this).find("input").attr("data-theme",
theme.buttons).attr("data-track-theme",theme.buttons).removeClass("ui-body-"+b).addClass("ui-body-"+theme.body);$(this).find('div[role="application"]').removeClass("ui-btn-down-"+f).addClass("ui-btn-down-"+theme.buttons);$(this).find(".ui-slider-bg").removeClass("ui-btn-hover-"+e).addClass("ui-btn-hover-"+theme.actions);$(this).find("a").attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+f).addClass("ui-btn-up-"+theme.bars)});$('button[type="button"]').parent().attr("data-theme",theme.actions).removeClass("ui-btn-up-",
e).addClass("ui-btn-up-",theme.actions);$('button[type="button"]').attr("data-theme",theme.actions);$("#prev").attr("data-theme",theme.controls).removeClass("ui-btn-up-"+f).removeClass("ui-btn-up-"+a).addClass("ui-btn-up-"+theme.controls);$("#playpause").attr("data-theme",theme.controls).removeClass("ui-btn-up-"+f).removeClass("ui-btn-up-"+a).addClass("ui-btn-up-"+theme.controls);$("#next").attr("data-theme",theme.controls).removeClass("ui-btn-up-"+f).removeClass("ui-btn-up-"+a).addClass("ui-btn-up-"+
theme.controls);$('div[data-role="page"]').each(function(a){$(this).attr("data-theme",theme.buttons);$(this).attr("data-divider-theme",theme.bars)});$('div[data-role="header"]').each(function(a){$(this).attr("data-theme",theme.buttons);$(this).attr("data-divider-theme",theme.bars)});$('div[data-role="content"]').each(function(a){$(this).attr("data-theme",theme.buttons).attr("data-divider-theme",theme.bars)});$('div[data-role="footer"]').each(function(a){$(this).attr("data-theme",theme.buttons).attr("data-divider-theme",
theme.bars)});$('*[data-role="button"]').each(function(a){$(this).attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+f).addClass("ui-btn-up-"+theme.buttons)});$("#libraryNav").attr("data-theme",theme.buttons).attr("data-divider-theme",theme.buttons);$("#libraryNav li").not('li[data-role="list-divider"]').each(function(a){$(this).attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+f).addClass("ui-btn-up-"+theme.buttons)});$('#libraryNav li[data-role="list-divider"]').removeClass("ui-btn-up-"+
f).removeClass("ui-btn-up-"+d).removeClass("ui-bar-"+d).addClass("ui-bar-"+theme.bars);$("#adminNav").attr("data-theme",theme.buttons).attr("data-divider-theme",theme.buttons);$("#adminNav li").not('li[data-role="list-divider"]').each(function(a){$(this).attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+f).addClass("ui-btn-up-"+theme.buttons)});$('#adminNav li[data-role="list-divider"]').removeClass("ui-btn-up-"+f).removeClass("ui-btn-up-"+d).removeClass("ui-bar-"+d).addClass("ui-bar-"+theme.bars);
$("#settingsPopupMenu ul li").not('div[data-role="collapsible"] li').each(function(a){$(this).attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+f).addClass("ui-btn-up-"+theme.buttons)});$('div[data-role="collapsible"] li').each(function(a){$(this).attr("data-theme",theme.actions).removeClass("ui-btn-up-"+e).addClass("ui-btn-up-"+theme.actions)});$('div[data-role="collapsible-set"]').each(function(a){$(this).attr("data-theme",theme.actions)});$('div[data-role="collapsible-set"] a').not('div[data-role="collapsible-set"] li a').each(function(a){$(this).attr("data-theme",
theme.actions).removeClass("ui-btn-up-"+e).addClass("ui-btn-up-"+theme.actions)});$('div[data-role="collapsible-set"] ul#availableThemes li a').each(function(a){$(this).attr("data-item-id")==c?($(this).closest("li").attr("data-icon","checked"),$(this).closest("li").find("div span.ui-icon").attr("class","ui-icon ui-icon-check ui-icon-shadow")):($(this).closest("ul").find('li[data-icon="check"]').attr("data-icon","minus"),$(this).closest("li").find("div span.ui-icon-check").attr("class","ui-icon ui-icon-minus ui-icon-shadow"))});
$.mobile.hidePageLoadingMsg();$.mobile.loadingMessage="Loading"}})))});$("body").on("popupafterclose","#settingsPopupMenu",function(b,a){$("#settings_button").removeClass("ui-btn-hover-"+theme.actions).addClass("ui-btn-up-"+theme.buttons);$("#settingsPopupMenu .ui-collapsible").each(function(a){$(this).trigger("collapse")})});
$("body").on("sortstart","#queueTracksList",function(b,a){fromIndexOfItemBeingSorted=$(b.target).children().index(a.item[0])-1;$(b.target).children().eq(fromIndexOfItemBeingSorted);$("#queueTracksList").listview("refresh")});
$("body").on("sortupdate","#queueTracksList",function(b,a){toIndexOfItemBeingSorted=$(b.target).children().index(a.item[0])-1;movedTrack=playlist.tracks[fromIndexOfItemBeingSorted];var d=$("#queueTrack_"+fromIndexOfItemBeingSorted);movedTrack.mpd_index=toIndexOfItemBeingSorted.toString();delete playlist.tracks[fromIndexOfItemBeingSorted];if(fromIndexOfItemBeingSorted<toIndexOfItemBeingSorted)playlist.tracks=$.map(playlist.tracks,function(a){if("undefined"!=typeof a){if(parseInt(a.mpd_index)>fromIndexOfItemBeingSorted&&
parseInt(a.mpd_index)<=toIndexOfItemBeingSorted){var b=a.mpd_index,c=(parseInt(a.mpd_index)-1).toString();a.mpd_index=c;$("#queueTrack_"+b).attr("data-queue-track-index",c).attr("id","queueTrack_"+c)}return a}return null});else if(fromIndexOfItemBeingSorted>toIndexOfItemBeingSorted){for(i=playlist.tracks.length-1;0<=i;i--)if("undefined"!=typeof playlist.tracks[i]&&parseInt(playlist.tracks[i].mpd_index)>=toIndexOfItemBeingSorted&&parseInt(playlist.tracks[i].mpd_index)<fromIndexOfItemBeingSorted){var c=
playlist.tracks[i].mpd_index,g=(parseInt(playlist.tracks[i].mpd_index)+1).toString();$("#queueTrack_"+c).attr("data-queue-track-index",g).attr("id","queueTrack_"+g)}playlist.tracks=$.map(playlist.tracks,function(a){return"undefined"!=typeof a?(parseInt(a.mpd_index)>=toIndexOfItemBeingSorted&&parseInt(a.mpd_index)<fromIndexOfItemBeingSorted&&(console.log(parseInt(a.mpd_index)+" >= "+toIndexOfItemBeingSorted+" && "+parseInt(a.mpd_index)+" < "+fromIndexOfItemBeingSorted),a.mpd_index=(parseInt(a.mpd_index)+
1).toString()),a):null})}d.attr("data-queue-track-index",toIndexOfItemBeingSorted).attr("id","queueTrack_"+toIndexOfItemBeingSorted);playlist.tracks.splice(toIndexOfItemBeingSorted,0,movedTrack);post={parameters:[{from_pos:fromIndexOfItemBeingSorted,to_pos:toIndexOfItemBeingSorted}]};control_mpd("move_track",post.parameters[0]);a.item[0].dataset.queueTrackIndex=toIndexOfItemBeingSorted});
$("body").on("sortstop","#queueTracksList",function(b,a){$(a.item[0]).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);$("#queueTracksList").listview("refresh")});
$("body").on("click","#queue #queueTracksList li",function(b,a){var d=$(b.target).closest("li"),c=d.attr("data-queue-track-index"),g=d.attr("data-queue-track-file"),n=d.attr("data-queue-track-link"),d=d.attr("id");idOfQueueTrackJustClicked="queueTrack_"+c;var h=$("#"+this.id),h=$("#queueTracksList li").index(h)-1;options={corners:!0,shadow:!0,history:!1,positionTo:this,transition:"pop"};$("#queueTrackPopupMenu").popup("open",options);$('#queueTrackPopupMenu a[data-id="playQueueTrack"]').attr("data-queue-track-index",
c).attr("data-queue-track-true-index",h).attr("data-queue-track-file",g).attr("data-queue-track-link",n);$('#queueTrackPopupMenu a[data-id="removeFromQueue"]').attr("data-queue-track-index",c).attr("data-queue-track-true-index",h).attr("data-source-id",d)});
$("body").on("click",'#queueTrackPopupMenu ul li a[data-id="playQueueTrack"]',function(b){var a=b.target.getAttribute("data-queue-track-index");$(b.target).children().index(this);b.target.getAttribute("data-queue-track-true-index");$("#queueTrack_"+a).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);$("#queueTrackPopupMenu").one("popupafterclose",function(b){skipto(a);$("html,body").animate({scrollTop:0},1200,function(){change_page("home",$.mobile.defaultPageTransition,
!1,!1,!0,null,null,!0,!1)})});$("#queueTrackPopupMenu").popup("close")});
$("body").on("click",'#queueTrackPopupMenu ul li a[data-id="removeFromQueue"]',function(b,a){var d=b.target.getAttribute("data-queue-track-index");$(b.target).children().index(this);var c=b.target.getAttribute("data-queue-track-true-index");$("#queueTrack_"+d).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);var g=b.target.getAttribute("data-source-id");$("#queueTrackPopupMenu").one("popupafterclose",function(a){post={parameters:[{index:c,id:g}]};control_mpd("remove",
post.parameters[0])});$("#queueTrackPopupMenu").popup("close")});$("body").on("popupafterclose","#queueTrackPopupMenu",function(b,a){""!==idOfQueueTrackJustClicked&&$("#"+idOfQueueTrackJustClicked).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons)});$("body").on("sortstart","#playlistTracks",function(b,a){fromIndexOfItemBeingSorted=$(b.target).children().index(a.item[0])-1;$(b.target).children().eq(fromIndexOfItemBeingSorted);$("#playlistTracks").listview("refresh")});
$("body").on("sortupdate","#playlistTracks",function(b,a){var d=a.item.context.parentElement.dataset.playlistName;toIndexOfItemBeingSorted=$(b.target).children().index(a.item[0])-1;post={parameters:[{playlist_name:d,from_pos:fromIndexOfItemBeingSorted,to_pos:toIndexOfItemBeingSorted}]};control_mpd("track_move",post.parameters[0]);a.item[0].dataset.playlistTrackIndex=toIndexOfItemBeingSorted});
$("body").on("sortstop","#playlistTracks",function(b,a){$(a.item[0]).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);$("#playlistTracks").listview("refresh")});
$("body").on("click","#playlistTracksPage #playlistTracks li",function(b,a){var d=$(b.target).closest("li"),c=d.attr("data-playlist-track-index"),g=d.attr("data-playlist-track-file"),d=d.attr("id");idOfPlaylistTrackJustClicked="playlistTrack_"+c;var n=$("#"+this.id),n=$("#playlistTracks li").index(n)-1;options={corners:!0,shadow:!0,history:!1,positionTo:this,transition:"pop"};$("#playlistTrackPopupMenu").popup("open",options);$('#playlistTrackPopupMenu a[data-id="addTrackToQueue"]').attr("data-playlist-track-index",
c).attr("data-playlist-track-file",g);$('#playlistTrackPopupMenu a[data-id="removeFromPlaylist"]').attr("data-playlist-track-index",c).attr("data-playlist-track-true-index",n).attr("data-source-id",d)});$("body").on("click","#settings_button",function(b,a){options={corners:!0,shadow:!0,history:!1,positionTo:this,transition:"slidedown"};$("#settingsPopupMenu").popup("open",options)});
$("body").on("click",'#playlistTrackPopupMenu ul li a[data-id="addTrackToQueue"]',function(b){var a=b.target.getAttribute("data-playlist-track-index");$(b.target).children().index(this);b=b.target.getAttribute("data-playlist-track-file");$("#playlistTrack_"+a).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);post={parameters:[{file:b}]};control_mpd("add",post.parameters[0]);$("#playlistTrackPopupMenu").popup("close")});
$("body").on("click",'#playlistTrackPopupMenu ul li a[data-id="removeFromPlaylist"]',function(b,a){var d=b.target.getAttribute("data-playlist-track-index");$(b.target).children().index(this);var c=b.target.getAttribute("data-playlist-track-true-index");$("#playlistTrack_"+d).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);var g=b.target.getAttribute("data-source-id");$("#playlistTrackPopupMenu").popup("close");$("#"+g).slideUp("slow",function(){post={parameters:[{playlist_name:$("#playlistTracks").attr("data-playlist-name"),
pos:c}]};control_mpd("track_remove",post.parameters[0]);$("#"+g).remove()})});
$("body").on("click","#albumTracksPage #albumTracks li",function(b,a){var d=$(b.target).closest("li"),c=d.attr("data-album-track-index"),g=d.attr("data-album-track-file"),d=d.attr("id");idOfAlbumTrackJustClicked="albumTrack_"+c;var n={corners:!0,shadow:!0,history:!1,positionTo:this,transition:"pop"};$("#albumTrackPopupMenu").popup("open",n);$('#albumTrackPopupMenu ul li a[data-id="addTrackToQueue"]').attr("data-album-track-index",c).attr("data-album-track-file",g);$('#albumTrackPopupMenu ul div #availablePlaylists a[data-id="addTrackToPlaylist"]').attr("data-album-track-index",
c).attr("data-album-track-file",g).attr("data-source-id",d)});$("body").on("popupafterclose","#playlistTrackPopupMenu",function(b,a){""!==idOfPlaylistTrackJustClicked&&$("#"+idOfPlaylistTrackJustClicked).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons)});$("body").on("popupafterclose","#albumTrackPopupMenu",function(b,a){""!==idOfAlbumTrackJustClicked&&$("#"+idOfAlbumTrackJustClicked).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons)});
$("body").on("click",'#albumTrackPopupMenu ul li a[data-id="addTrackToQueue"]',function(b){var a=b.target.getAttribute("data-album-track-index");b=b.target.getAttribute("data-album-track-file");$("#albumTrack_"+a).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);post={parameters:[{file:b}]};control_mpd("add",post.parameters[0]);$("#albumTrackPopupMenu").popup("close")});
$("body").on("click",'#albumTrackPopupMenu ul div #availablePlaylists a[data-id="addTrackToPlaylist"]',function(b,a){var d=$(b.target).closest("li").attr("data-playlist-name"),c=b.target.getAttribute("data-album-track-index"),g=b.target.getAttribute("data-album-track-file");$("#albumTrack_"+c).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);post={parameters:[{playlist_name:d,file:g}]};control_mpd("track_add",post.parameters[0]);$("#albumTrackPopupMenu").popup("close")});
var mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,touchHandled;
function simulateMouseEvent(b,a){var d,c,g,n;b.originalEvent.type.match(/^touch/)?(d=b.touches[0].screenX,c=b.touches[0].screenY,g=b.touches[0].clientX,n=b.touches[0].clientY):b.originalEvent.type.match(/^(mouse|click)/)?(d=b.originalEvent.screenX,c=b.originalEvent.screenY,g=b.originalEvent.clientX,n=b.originalEvent.clientY):n=g=c=d=0;var h=document.createEvent("MouseEvents");h.initMouseEvent(a,!0,!0,window,1,d,c,g,n,!1,!1,!1,!1,0,null);b.target.dispatchEvent(h)}
$("body").on("taphold","#playlistTracksPage #playlistTracks li a.move .ui-btn-inner",function(b,a){"undefined"!=typeof navigator.notification&&navigator.notification.vibrate(50);$(b.target).closest("li")});
$("body").on("focusin",'#artists input[data-type="search"], #albums input[data-type="search"]',function(b,a){$.mobile.loadingMessage="Retrieving all";$.mobile.showPageLoadingMsg();$("#index").lazyloader("option","retrieve","all").lazyloader("refresh","parameter","retrieve").lazyloader("loadMore",0)});

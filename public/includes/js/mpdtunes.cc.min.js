(function(b,a){function c(a,c){for(var f,e=[],g=0;g<a.length;++g){if(!(f=h[a[g]]))a:{f=b;for(var d=a[g].split(/[.\/]/),l=0;l<d.length;++l){if(!f[d[l]]){f=void 0;break a}f=f[d[l]]}}if(!f)throw"module definition dependecy not found: "+a[g];e.push(f)}c.apply(null,e)}function d(b,k,f){if("string"!==typeof b)throw"invalid module definition, module id must be defined and be a string";if(k===a)throw"invalid module definition, dependencies must be specified";if(f===a)throw"invalid module definition, definition function must be specified";
c(k,function(){h[b]=f.apply(null,arguments)})}var h={};d("moxie/core/utils/Basic",[],function(){var a=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},b=function(g){f(arguments,function(c,l){0<l&&f(c,function(l,f){void 0!==l&&(a(g[f])===a(l)&&~e(a(l),["array","object"])?b(g[f],l):g[f]=l)})});return g},f=function(a,e){var b,f;if(a){try{b=a.length}catch(c){b=void 0}if(void 0===b)for(f in a){if(a.hasOwnProperty(f)&&
!1===e(a[f],f))break}else for(f=0;f<b&&!1!==e(a[f],f);f++);}},e=function(a,e){if(e){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(e,a);for(var b=0,f=e.length;b<f;b++)if(e[b]===a)return b}return-1};return{guid:function(){var a=0;return function(e){var b=(new Date).getTime().toString(32),f;for(f=0;5>f;f++)b+=Math.floor(65535*Math.random()).toString(32);return(e||"o_")+b+(a++).toString(32)}}(),typeOf:a,extend:b,each:f,isEmptyObj:function(e){var b;if(!e||"object"!==a(e))return!0;for(b in e)return!1;
return!0},inSeries:function(e,b){function f(k){if("function"===a(e[k]))e[k](function(a){++k<c&&!a?f(k):b(a)})}var c=e.length;"function"!==a(b)&&(b=function(){});e&&e.length||b();f(0)},inParallel:function(a,e){var b=0,c=a.length,k=Array(c);f(a,function(a,g){a(function(a){if(a)return e(a);var f=[].slice.call(arguments);f.shift();k[g]=f;b++;b===c&&(k.unshift(null),e.apply(this,k))})})},inArray:e,arrayDiff:function(g,b){var f=[];"array"!==a(g)&&(g=[g]);"array"!==a(b)&&(b=[b]);for(var c in g)-1===e(g[c],
b)&&f.push(g[c]);return f.length?f:!1},arrayIntersect:function(a,b){var l=[];f(a,function(a){-1!==e(a,b)&&l.push(a)});return l.length?l:null},toArray:function(a){var e,b=[];for(e=0;e<a.length;e++)b[e]=a[e];return b},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},parseSizeStr:function(a){if("string"!==typeof a)return a;var e={t:1099511627776,g:1073741824,m:1048576,k:1024},b;a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,
""));b=a[2];a=+a[1];e.hasOwnProperty(b)&&(a*=e[b]);return a}}});d("moxie/core/I18n",["moxie/core/utils/Basic"],function(a){var b={};return{addI18n:function(f){return a.extend(b,f)},translate:function(a){return b[a]||a},_:function(a){return this.translate(a)},sprintf:function(b){var e=[].slice.call(arguments,1);return b.replace(/%[a-z]/g,function(){var b=e.shift();return"undefined"!==a.typeOf(b)?b:""})}}});d("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(a,b){var f={mimes:{},
extensions:{},addMimeType:function(a){a=a.split(/,/);var b,f,l;for(b=0;b<a.length;b+=2){l=a[b+1].split(/ /);for(f=0;f<l.length;f++)this.mimes[l[f]]=a[b];this.extensions[a[b]]=l}},extList2mimes:function(e,b){var f,l,c,k,d=[];for(l=0;l<e.length;l++)for(f=e[l].extensions.split(/\s*,\s*/),c=0;c<f.length;c++){if("*"===f[c])return[];if(k=this.mimes[f[c]])-1===a.inArray(k,d)&&d.push(k);else if(b&&/^\w+$/.test(f[c]))d.push("."+f[c]);else return[]}return d},mimes2exts:function(e){var b=this,f=[];a.each(e,
function(e){if("*"===e)return f=[],!1;var c=e.match(/^(\w+)\/(\*|\w+)$/);c&&("*"===c[2]?a.each(b.extensions,function(a,e){(new RegExp("^"+c[1]+"/")).test(e)&&[].push.apply(f,b.extensions[e])}):b.extensions[e]&&[].push.apply(f,b.extensions[e]))});return f},mimes2extList:function(e){var f=[],c=[];"string"===a.typeOf(e)&&(e=a.trim(e).split(/\s*,\s*/));c=this.mimes2exts(e);f.push({title:b.translate("Files"),extensions:c.length?c.join(","):"*"});f.mimes=e;return f},getFileExtension:function(a){return(a=
a&&a.match(/\.([^.]+)$/))?a[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};f.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");
return f});d("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(a){var b=function(a){var b={has:function(a,e){return-1!==e.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},f=function(){for(var b,f=0,g,c,l,d,k,m=arguments;f<m.length;f+=2){k=m[f];var p=m[f+1];if("undefined"===typeof b)for(l in b={},p)g=p[l],"object"===typeof g?b[g[0]]=a:b[g]=a;for(g=c=0;g<k.length;g++)if(d=k[g].exec(this.getUA())){for(l=0;l<p.length;l++)k=d[++c],g=p[l],"object"===typeof g&&
0<g.length?2==g.length?b[g[0]]="function"==typeof g[1]?g[1].call(this,k):g[1]:3==g.length?b[g[0]]="function"!==typeof g[1]||g[1].exec&&g[1].test?k?k.replace(g[1],g[2]):a:k?g[1].call(this,k,g[2]):a:4==g.length&&(b[g[0]]=k?g[3].call(this,k.replace(g[1],g[2])):a):b[g]=k?k:a;break}if(d)break}return b},c=function(f,c){for(var l in c)if("object"===typeof c[l]&&0<c[l].length)for(var k=0;k<c[l].length;k++){if(b.has(c[l][k],f))return"?"===l?a:l}else if(b.has(c[l],f))return"?"===l?a:l;return f},d={ME:"4.90",
"NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},k=[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],["name","version","major"],[/\s(opr)\/((\d+)?[\w\.]+)/i],[["name","Opera"],"version","major"],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,
/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],["name","version","major"],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[["name","IE"],"version","major"],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[["name","Yandex"],"version","major"],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[["name",/_/g," "],"version","major"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],["name","version",
"major"],[/(dolfin)\/((\d+)?[\w\.]+)/i],[["name","Dolphin"],"version","major"],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[["name","Chrome"],"version","major"],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[["name","Android Browser"],"version","major"],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],["version","major",["name","Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],["version","major","name"],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],
["name",["major",c,{1:["/8","/1","/3"],2:"/4","?":"/"}],["version",c,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],["name","version","major"],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[["name","Netscape"],"version","major"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,
/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],["name","version","major"]],m=[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],
["version","name"]],q=[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",c,d]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",c,d]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name",
"Symbian"],"version"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],["name",["version",/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return(new function(a){var e=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return f.apply(this,
k)};this.getEngine=function(){return f.apply(this,m)};this.getOS=function(){return f.apply(this,q)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return e};this.setUA=function(a){e=a;return this};this.setUA(e)}).getResult()}(),f={can:function(){var e={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(e){try{if(-1!==
a.inArray(e,["","text","document"]))return!0;if(window.XMLHttpRequest){var b=new XMLHttpRequest;b.open("get","/");if("responseType"in b)return b.responseType=e,b.responseType!==e?!1:!0}}catch(f){}return!1},use_data_uri:function(){var a=new Image;a.onload=function(){e.use_data_uri=1===a.width&&1===a.height};setTimeout(function(){a.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return!1}(),use_data_uri_over32kb:function(){return e.use_data_uri&&("IE"!==
f.browser||9<=f.version)},use_data_uri_of:function(a){return e.use_data_uri&&33E3>a||e.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");a.setAttribute("type","file");return!a.disabled}};return function(b){var f=[].slice.call(arguments);f.shift();return"function"===a.typeOf(e[b])?e[b].apply(this,f):!!e[b]}}(),browser:b.browser.name,version:parseFloat(b.browser.major),os:b.os.name,osVersion:b.os.version,verComp:function(a,b,f){var c=0,k=0,d=0,m={dev:-6,alpha:-5,
a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},c=function(a){a=(""+a).replace(/[_\-+]/g,".");a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return a.length?a.split("."):[-8]},q=function(a){return a?isNaN(a)?m[a]||-7:parseInt(a,10):0};a=c(a);b=c(b);k=Math.max(a.length,b.length);for(c=0;c<k;c++)if(a[c]!=b[c])if(a[c]=q(a[c]),b[c]=q(b[c]),a[c]<b[c]){d=-1;break}else if(a[c]>b[c]){d=1;break}if(!f)return d;switch(f){case ">":case "gt":return 0<d;case ">=":case "ge":return 0<=d;case "<=":case "le":return 0>=
d;case "==":case "=":case "eq":return 0===d;case "<>":case "!=":case "ne":return 0!==d;case "":case "<":case "lt":return 0>d;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};f.OS=f.os;return f});d("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(a){var b=function(a,b){return a.className?(new RegExp("(^|\\s+)"+b+"(\\s+|$)")).test(a.className):!1};return{get:function(a){return"string"!==
typeof a?a:document.getElementById(a)},hasClass:b,addClass:function(a,e){b(a,e)||(a.className=a.className?a.className.replace(/\s+$/,"")+" "+e:e)},removeClass:function(a,b){a.className&&(a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),function(a,b,e){return" "===b&&" "===e?" ":""}))},getStyle:function(a,b){if(a.currentStyle)return a.currentStyle[b];if(window.getComputedStyle)return window.getComputedStyle(a,null)[b]},getPos:function(b,e){function c(a){var b,e=0;b=0;a&&(b=a.getBoundingClientRect(),
a="CSS1Compat"===p.compatMode?p.documentElement:p.body,e=b.left+a.scrollLeft,b=b.top+a.scrollTop);return{x:e,y:b}}var k=0,l=0,d,p=document;e=e||p.body;if(b&&b.getBoundingClientRect&&"IE"===a.browser&&(!p.documentMode||8>p.documentMode))return k=c(b),l=c(e),{x:k.x-l.x,y:k.y-l.y};for(d=b;d&&d!=e&&d.nodeType;)k+=d.offsetLeft||0,l+=d.offsetTop||0,d=d.offsetParent;for(d=b.parentNode;d&&d!=e&&d.nodeType;)k-=d.scrollLeft||0,l-=d.scrollTop||0,d=d.parentNode;return{x:k,y:l}},getSize:function(a){return{w:a.offsetWidth||
a.clientWidth,h:a.offsetHeight||a.clientHeight}}}});d("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(a){function b(a,e){for(var c in a)if(a[c]===e)return c;return null}return{RuntimeError:function(){function f(a){this.code=a;this.name=b(e,a);this.message=this.name+": RuntimeError "+this.code}var e={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};a.extend(f,e);f.prototype=Error.prototype;return f}(),OperationNotAllowedException:function(){function b(a){this.code=a;this.name="OperationNotAllowedException"}
a.extend(b,{NOT_ALLOWED_ERR:1});b.prototype=Error.prototype;return b}(),ImageError:function(){function f(a){this.code=a;this.name=b(e,a);this.message=this.name+": ImageError "+this.code}var e={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};a.extend(f,e);f.prototype=Error.prototype;return f}(),FileException:function(){function f(a){this.code=a;this.name=b(e,a);this.message=this.name+": FileException "+this.code}var e={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,
INVALID_STATE_ERR:7,SYNTAX_ERR:8};a.extend(f,e);f.prototype=Error.prototype;return f}(),DOMException:function(){function f(a){this.code=a;this.name=b(e,a);this.message=this.name+": DOMException "+this.code}var e={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,
INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};a.extend(f,e);f.prototype=Error.prototype;return f}(),EventException:function(){function b(a){this.code=a;this.name="EventException"}a.extend(b,{UNSPECIFIED_EVENT_TYPE_ERR:0});b.prototype=Error.prototype;return b}()}});d("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],
function(a,b){function f(){var e={};b.extend(this,{uid:null,init:function(){this.uid||(this.uid=b.guid("uid_"))},addEventListener:function(a,f,c,d){var m=this,s;a=b.trim(a);/\s/.test(a)?b.each(a.split(/\s+/),function(a){m.addEventListener(a,f,c,d)}):(a=a.toLowerCase(),c=parseInt(c,10)||0,s=e[this.uid]&&e[this.uid][a]||[],s.push({fn:f,priority:c,scope:d||this}),e[this.uid]||(e[this.uid]={}),e[this.uid][a]=s)},hasEventListener:function(a){return a?!(!e[this.uid]||!e[this.uid][a]):!!e[this.uid]},removeEventListener:function(a,
c){a=a.toLowerCase();var f=e[this.uid]&&e[this.uid][a],d;if(f){if(c)for(d=f.length-1;0<=d;d--){if(f[d].fn===c){f.splice(d,1);break}}else f=[];f.length||(delete e[this.uid][a],b.isEmptyObj(e[this.uid])&&delete e[this.uid])}},removeAllEventListeners:function(){e[this.uid]&&delete e[this.uid]},dispatchEvent:function(f){var c,d,r,p={},s=!0;if("string"!==b.typeOf(f))if(d=f,"string"===b.typeOf(d.type))f=d.type,void 0!==d.total&&void 0!==d.loaded&&(p.total=d.total,p.loaded=d.loaded),p.async=d.async||!1;
else throw new a.EventException(a.EventException.UNSPECIFIED_EVENT_TYPE_ERR);-1!==f.indexOf("::")?function(a){c=a[0];f=a[1]}(f.split("::")):c=this.uid;f=f.toLowerCase();if(d=e[c]&&e[c][f]){d.sort(function(a,b){return b.priority-a.priority});r=[].slice.call(arguments);r.shift();p.type=f;r.unshift(p);var q=[];b.each(d,function(a){r[0].target=a.scope;p.async?q.push(function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,r))},1)}):q.push(function(b){b(!1===a.fn.apply(a.scope,r))})});q.length&&b.inSeries(q,
function(a){s=!a})}return s},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var e;"array"!==b.typeOf(a)&&(a=[a]);for(var f=0;f<a.length;f++)e="on"+a[f],"function"===b.typeOf(this[e])?this.addEventListener(a[f],this[e]):"undefined"===b.typeOf(this[e])&&
(this[e]=null)}})}f.instance=new f;return f});d("moxie/core/utils/Encode",[],function(){var a=function(a){return unescape(encodeURIComponent(a))},b=function(a){return decodeURIComponent(escape(a))};return{utf8_encode:a,utf8_decode:b,atob:function(a,e){if("function"===typeof window.atob)return e?b(window.atob(a)):window.atob(a);var c,d,l,m,p,s=0,q=0;m="";var u=[];if(!a)return a;a+="";do c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(s++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(s++)),
m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(s++)),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(s++)),l=c<<18|d<<12|m<<6|p,c=l>>16&255,d=l>>8&255,l&=255,64==m?u[q++]=String.fromCharCode(c):64==p?u[q++]=String.fromCharCode(c,d):u[q++]=String.fromCharCode(c,d,l);while(s<a.length);m=u.join("");return e?b(m):m},btoa:function(b,e){e&&a(b);if("function"===typeof window.btoa)return window.btoa(b);var c,d,k,r,p=0,s=0,q="",
q=[];if(!b)return b;do c=b.charCodeAt(p++),d=b.charCodeAt(p++),k=b.charCodeAt(p++),r=c<<16|d<<8|k,c=r>>18&63,d=r>>12&63,k=r>>6&63,r&=63,q[s++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r);while(p<b.length);q=q.join("");p=b.length%3;return(p?
q.slice(0,p-3):q)+"===".slice(p||3)}}});d("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(a,b,c){function e(c,f,d,g,q){var u=this,v,t=a.guid(f+"_");q=q||"browser";c=c||{};n[t]=this;d=a.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,
select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},d);c.preferred_caps&&(q=e.getMode(g,c.preferred_caps,q));v=function(){var b={};return{exec:function(a,e,c,d){if(v[e]&&(b[a]||(b[a]={context:this,instance:new v[e]}),b[a].instance[c]))return b[a].instance[c].apply(this,d)},removeInstance:function(a){delete b[a]},removeAllInstances:function(){var e=this;a.each(b,
function(b,c){"function"===a.typeOf(b.instance.destroy)&&b.instance.destroy.call(b.context);e.removeInstance(c)})}}}();a.extend(this,{initialized:!1,uid:t,type:f,mode:e.getMode(g,c.required_caps,q),shimid:t+"_container",clients:0,options:c,can:function(b,c,f){f=f||d;"string"===a.typeOf(b)&&"undefined"===a.typeOf(c)&&(b=e.parseCaps(b));if("object"===a.typeOf(b)){for(var k in b)if(!this.can(k,b[k],f))return!1;return!0}return"function"===a.typeOf(f[b])?f[b].call(this,c):c===f[b]},getShimContainer:function(){var e,
c=b.get(this.shimid);c||(e=this.options.container?b.get(this.options.container):document.body,c=document.createElement("div"),c.id=this.shimid,c.className="moxie-shim moxie-shim-"+this.type,a.extend(c.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),e.appendChild(c));return c},getShim:function(){return v},shimExec:function(a,b){var e=[].slice.call(arguments,2);return u.getShim().exec.call(this,this.uid,a,b,e)},exec:function(a,b){var e=[].slice.call(arguments,
2);return u[a]&&u[a][b]?u[a][b].apply(this,e):u.shimExec.apply(this,arguments)},destroy:function(){if(u){var a=b.get(this.shimid);a&&a.parentNode.removeChild(a);v&&v.removeAllInstances();this.unbindAll();delete n[this.uid];t=u=v=this.uid=null}}});this.mode&&c.required_caps&&!this.can(c.required_caps)&&(this.mode=!1)}var d={},n={};e.order="html5,flash,silverlight,html4";e.getRuntime=function(a){return n[a]?n[a]:!1};e.addConstructor=function(a,b){b.prototype=c.instance;d[a]=b};e.getConstructor=function(a){return d[a]||
null};e.getInfo=function(a){var b=e.getRuntime(a);return b?{uid:b.uid,type:b.type,mode:b.mode,can:function(){return b.can.apply(b,arguments)}}:null};e.parseCaps=function(b){var e={};if("string"!==a.typeOf(b))return b||{};a.each(b.split(","),function(a){e[a]=!0});return e};e.can=function(a,b){var c;c=e.getConstructor(a);var f;return c?(c=new c({required_caps:b}),f=c.mode,c.destroy(),!!f):!1};e.thatCan=function(a,b){var c=(b||e.order).split(/\s*,\s*/),f;for(f in c)if(e.can(c[f],a))return c[f];return null};
e.getMode=function(b,e,c){var f=null;"undefined"===a.typeOf(c)&&(c="browser");if(e&&!a.isEmptyObj(b)){a.each(e,function(e,c){if(b.hasOwnProperty(c)){var d=b[c](e);"string"===typeof d&&(d=[d]);if(!f)f=d;else if(!(f=a.arrayIntersect(f,d)))return f=!1}});if(f)return-1!==a.inArray(c,f)?c:f[0];if(!1===f)return!1}return c};e.capTrue=function(){return!0};e.capFalse=function(){return!1};e.capTest=function(a){return function(){return!!a}};return e});d("moxie/runtime/RuntimeClient",["moxie/core/Exceptions",
"moxie/core/utils/Basic","moxie/runtime/Runtime"],function(a,b,c){return function(){var e;b.extend(this,{connectRuntime:function(d){function n(b){var k;b.length?(k=b.shift(),(k=c.getConstructor(k))?(e=new k(d),e.bind("Init",function(){e.initialized=!0;setTimeout(function(){e.clients++;l.trigger("RuntimeInit",e)},1)}),e.bind("Error",function(){e.destroy();n(b)}),e.mode?e.init():e.trigger("Error")):n(b)):(l.trigger("RuntimeError",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR)),e=null)}var l=this,r;
"string"===b.typeOf(d)?r=d:"string"===b.typeOf(d.ruid)&&(r=d.ruid);if(r){if(e=c.getRuntime(r))return e.clients++,e;throw new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR);}n((d.runtime_order||c.order).split(/\s*,\s*/))},getRuntime:function(){return e&&e.uid?e:e=null},disconnectRuntime:function(){e&&0>=--e.clients&&(e.destroy(),e=null)}})}});d("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(a,b,c){function e(n,l){function r(b,c,f){var k=d[this.uid];
if("string"!==a.typeOf(k)||!k.length)return null;c=new e(null,{type:f,size:c-b});c.detach(k.substr(b,c.size));return c}c.call(this);n&&this.connectRuntime(n);l?"string"===a.typeOf(l)&&(l={data:l}):l={};a.extend(this,{uid:l.uid||a.guid("uid_"),ruid:n,size:l.size||0,type:l.type||"",slice:function(a,b,e){return this.isDetached()?r.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,e)},getSource:function(){return d[this.uid]?d[this.uid]:null},detach:function(a){this.ruid&&
(this.getRuntime().exec.call(this,"Blob","destroy",d[this.uid]),this.disconnectRuntime(),this.ruid=null);a=a||"";var e=a.match(/^data:([^;]*);base64,/);e&&(this.type=e[1],a=b.atob(a.substring(a.indexOf("base64,")+7)));this.size=a.length;d[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===a.typeOf(d[this.uid])},destroy:function(){this.detach();delete d[this.uid]}});l.data?this.detach(l.data):d[this.uid]=l}var d={};return e});d("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime",
"moxie/file/Blob"],function(a,b,c){function e(e,d){var l,r;d||(d={});r=d.type&&""!==d.type?d.type:b.getFileMime(d.name);d.name?(l=d.name.replace(/\\/g,"/"),l=l.substr(l.lastIndexOf("/")+1)):(l=r.split("/")[0],l=a.guid((""!==l?l:"file")+"_"),b.extensions[r]&&(l+="."+b.extensions[r][0]));c.apply(this,arguments);a.extend(this,{type:r||"",name:l||a.guid("file_"),lastModifiedDate:d.lastModifiedDate||(new Date).toLocaleString()})}e.prototype=c.prototype;return e});d("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/file/File moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),
function(a,b,c,e,d,n,l,r,p){function s(d){var g=this,s;-1!==a.inArray(a.typeOf(d),["string","node"])&&(d={browse_button:d});s=c.get(d.browse_button);if(!s)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR);s={accept:[{title:n.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:s.parentNode||document.body};d=a.extend({},s,d);"string"===typeof d.required_caps&&(d.required_caps=r.parseCaps(d.required_caps));"string"===typeof d.accept&&(d.accept=b.mimes2extList(d.accept));
s=c.get(d.container);s||(s=document.body);"static"===c.getStyle(s,"position")&&(s.style.position="relative");s=s=null;p.call(g);a.extend(g,{uid:a.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){g.convertEventPropsToHandlers(q);g.bind("RuntimeInit",function(b,e){g.ruid=e.uid;g.shimid=e.shimid;g.bind("Ready",function(){g.trigger("Refresh")},999);g.bind("Change",function(){var b=e.exec.call(g,"FileInput","getFiles");g.files=[];a.each(b,function(a){if(0===a.size)return!0;g.files.push(new l(g.ruid,
a))})},999);g.bind("Refresh",function(){var b,k,g;k=c.get(d.browse_button);g=c.get(e.shimid);k&&(b=c.getPos(k,c.get(d.container)),k=c.getSize(k),g&&a.extend(g.style,{top:b.y+"px",left:b.x+"px",width:k.w+"px",height:k.h+"px"}))});e.exec.call(g,"FileInput","init",d)});g.connectRuntime(a.extend({},d,{required_caps:{select_file:!0}}))},disable:function(b){var e=this.getRuntime();e&&e.exec.call(this,"FileInput","disable","undefined"===a.typeOf(b)?!0:b)},refresh:function(){g.trigger("Refresh")},destroy:function(){var b=
this.getRuntime();b&&(b.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===a.typeOf(this.files)&&a.each(this.files,function(a){a.destroy()});this.files=null}})}var q="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");s.prototype=d.instance;return s});d("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),
function(a,b,c,e,d,n,l,r){function p(c){var f=this,l;"string"===typeof c&&(c={drop_zone:c});l={accept:[{title:a.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};c="object"===typeof c?e.extend({},l,c):l;c.container=b.get(c.drop_zone)||document.body;"static"===b.getStyle(c.container,"position")&&(c.container.style.position="relative");"string"===typeof c.accept&&(c.accept=r.mimes2extList(c.accept));n.call(f);e.extend(f,{uid:e.guid("uid_"),ruid:null,files:null,init:function(){f.convertEventPropsToHandlers(s);
f.bind("RuntimeInit",function(a,b){f.ruid=b.uid;f.bind("Drop",function(){var a=b.exec.call(f,"FileDrop","getFiles");f.files=[];e.each(a,function(a){f.files.push(new d(f.ruid,a))})},999);b.exec.call(f,"FileDrop","init",c);f.dispatchEvent("ready")});f.connectRuntime(c)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null}})}var s=["ready","dragenter","dragleave","drop","error"];p.prototype=l.instance;return p});d("moxie/runtime/RuntimeTarget",
["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(a,b,c){function e(){this.uid=a.guid("uid_");b.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}e.prototype=c.instance;return e});d("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/runtime/RuntimeTarget".split(" "),function(a,b,c,e,d,n,l){function r(){function e(a,m){function s(a){q.readyState=
r.DONE;q.error=a;q.trigger("error");h()}function h(){n.destroy();n=null;q.trigger("loadend")}function w(b){n.bind("Error",function(a,b){s(b)});n.bind("Progress",function(a){q.result=b.exec.call(n,"FileReader","getResult");q.trigger(a)});n.bind("Load",function(a){q.readyState=r.DONE;q.result=b.exec.call(n,"FileReader","getResult");q.trigger(a);h()});b.exec.call(n,"FileReader","read",a,m)}n=new l;this.convertEventPropsToHandlers(p);if(this.readyState===r.LOADING)return s(new c.DOMException(c.DOMException.INVALID_STATE_ERR));
this.readyState=r.LOADING;this.trigger("loadstart");if(m instanceof d)if(m.isDetached()){var x=m.getSource();switch(a){case "readAsText":case "readAsBinaryString":this.result=x;break;case "readAsDataURL":this.result="data:"+m.type+";base64,"+b.btoa(x)}this.readyState=r.DONE;this.trigger("load");h()}else w(n.connectRuntime(m.ruid));else s(new c.DOMException(c.DOMException.NOT_FOUND_ERR))}var q=this,n;a.extend(this,{uid:a.guid("uid_"),readyState:r.EMPTY,result:null,error:null,readAsBinaryString:function(a){e.call(this,
"readAsBinaryString",a)},readAsDataURL:function(a){e.call(this,"readAsDataURL",a)},readAsText:function(a){e.call(this,"readAsText",a)},abort:function(){this.result=null;-1===a.inArray(this.readyState,[r.EMPTY,r.DONE])&&(this.readyState===r.LOADING&&(this.readyState=r.DONE),n&&n.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();n&&(n.getRuntime().exec.call(this,"FileReader","destroy"),n.disconnectRuntime());q=n=null}})}
var p="loadstart progress load abort error loadend".split(" ");r.EMPTY=0;r.LOADING=1;r.DONE=2;r.prototype=e.instance;return r});d("moxie/core/utils/Url",[],function(){var a=function(b,c){for(var e="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),d=e.length,n={http:80,https:443},l={},r=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(b||
"");d--;)r[d]&&(l[e[d]]=r[d]);l.scheme||(c&&"string"!==typeof c||(c=a(c||document.location.href)),l.scheme=c.scheme,l.host=c.host,l.port=c.port,e="",/^[^\/]/.test(l.path)&&(e=c.path,e=/(\/|\/[^\.]+)$/.test(e)?e+"/":e.replace(/\/[^\/]+$/,"/")),l.path=e+(l.path||""));l.port||(l.port=n[l.scheme]||80);l.port=parseInt(l.port,10);l.path||(l.path="/");delete l.source;return l};return{parseUrl:a,resolveUrl:function(b){b=a(b);return b.scheme+"://"+b.host+(b.port!=={http:80,https:443}[b.scheme]?":"+b.port:
"")+b.path+(b.query?b.query:"")},hasSameOrigin:function(b){function c(a){return[a.scheme,a.host,a.port].join("/")}"string"===typeof b&&(b=a(b));return c(a())===c(b)}}});d("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(a,b,c){return function(){function e(a,b){if(b.isDetached()){var e=b.getSource();switch(a){case "readAsBinaryString":return e;case "readAsDataURL":return"data:"+b.type+";base64,"+c.btoa(e);case "readAsText":for(var d=
"",k=0,m=e.length;k<m;k++)d+=String.fromCharCode(e[k]);return d}}else return e=this.connectRuntime(b.ruid).exec.call(this,"FileReaderSync","read",a,b),this.disconnectRuntime(),e}b.call(this);a.extend(this,{uid:a.guid("uid_"),readAsBinaryString:function(a){return e.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){return e.call(this,"readAsDataURL",a)},readAsText:function(a){return e.call(this,"readAsText",a)}})}});d("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic",
"moxie/file/Blob"],function(a,b,c){return function(){var a,d=[];b.extend(this,{append:function(m,l){var r=this,p=b.typeOf(l);l instanceof c?a={name:m,value:l}:"array"===p?(m+="[]",b.each(l,function(a){r.append(m,a)})):"object"===p?b.each(l,function(a,b){r.append(m+"["+b+"]",a)}):"null"===p||"undefined"===p||"number"===p&&isNaN(l)?r.append(m,"false"):d.push({name:m,value:l.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&
a.name||null},each:function(c){b.each(d,function(a){c(a.value,a.name)});a&&c(a.value,a.name)},destroy:function(){a=null;d=[]}})}});d("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),function(a,b,c,e,d,n,l,r,p,s,q,u){function v(){this.uid=a.guid("uid_")}
function h(){function c(a,b){if(C.hasOwnProperty(a)){if(1===arguments.length)return q.can("define_property")?C[a]:p[a];q.can("define_property")?C[a]=b:p[a]=b}}function f(b){function e(){G.destroy();G=null;g.dispatchEvent("loadend");g=null}function d(f){G.bind("LoadStart",function(a){c("readyState",h.LOADING);g.dispatchEvent("readystatechange");g.dispatchEvent(a);M&&g.upload.dispatchEvent(a)});G.bind("Progress",function(a){c("readyState")!==h.LOADING&&(c("readyState",h.LOADING),g.dispatchEvent("readystatechange"));
g.dispatchEvent(a)});G.bind("UploadProgress",function(a){M&&g.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});G.bind("Load",function(b){c("readyState",h.DONE);c("status",Number(f.exec.call(G,"XMLHttpRequest","getStatus")||0));c("statusText",z[c("status")]||"");c("response",f.exec.call(G,"XMLHttpRequest","getResponse",c("responseType")));~a.inArray(c("responseType"),["text",""])?c("responseText",c("response")):"document"===c("responseType")&&c("responseXML",
c("response"));R=f.exec.call(G,"XMLHttpRequest","getAllResponseHeaders");g.dispatchEvent("readystatechange");0<c("status")?(M&&g.upload.dispatchEvent(b),g.dispatchEvent(b)):(S=!0,g.dispatchEvent("error"));e()});G.bind("Abort",function(a){g.dispatchEvent(a);e()});G.bind("Error",function(a){S=!0;c("readyState",h.DONE);g.dispatchEvent("readystatechange");N=!0;g.dispatchEvent(a);e()});f.exec.call(G,"XMLHttpRequest","send",{url:y,method:E,async:H,user:J,password:O,headers:K,mimeType:F,encoding:P,responseType:g.responseType,
withCredentials:g.withCredentials,options:I},b)}var g=this;(new Date).getTime();G=new l;"string"===typeof I.required_caps&&(I.required_caps=n.parseCaps(I.required_caps));I.required_caps=a.extend({},I.required_caps,{return_response_type:g.responseType});b instanceof s&&(I.required_caps.send_multipart=!0);T||(I.required_caps.do_cors=!0);I.ruid?d(G.connectRuntime(I)):(G.bind("RuntimeInit",function(a,b){d(b)}),G.bind("RuntimeError",function(a,b){g.dispatchEvent("RuntimeError",b)}),G.connectRuntime(I))}
var p=this,C={timeout:0,readyState:h.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},H=!0,y,E,K={},J,O,P=null,F=null,L=!1,D=!1,M=!1,N=!1,S=!1,T=!1,I={},G,R="",Q;a.extend(this,C,{uid:a.guid("uid_"),upload:new v,open:function(f,l,p,n,q){if(!f||!l)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(f)||e.utf8_encode(f)!==f)throw new b.DOMException(b.DOMException.SYNTAX_ERR);~a.inArray(f.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&
(E=f.toUpperCase());if(~a.inArray(E,["CONNECT","TRACE","TRACK"]))throw new b.DOMException(b.DOMException.SECURITY_ERR);l=e.utf8_encode(l);f=d.parseUrl(l);T=d.hasSameOrigin(f);y=d.resolveUrl(l);if((n||q)&&!T)throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);J=n||f.user;O=q||f.pass;H=p||!0;if(!1===H&&(c("timeout")||c("withCredentials")||""!==c("responseType")))throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);L=!H;D=!1;K={};c("responseText","");c("responseXML",null);c("response",
null);c("status",0);c("statusText","");c("readyState",h.OPENED);this.convertEventPropsToHandlers(["readystatechange"]);this.dispatchEvent("readystatechange")},setRequestHeader:function(d,f){if(c("readyState")!==h.OPENED||D)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(d)||e.utf8_encode(d)!==d)throw new b.DOMException(b.DOMException.SYNTAX_ERR);d=a.trim(d).toLowerCase();if(~a.inArray(d,"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||
/^(proxy\-|sec\-)/.test(d))return!1;K[d]=K[d]?K[d]+(", "+f):f;return!0},getAllResponseHeaders:function(){return R||""},getResponseHeader:function(b){b=b.toLowerCase();return S||~a.inArray(b,["set-cookie","set-cookie2"])?null:R&&""!==R&&(Q||(Q={},a.each(R.split(/\r\n/),function(b){b=b.split(/:\s+/);2===b.length&&(b[0]=a.trim(b[0]),Q[b[0].toLowerCase()]={header:b[0],value:a.trim(b[1])})})),Q.hasOwnProperty(b))?Q[b].header+": "+Q[b].value:null},overrideMimeType:function(e){var d;if(~a.inArray(c("readyState"),
[h.LOADING,h.DONE]))throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);e=a.trim(e.toLowerCase());/;/.test(e)&&(d=e.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(e=d[1]);if(!u.mimes[e])throw new b.DOMException(b.DOMException.SYNTAX_ERR);},send:function(c,d){I="string"===a.typeOf(d)?{ruid:d}:d?d:{};this.convertEventPropsToHandlers(A);this.upload.convertEventPropsToHandlers(A);if(this.readyState!==h.OPENED||D)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(c instanceof r)I.ruid=c.ruid,
F=c.type||"application/octet-stream";else if(c instanceof s){if(c.hasBlob()){var g=c.getBlob();I.ruid=g.ruid;F=g.type||"application/octet-stream"}}else"string"===typeof c&&(P="UTF-8",F="text/plain;charset=UTF-8",c=e.utf8_encode(c));this.withCredentials||(this.withCredentials=I.required_caps&&I.required_caps.send_browser_cookies&&!T);M=!L&&this.upload.hasEventListener();S=!1;N=!c;L||(D=!0);f.call(this,c)},abort:function(){S=!0;L=!1;if(~a.inArray(c("readyState"),[h.UNSENT,h.OPENED,h.DONE]))c("readyState",
h.UNSENT);else{c("readyState",h.DONE);D=!1;if(G)G.getRuntime().exec.call(G,"XMLHttpRequest","abort",N);else throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);N=!0}},destroy:function(){G&&("function"===a.typeOf(G.destroy)&&G.destroy(),G=null);this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var z={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",
206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",
414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};v.prototype=c.instance;var A="loadstart progress abort error load timeout loadend".split(" ");
h.UNSENT=0;h.OPENED=1;h.HEADERS_RECEIVED=2;h.LOADING=3;h.DONE=4;h.prototype=c.instance;return h});d("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(a,b,c,e){function d(){function e(b,c){var f=this;p=c;f.bind("TransportingProgress",function(b){h=b.loaded;h<q&&-1===a.inArray(f.state,[d.IDLE,d.DONE])&&l.call(f)},999);f.bind("TransportingComplete",function(){h=q;f.state=d.DONE;s=null;f.result=p.exec.call(f,
"Transporter","getAsBlob",b||"")},999);f.state=d.BUSY;f.trigger("TransportingStarted");l.call(f)}function l(){var a;a=q-h;v>a&&(v=a);a=b.btoa(s.substr(h,v));p.exec.call(this,"Transporter","receive",a,q)}var r,p,s,q,h,v;c.call(this);a.extend(this,{uid:a.guid("uid_"),state:d.IDLE,result:null,transport:function(b,c,d){var f=this;d=a.extend({chunk_size:204798},d);if(r=d.chunk_size%3)d.chunk_size+=3-r;v=d.chunk_size;q=h=0;s=this.result=null;s=b;q=b.length;if("string"===a.typeOf(d)||d.ruid)e.call(f,c,this.connectRuntime(d));
else{var g=function(a,b){f.unbind("RuntimeInit",g);e.call(f,c,b)};this.bind("RuntimeInit",g);this.connectRuntime(d)}},abort:function(){this.state=d.IDLE;p&&(p.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));q=h=0;s=this.result=null},destroy:function(){this.unbindAll();p=null;this.disconnectRuntime();q=h=0;s=this.result=null}})}d.IDLE=0;d.BUSY=1;d.DONE=2;d.prototype=e.instance;return d});d("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),
function(a,b,c,e,d,n,l,r,p,s,q,h,v){function t(){function e(b){var d=a.typeOf(b);try{if(b instanceof t){if(!b.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);s.apply(this,arguments)}else if(b instanceof q){if(!~a.inArray(b.type,["image/jpeg","image/png"]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);x.apply(this,arguments)}else if(-1!==a.inArray(d,["blob","file"]))e.call(this,new h(null,b),arguments[1]);else if("string"===d)/^data:[^;]*;base64,/.test(b)?e.call(this,new q(null,
{data:b}),arguments[1]):B.apply(this,arguments);else if("node"===d&&"img"===b.nodeName.toLowerCase())e.call(this,b.src,arguments[1]);else throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);}catch(g){this.trigger("error",g)}}function s(b,c){var e=this.connectRuntime(b.ruid);this.ruid=e.uid;e.exec.call(this,"Image","loadFromImage",b,"undefined"===a.typeOf(c)?!0:c)}function x(b,c){function e(a){d.ruid=a.uid;a.exec.call(d,"Image","loadFromBlob",b)}var d=this;d.name=b.name||"";b.isDetached()?(this.bind("RuntimeInit",
function(a,b){e(b)}),c&&"string"===typeof c.required_caps&&(c.required_caps=n.parseCaps(c.required_caps)),this.connectRuntime(a.extend({required_caps:{access_image_binary:!0,resize_image:!0}},c))):e(this.connectRuntime(b.ruid))}function B(a,b){var c=this,e;e=new d;e.open("get",a);e.responseType="blob";e.onprogress=function(a){c.trigger(a)};e.onload=function(){x.call(c,e.response,!0)};e.onerror=function(a){c.trigger(a)};e.onloadend=function(){e.destroy()};e.bind("RuntimeError",function(a,b){c.trigger("RuntimeError",
b)});e.send(null,b)}l.call(this);a.extend(this,{uid:a.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){var a=void 0,a=this.getRuntime().exec.call(this,"Image","getInfo");this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name)},999);this.convertEventPropsToHandlers(z);e.apply(this,arguments)},downsize:function(b,
e,d,g){try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>t.MAX_RESIZE_WIDTH||this.height>t.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);if(!b&&!e||"undefined"===a.typeOf(d))d=!1;b=b||this.width;e=e||this.height;g="undefined"===a.typeOf(g)?!0:!!g;this.getRuntime().exec.call(this,"Image","downsize",b,e,d,g)}catch(k){this.trigger("error",k)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!p.can("create_canvas"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);
return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);a||(a="image/jpeg");"image/jpeg"!==a||b||(b=90);return this.getRuntime().exec.call(this,"Image","getAsBlob",a,b)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",a,b)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,
b);return v.atob(c.substring(c.indexOf("base64,")+7))},embed:function(e,d){function g(){if(p.can("create_canvas")){var b=q.getAsCanvas();if(b){e.appendChild(b);b=null;q.destroy();l.trigger("embedded");return}}b=q.getAsDataURL(n,s);if(!b)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(p.can("use_data_uri_of",b.length))e.innerHTML='<img src="'+b+'" width="'+q.width+'" height="'+q.height+'" />',q.destroy(),l.trigger("embedded");else{var d=new r;d.bind("TransportingComplete",function(){M=l.connectRuntime(this.result.ruid);
l.bind("Embedded",function(){a.extend(M.getShimContainer().style,{top:"0px",left:"0px",width:q.width+"px",height:q.height+"px"});M=null},999);M.exec.call(l,"ImageView","display",this.result.uid,A,w);q.destroy()});d.transport(v.atob(b.substring(b.indexOf("base64,")+7)),n,a.extend({},u,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:e}))}}var l=this,q,n,s,h,u=d||{},A=this.width,w=this.height,M;try{if(!(e=b.get(e)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);
if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>t.MAX_RESIZE_WIDTH||this.height>t.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);n=u.type||this.type||"image/jpeg";s=u.quality||90;h="undefined"!==a.typeOf(u.crop)?u.crop:!1;if(u.width)A=u.width,w=u.height||A;else{var N=b.getSize(e);N.w&&N.h&&(A=N.w,w=N.h)}q=new t;q.bind("Resize",function(){g.call(l)});q.bind("Load",function(){q.downsize(A,w,h,!1)});q.clone(this,!1);return q}catch(z){this.trigger("error",
z)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}})}var z=["progress","load","error","resize","embedded"];t.MAX_RESIZE_WIDTH=6500;t.MAX_RESIZE_HEIGHT=6500;t.prototype=s.instance;return t});d("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(a,b,c,e){var d={};c.addConstructor("html5",function(b,l,k){var p=this,s=c.capTest,q=c.capTrue;
k=a.extend({access_binary:s(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return p.can("access_binary")&&!!d.Image},display_media:s(e.can("create_canvas")||e.can("use_data_uri_over32kb")),do_cors:s(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:s(function(){var a=document.createElement("div");return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&("IE"!==e.browser||9<e.version)}()),filter_by_extension:s("Chrome"===e.browser&&
28<=e.version||"IE"===e.browser&&10<=e.version),return_response_headers:q,return_response_type:function(a){return"json"===a&&window.JSON?!0:e.can("return_response_type",a)},return_status_code:q,report_upload_progress:s(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return p.can("access_binary")&&e.can("create_canvas")},select_file:function(){return e.can("use_fileinput")&&window.File},select_folder:function(){return p.can("select_file")&&"Chrome"===e.browser&&21<=e.version},
select_multiple:function(){return p.can("select_file")&&!("Safari"===e.browser&&"Windows"===e.os)&&!("iOS"===e.os&&e.verComp(e.osVersion,"7.0.4","<"))},send_binary_string:s(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:s(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||p.can("send_binary_string")},slice_blob:s(window.File&&(File.prototype.mozSlice||
File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return p.can("slice_blob")&&p.can("send_multipart")},summon_file_dialog:s("Firefox"===e.browser&&4<=e.version||"Opera"===e.browser&&12<=e.version||"IE"===e.browser&&10<=e.version||!!~a.inArray(e.browser,["Chrome","Safari"])),upload_filesize:q},k);c.call(this,b,l||"html5",k);a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(p);a=p=null}}(this.destroy)});a.extend(this.getShim(),
d)});return d});d("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(a,b){return a.Blob=function(){function a(b,c,d){var f;if(window.File.prototype.slice)try{return b.slice(),b.slice(c,d)}catch(k){return b.slice(c,d-c)}else return(f=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?f.call(b,c,d):null}this.slice=function(){return new b(this.getRuntime().uid,a.apply(this,arguments))}}});d("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(a){function b(){this.returnValue=
!1}function c(){this.cancelBubble=!0}var e={},d="moxie_"+a.guid(),n=function(b,c,f){var k;c=c.toLowerCase();if(b[d]&&e[b[d]]&&e[b[d]][c]){k=e[b[d]][c];for(var q=k.length-1;0<=q;q--)if(k[q].orig===f||k[q].key===f)if(b.removeEventListener?b.removeEventListener(c,k[q].func,!1):b.detachEvent&&b.detachEvent("on"+c,k[q].func),k[q].orig=null,k[q].func=null,k.splice(q,1),void 0!==f)break;k.length||delete e[b[d]][c];if(a.isEmptyObj(e[b[d]])){delete e[b[d]];try{delete b[d]}catch(n){b[d]=void 0}}}};return{addEvent:function(l,
n,p,s){var q;n=n.toLowerCase();l.addEventListener?(q=p,l.addEventListener(n,q,!1)):l.attachEvent&&(q=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=b;a.stopPropagation=c;p(a)},l.attachEvent("on"+n,q));l[d]||(l[d]=a.guid());e.hasOwnProperty(l[d])||(e[l[d]]={});l=e[l[d]];l.hasOwnProperty(n)||(l[n]=[]);l[n].push({func:q,orig:p,key:s})},removeEvent:n,removeAllEvents:function(b,c){b&&b[d]&&a.each(e[b[d]],function(a,d){n(b,d,c)})}}});d("moxie/runtime/html5/file/FileInput",
"moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(a,b,c,d,g,n){return a.FileInput=function(){var a=[],m;b.extend(this,{init:function(p){var s=this,q=s.getRuntime(),h,v,t;m=p;a=[];p=m.accept.mimes||g.extList2mimes(m.accept,q.can("filter_by_extension"));h=q.getShimContainer();h.innerHTML='<input id="'+q.uid+'" type="file" style="font-size:999px;opacity:0;"'+(m.multiple&&q.can("select_multiple")?
"multiple":"")+(m.directory&&q.can("select_folder")?"webkitdirectory directory":"")+(p?' accept="'+p.join(",")+'"':"")+" />";p=c.get(q.uid);b.extend(p.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});v=c.get(m.browse_button);q.can("summon_file_dialog")&&("static"===c.getStyle(v,"position")&&(v.style.position="relative"),t=parseInt(c.getStyle(v,"z-index"),10)||1,v.style.zIndex=t,h.style.zIndex=t-1,d.addEvent(v,"click",function(a){var b=c.get(q.uid);b&&!b.disabled&&b.click();a.preventDefault()},
s.uid));h=q.can("summon_file_dialog")?v:h;d.addEvent(h,"mouseover",function(){s.trigger("mouseenter")},s.uid);d.addEvent(h,"mouseout",function(){s.trigger("mouseleave")},s.uid);d.addEvent(h,"mousedown",function(){s.trigger("mousedown")},s.uid);d.addEvent(c.get(m.container),"mouseup",function(){s.trigger("mouseup")},s.uid);p.onchange=function A(){a=[];m.directory?b.each(this.files,function(b){"."!==b.name&&a.push(b)}):a=[].slice.call(this.files);if("IE"!==n.browser)this.value="";else{var c=this.cloneNode(!0);
this.parentNode.replaceChild(c,this);c.onchange=A}s.trigger("change")};s.trigger({type:"ready",async:!0});h=null},getFiles:function(){return a},disable:function(a){var b=this.getRuntime();if(b=c.get(b.uid))b.disabled=!!a},destroy:function(){var b=this.getRuntime(),g=b.getShim(),b=b.getShimContainer();d.removeAllEvents(b,this.uid);d.removeAllEvents(m&&c.get(m.container),this.uid);d.removeAllEvents(m&&c.get(m.browse_button),this.uid);b&&(b.innerHTML="");g.removeInstance(this.uid);a=m=null}})}});d("moxie/runtime/html5/file/FileDrop",
["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(a,b,c,d,g){return a.FileDrop=function(){function a(c){for(var d=[],e=0;e<c.length;e++)[].push.apply(d,c[e].extensions.split(/\s*,\s*/));return-1===b.inArray("*",d)?d:[]}function l(a){a=g.getFileExtension(a.name);return!a||!v.length||-1!==b.inArray(a,v)}function m(a,c){var d=[];b.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?(a=a.getAsFile(),l(a)&&
u.push(a)):d.push(b))});d.length?p(d,c):c()}function p(a,c){var d=[];b.each(a,function(a){d.push(function(b){h(a,b)})});b.inSeries(d,function(){c()})}function h(a,b){a.isFile?a.file(function(a){l(a)&&u.push(a);b()},function(){b()}):a.isDirectory?q(a,b):b()}function q(a,b){function c(a){e.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],e=a.createReader();c(function(){p(d,b)})}var u=[],v=[],t;b.extend(this,{init:function(c){var f=this;t=c;v=a(t.accept);c=t.container;d.addEvent(c,
"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},f.uid);d.addEvent(c,"drop",function(a){a.preventDefault();a.stopPropagation();u=[];a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry?m(a.dataTransfer.items,function(){f.trigger("drop")}):(b.each(a.dataTransfer.files,function(a){l(a)&&u.push(a)}),f.trigger("drop"))},f.uid);d.addEvent(c,"dragenter",function(a){a.preventDefault();a.stopPropagation();f.trigger("dragenter")},f.uid);d.addEvent(c,
"dragleave",function(a){a.preventDefault();a.stopPropagation();f.trigger("dragleave")},f.uid)},getFiles:function(){return u},destroy:function(){d.removeAllEvents(t&&c.get(t.container),this.uid);u=v=t=null}})}});d("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(a,b,c){return a.FileReader=function(){var a,d=!1;c.extend(this,{read:function(b,k){var m=this;a=new window.FileReader;a.addEventListener("progress",function(a){m.trigger(a)});
a.addEventListener("load",function(a){m.trigger(a)});a.addEventListener("error",function(b){m.trigger(b,a.error)});a.addEventListener("loadend",function(){a=null});"function"===c.typeOf(a[b])?(d=!1,a[b](k.getSource())):"readAsBinaryString"===b&&(d=!0,a.readAsDataURL(k.getSource()))},getResult:function(){var c;a&&a.result?d?(c=a.result,c=b.atob(c.substring(c.indexOf("base64,")+7))):c=a.result:c=null;return c},abort:function(){a&&a.abort()},destroy:function(){a=null}})}});d("moxie/runtime/html5/xhr/XMLHttpRequest",
"moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),function(a,b,c,d,g,n,l,h,p){return a.XMLHttpRequest=function(){function a(b,c){var d=this,e,f;e=c.getBlob().getSource();f=new window.FileReader;f.onload=function(){c.append(c.getBlobName(),new n(null,{type:e.type,data:f.result}));v.send.call(d,b,c)};f.readAsBinaryString(e)}function m(){if(!window.XMLHttpRequest||
"IE"===p.browser&&8>p.version){var a;a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break a}catch(d){}a=void 0}return a}return new window.XMLHttpRequest}function u(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new h.RuntimeError(h.RuntimeError.NOT_SUPPORTED_ERR);t.setRequestHeader("Content-Type","multipart/form-data; boundary="+b);a.each(function(a,d){c=a instanceof n?c+("--"+b+
'\r\nContent-Disposition: form-data; name="'+d+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+(a.type||"application/octet-stream")+"\r\n\r\n"+a.getSource()+"\r\n"):c+("--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n")});return c+="--"+b+"--\r\n"}var v=this,t,z;b.extend(this,{send:function(c,f){var g=this,h="Mozilla"===p.browser&&4<=p.version&&7>p.version,r="Android Browser"===p.browser,v=!1;z=c.url.replace(/^.+?\/([\w\-\.]+)$/,
"$1").toLowerCase();t=m();t.open(c.method,c.url,c.async,c.user,c.password);if(f instanceof n)f.isDetached()&&(v=!0),f=f.getSource();else if(f instanceof l){if(f.hasBlob())if(f.getBlob().isDetached())f=u.call(g,f),v=!0;else if((h||r)&&"blob"===b.typeOf(f.getBlob().getSource())&&window.FileReader){a.call(g,c,f);return}if(f instanceof l){var y=new window.FormData;f.each(function(a,b){a instanceof n?y.append(b,a.getSource()):y.append(b,a)});f=y}}t.upload?(c.withCredentials&&(t.withCredentials=!0),t.addEventListener("load",
function(a){g.trigger(a)}),t.addEventListener("error",function(a){g.trigger(a)}),t.addEventListener("progress",function(a){g.trigger(a)}),t.upload.addEventListener("progress",function(a){g.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):t.onreadystatechange=function(){switch(t.readyState){case 3:var a,b;try{d.hasSameOrigin(c.url)&&(a=t.getResponseHeader("Content-Length")||0),t.responseText&&(b=t.responseText.length)}catch(f){a=b=0}g.trigger({type:"progress",lengthComputable:!!a,
total:parseInt(a,10),loaded:b});break;case 4:t.onreadystatechange=function(){},0===t.status?g.trigger("error"):g.trigger("load")}};b.isEmptyObj(c.headers)||b.each(c.headers,function(a,b){t.setRequestHeader(b,a)});""!==c.responseType&&"responseType"in t&&("json"!==c.responseType||p.can("return_response_type","json")?t.responseType=c.responseType:t.responseType="text");v?t.sendAsBinary?t.sendAsBinary(f):function(){for(var a=new Uint8Array(f.length),b=0;b<f.length;b++)a[b]=f.charCodeAt(b)&255;t.send(a.buffer)}():
t.send(f);g.trigger("loadstart")},getStatus:function(){try{if(t)return t.status}catch(a){}return 0},getResponse:function(a){var b=this.getRuntime();try{switch(a){case "blob":var d=new g(b.uid,t.response),e=t.getResponseHeader("Content-Disposition");if(e){var k=e.match(/filename=([\'\"'])([^\1]+)\1/);k&&(z=k[2])}d.name=z;d.type||(d.type=c.getFileMime(z));return d;case "json":return p.can("return_response_type","json")?t.response:200===t.status&&window.JSON?JSON.parse(t.responseText):null;case "document":var l;
var m=t.responseXML,q=t.responseText;"IE"===p.browser&&q&&m&&!m.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(t.getResponseHeader("Content-Type"))&&(m=new window.ActiveXObject("Microsoft.XMLDOM"),m.async=!1,m.validateOnParse=!1,m.loadXML(q));l=m&&("IE"===p.browser&&0!==m.parseError||!m.documentElement||"parsererror"===m.documentElement.tagName)?null:m;return l;default:return""!==t.responseText?t.responseText:null}}catch(n){return null}},getAllResponseHeaders:function(){try{return t.getAllResponseHeaders()}catch(a){}return""},
abort:function(){t&&t.abort()},destroy:function(){v=z=null}})}});d("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function b(a,c){var k=d?0:-8*(c-1),m=0,p;for(p=0;p<c;p++)m|=e.charCodeAt(a+p)<<Math.abs(k+8*p);return m}function c(a,b,d){d=3===arguments.length?d:e.length-b-1;e=e.substr(0,b)+a+e.substr(d+b)}var d=!1,e;return{II:function(b){if(b===a)return d;d=b},init:function(a){d=!1;e=a},SEGMENT:function(a,b,d){switch(arguments.length){case 1:return e.substr(a,e.length-a-1);
case 2:return e.substr(a,b);case 3:c(d,a,b);break;default:return e}},BYTE:function(a){return b(a,1)},SHORT:function(a){return b(a,2)},LONG:function(e,n){if(n===a)return b(e,4);var l="",h=d?0:-24,p;for(p=0;4>p;p++)l+=String.fromCharCode(n>>Math.abs(h+8*p)&255);c(l,e,4)},SLONG:function(a){a=b(a,4);return 2147483647<a?a-4294967296:a},STRING:function(a,c){var d="";for(c+=a;a<c;a++)d+=String.fromCharCode(b(a,1));return d}}}});d("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],
function(a){return function f(b){var c=[],d,l,h,p=0;d=new a;d.init(b);if(65496===d.SHORT(0)){for(l=2;l<=b.length;)if(h=d.SHORT(l),65488<=h&&65495>=h)l+=2;else{if(65498===h||65497===h)break;p=d.SHORT(l+2)+2;65505<=h&&65519>=h&&c.push({hex:h,name:"APP"+(h&15),start:l,length:p,segment:d.SEGMENT(l,p)});l+=p}d.init(null);return{headers:c,restore:function(a){var b;d.init(a);l=65504==d.SHORT(2)?4+d.SHORT(4):2;b=0;for(a=c.length;b<a;b++)d.SEGMENT(l,0,c[b].segment),l+=c[b].length;a=d.SEGMENT();d.init(null);
return a},strip:function(a){var b,c;c=new f(a);b=c.headers;c.purge();d.init(a);for(a=b.length;a--;)d.SEGMENT(b[a].start,b[a].length,"");a=d.SEGMENT();d.init(null);return a},get:function(a){for(var b=[],d=0,e=c.length;d<e;d++)c[d].name===a.toUpperCase()&&b.push(c[d].segment);return b},set:function(a,b){var d=[],e,f,l;"string"===typeof b?d.push(b):d=b;e=f=0;for(l=c.length;e<l&&!(c[e].name===a.toUpperCase()&&(c[e].segment=d[f],c[e].length=d[f].length,f++),f>=d.length);e++);},purge:function(){c=[];d.init(null);
d=null}}}}});d("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(b,c){return function(){function d(b,c){var f=e.SHORT(b),k,g,m,h,n,w=[],x={};for(k=0;k<f;k++)if(n=b+12*k+2,m=c[e.SHORT(n)],m!==a){g=e.SHORT(n+=2);h=e.LONG(n+=2);n+=4;w=[];switch(g){case 1:case 7:4<h&&(n=e.LONG(n)+l.tiffHeader);for(g=0;g<h;g++)w[g]=e.BYTE(n+g);break;case 2:4<h&&(n=e.LONG(n)+l.tiffHeader);x[m]=e.STRING(n,h-1);continue;case 3:2<h&&(n=e.LONG(n)+l.tiffHeader);
for(g=0;g<h;g++)w[g]=e.SHORT(n+2*g);break;case 4:1<h&&(n=e.LONG(n)+l.tiffHeader);for(g=0;g<h;g++)w[g]=e.LONG(n+4*g);break;case 5:n=e.LONG(n)+l.tiffHeader;for(g=0;g<h;g++)w[g]=e.LONG(n+4*g)/e.LONG(n+4*g+4);break;case 9:n=e.LONG(n)+l.tiffHeader;for(g=0;g<h;g++)w[g]=e.SLONG(n+4*g);break;case 10:n=e.LONG(n)+l.tiffHeader;for(g=0;g<h;g++)w[g]=e.SLONG(n+4*g)/e.SLONG(n+4*g+4);break;default:continue}h=1==h?w[0]:w;r.hasOwnProperty(m)&&"object"!=typeof h?x[m]=r[m][h]:x[m]=h}return x}var e,g,h,l={},r;e=new c;
g={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",
41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};r={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",
14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",
16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",
79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},
Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};return{init:function(b){l={tiffHeader:10};if(b===a||!b.length)return!1;e.init(b);return 65505===e.SHORT(0)&&"EXIF\x00"===e.STRING(4,5).toUpperCase()?(b=l.tiffHeader,e.II(18761==e.SHORT(b)),42!==e.SHORT(b+=2)?b=!1:(l.IFD0=l.tiffHeader+e.LONG(b+2),
h=d(l.IFD0,g.tiff),"ExifIFDPointer"in h&&(l.exifIFD=l.tiffHeader+h.ExifIFDPointer,delete h.ExifIFDPointer),"GPSInfoIFDPointer"in h&&(l.gpsIFD=l.tiffHeader+h.GPSInfoIFDPointer,delete h.GPSInfoIFDPointer),b=!0),b):!1},TIFF:function(){return h},EXIF:function(){var a;a=d(l.exifIFD,g.exif);if(a.ExifVersion&&"array"===b.typeOf(a.ExifVersion)){for(var c=0,e="";c<a.ExifVersion.length;c++)e+=String.fromCharCode(a.ExifVersion[c]);a.ExifVersion=e}return a},GPS:function(){var a;a=d(l.gpsIFD,g.gps);a.GPSVersionID&&
"array"===b.typeOf(a.GPSVersionID)&&(a.GPSVersionID=a.GPSVersionID.join("."));return a},setExif:function(a,b){if("PixelXDimension"!==a&&"PixelYDimension"!==a)return!1;var c;c=a;var d,f,k,m=0;if("string"===typeof c)for(f in d=g.exif,d)if(d[f]===c){c=f;break}d=l.exifIFD;f=e.SHORT(d);for(var h=0;h<f;h++)if(k=d+12*h+2,e.SHORT(k)==c){m=k+8;break}m?(e.LONG(m,b),c=!0):c=!1;return c},getBinary:function(){return e.SEGMENT()},purge:function(){e.init(null);e=h=null;l={}}}}});d("moxie/runtime/html5/image/JPEG",
["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(a,b,c,d,g){return function(h){var l,r,p,s,q,u;l=h;r=new d;r.init(l);if(65496!==r.SHORT(0))throw new b.ImageError(b.ImageError.WRONG_FORMAT);p=new c(h);s=new g;u=!!s.init(p.get("app1")[0]);q=function(){for(var a=0,b;a<=l.length;){b=r.SHORT(a+=2);if(65472<=b&&65475>=b)return a+=5,{height:r.SHORT(a),width:r.SHORT(a+2)};b=r.SHORT(a+=
2);a+=b-2}return null}.call(this);a.extend(this,{type:"image/jpeg",size:l.length,width:q&&q.width||0,height:q&&q.height||0,setExif:function(b,c){if(!u)return!1;"object"===a.typeOf(b)?a.each(b,function(a,b){s.setExif(b,a)}):s.setExif(b,c);p.set("app1",s.getBinary())},writeHeaders:function(){return arguments.length?p.restore(arguments[0]):l=p.restore(l)},stripHeaders:function(a){return p.strip(a)},purge:function(){s&&p&&r&&(s.purge(),p.purge(),r.init(null),l=q=p=s=r=null)}});u&&(this.meta={tiff:s.TIFF(),
exif:s.EXIF(),gps:s.GPS()})}});d("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(a,b,c){return function(d){function g(){l&&(l.init(null),h=r=l=null)}var h,l,r;h=d;l=new c;l.init(h);(function(){for(var b=0,c=0,d=[35152,20039,3338,6666],c=0;c<d.length;c++,b+=2)if(d[c]!=l.SHORT(b))throw new a.ImageError(a.ImageError.WRONG_FORMAT);})();r=function(){var a=8,b,c,d;b=l.LONG(a);c=l.STRING(a+=4,4);d=a+=4;l.LONG(a+b);return"IHDR"==
c?{width:l.LONG(d),height:l.LONG(d+4)}:null}.call(this);b.extend(this,{type:"image/png",size:h.length,width:r.width,height:r.height,purge:function(){g.call(this)}});g.call(this)}});d("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(a,b,c,d){return function(g){var h=[c,d],l;l=function(){for(var a=0;a<h.length;a++)try{return new h[a](g)}catch(c){}throw new b.ImageError(b.ImageError.WRONG_FORMAT);
}();a.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){}});a.extend(this,l);this.purge=function(){l.purge();l=null}}});d("moxie/runtime/html5/image/MegaPixel",[],function(){function a(b){var c=b.naturalWidth;if(1048576<c*b.naturalHeight){var d=document.createElement("canvas");d.width=d.height=1;d=d.getContext("2d");d.drawImage(b,-c+1,0);return 0===d.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:a,
renderTo:function(b,c,d){var g=b.naturalWidth,h=b.naturalHeight,l=d.width,r=d.height,p=d.x||0;d=d.y||0;c=c.getContext("2d");a(b)&&(g/=2,h/=2);var s=document.createElement("canvas");s.width=s.height=1024;var q=s.getContext("2d"),u;u=h;var v=document.createElement("canvas");v.width=1;v.height=u;v=v.getContext("2d");v.drawImage(b,0,0);for(var v=v.getImageData(0,0,1,u).data,t=0,z=u,A=u;A>t;)0===v[4*(A-1)+3]?z=A:t=A,A=z+t>>1;u=A/u;u=0===u?1:u;for(v=0;v<h;){t=v+1024>h?h-v:1024;for(z=0;z<g;){A=z+1024>g?
g-z:1024;q.clearRect(0,0,1024,1024);q.drawImage(b,-z,-v);var w=z*l/g+p<<0,x=Math.ceil(A*l/g),B=v*r/h/u+d<<0,C=Math.ceil(t*r/h/u);c.drawImage(s,0,0,A,t,w,B,x,C);z+=1024}v+=1024}}}});d("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(a,b,c,d,g,h,l,r,p){return a.Image=
function(){function a(){if(!B&&!w)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);return B||w}function m(a){return d.atob(a.substring(a.indexOf("base64,")+7))}function u(a){var b=this;w=new Image;w.onerror=function(){z.call(this);b.trigger("error",new c.ImageError(c.ImageError.WRONG_FORMAT))};w.onload=function(){b.trigger("load")};w.src=/^data:[^;]*;base64,/.test(a)?a:"data:"+(H.type||"")+";base64,"+d.btoa(a)}function v(a,b){var d=this,e;if(window.FileReader)e=new FileReader,e.onload=function(){b(this.result)},
e.onerror=function(){d.trigger("error",new c.FileException(c.FileException.NOT_READABLE_ERR))},e.readAsDataURL(a);else return b(a.getAsDataURL())}function t(c,d,e,f){var g,m=0,h=0,q,n;E=f;n=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;-1!==b.inArray(n,[5,6,7,8])&&(q=c,c=d,d=q);q=a();g=(e?Math.max:Math.min)(c/q.width,d/q.height);if(!(1<g)||e&&!f){B||(B=document.createElement("canvas"));f=Math.round(q.width*g);g=Math.round(q.height*g);e?(B.width=c,B.height=d,f>c&&(m=Math.round((f-c)/2)),
g>d&&(h=Math.round((g-d)/2))):(B.width=f,B.height=g);if(!E){c=B.width;d=B.height;switch(n){case 5:case 6:case 7:case 8:B.width=d;B.height=c;break;default:B.width=c,B.height=d}e=B.getContext("2d");switch(n){case 2:e.translate(c,0);e.scale(-1,1);break;case 3:e.translate(c,d);e.rotate(Math.PI);break;case 4:e.translate(0,d);e.scale(1,-1);break;case 5:e.rotate(.5*Math.PI);e.scale(1,-1);break;case 6:e.rotate(.5*Math.PI);e.translate(0,-d);break;case 7:e.rotate(.5*Math.PI);e.translate(c,-d);e.scale(-1,1);
break;case 8:e.rotate(-.5*Math.PI),e.translate(-c,0)}}n=B;m=-m;h=-h;"iOS"===p.OS?l.renderTo(q,n,{width:f,height:g,x:m,y:h}):n.getContext("2d").drawImage(q,m,h,f,g);this.width=B.width;this.height=B.height;y=!0}this.trigger("Resize")}function z(){x&&(x.purge(),x=null);C=w=B=H=null;y=!1}var A=this,w,x,B,C,H,y=!1,E=!0;b.extend(this,{loadFromBlob:function(a){var b=this,d=b.getRuntime(),e=1<arguments.length?arguments[1]:!0;if(!d.can("access_binary"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);
H=a;a.isDetached()?(C=a.getSource(),u.call(this,C)):v.call(this,a.getSource(),function(a){e&&(C=m(a));u.call(b,a)})},loadFromImage:function(a,b){this.meta=a.meta;H=new g(null,{name:a.name,size:a.size,type:a.type});u.call(this,b?C=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var b=this.getRuntime();!x&&C&&b.can("access_image_binary")&&(x=new h(C));return{width:a().width||0,height:a().height||0,type:H.type||r.getFileMime(H.name),size:C&&C.length||H.size||0,name:H.name||"",meta:x&&x.meta||
this.meta||{}}},downsize:function(){t.apply(this,arguments)},getAsCanvas:function(){B&&(B.id=this.uid+"_canvas");return B},getAsBlob:function(a,b){a!==this.type&&t.call(this,this.width,this.height,!1);return new g(null,{name:H.name||"",type:a,data:A.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a,b){var c=b||90;if(!y)return w.src;if("image/jpeg"!==a)return B.toDataURL("image/png");try{return B.toDataURL("image/jpeg",c/100)}catch(d){return B.toDataURL("image/jpeg")}},getAsBinaryString:function(a,
b){if(!y)return C||(C=m(A.getAsDataURL(a,b))),C;if("image/jpeg"!==a)C=m(A.getAsDataURL(a,b));else{var c;b||(b=90);try{c=B.toDataURL("image/jpeg",b/100)}catch(d){c=B.toDataURL("image/jpeg")}C=m(c);x&&(C=x.stripHeaders(C),E&&(x.meta&&x.meta.exif&&x.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),C=x.writeHeaders(C)),x.purge(),x=null)}y=!1;return C},destroy:function(){A=null;z.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});d("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic",
"moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(a,b,c,d,g){function h(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}a=a.match(/\d+/g);return parseFloat(a[0]+"."+a[1])}var l={};g.addConstructor("flash",function(r){var p=this,s;r=a.extend({swf_url:b.swf_url},r);g.call(this,r,"flash",{access_binary:function(a){return a&&
"browser"===p.mode},access_image_binary:function(a){return a&&"browser"===p.mode},display_media:g.capTrue,do_cors:g.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===p.mode},resize_image:g.capTrue,return_response_headers:!1,return_response_type:function(b){return"json"===b&&window.JSON?!0:!a.arrayDiff(b,["","text","document"])||"browser"===p.mode},return_status_code:function(b){return"browser"===p.mode||!a.arrayDiff(b,[200,404])},select_file:g.capTrue,select_multiple:g.capTrue,
send_binary_string:function(a){return a&&"browser"===p.mode},send_browser_cookies:function(a){return a&&"browser"===p.mode},send_custom_headers:function(a){return a&&"browser"===p.mode},send_multipart:g.capTrue,slice_blob:g.capTrue,stream_upload:function(a){return a&&"browser"===p.mode},summon_file_dialog:!1,upload_filesize:function(b){return 2097152>=a.parseSizeStr(b)||"client"===p.mode},use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}},{access_binary:function(a){return a?"browser":
"client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(b){return a.arrayDiff(b,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(b){return a.arrayDiff(b,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?
"browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(b){return 2097152<=a.parseSizeStr(b)?"client":"browser"}},"client");10>h()&&(this.mode=!1);a.extend(this,{getShim:function(){return c.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return p.getShim().exec(this.uid,a,b,c)},init:function(){var c,f,g;g=this.getShimContainer();a.extend(g.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});
c='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+r.swf_url+'" ';"IE"===b.browser&&(c+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');c+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+r.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+b.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';"IE"===b.browser?(f=document.createElement("div"),
g.appendChild(f),f.outerHTML=c,f=g=null):g.innerHTML=c;s=setTimeout(function(){p&&!p.initialized&&p.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){a.call(p);clearTimeout(s);r=s=a=p=null}}(this.destroy)},l)});return l});d("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(a,b){return a.Blob={slice:function(a,c,d,h){var l=this.getRuntime();0>c?c=Math.max(a.size+c,0):0<c&&(c=Math.min(c,a.size));0>d?
d=Math.max(a.size+d,0):0<d&&(d=Math.min(d,a.size));(a=l.shimExec.call(this,"Blob","slice",c,d,h||""))&&(a=new b(l.uid,a));return a}}});d("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(a){return a.FileInput={init:function(a){this.getRuntime().shimExec.call(this,"FileInput","init",{name:a.name,accept:a.accept,multiple:a.multiple});this.trigger("ready")}}});d("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(a,b){function c(a,
d){switch(d){case "readAsText":return b.atob(a,"utf8");case "readAsBinaryString":return b.atob(a);case "readAsDataURL":return a}return null}var d="";return a.FileReader={read:function(a,b){var k=this.getRuntime();"readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,");this.bind("Progress",function(b,k){k&&(d+=c(k,a))});return k.shimExec.call(this,"FileReader","readAsBase64",b.uid)},getResult:function(){return d},destroy:function(){d=null}}});d("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime",
"moxie/core/utils/Encode"],function(a,b){function c(a,d){switch(d){case "readAsText":return b.atob(a,"utf8");case "readAsBinaryString":return b.atob(a);case "readAsDataURL":return a}return null}return a.FileReaderSync={read:function(a,b){var d;d=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",b.uid);if(!d)return null;"readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,"+d);return c(d,a,b.type)}}});d("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter".split(" "),
function(a,b,c,d,g,h,l){return a.XMLHttpRequest={send:function(a,d){function e(){a.transport=t.mode;t.shimExec.call(v,"XMLHttpRequest","send",a,d)}function g(a,b){t.shimExec.call(v,"XMLHttpRequest","appendBlob",a,b.uid);d=null;e()}function m(a,b){var c=new l;c.bind("TransportingComplete",function(){b(this.result)});c.transport(a.getSource(),a.type,{ruid:t.uid})}var v=this,t=v.getRuntime();b.isEmptyObj(a.headers)||b.each(a.headers,function(a,b){t.shimExec.call(v,"XMLHttpRequest","setRequestHeader",
b,a.toString())});if(d instanceof h){var z;d.each(function(a,b){a instanceof c?z=b:t.shimExec.call(v,"XMLHttpRequest","append",b,a)});if(d.hasBlob()){var A=d.getBlob();A.isDetached()?m(A,function(a){A.destroy();g(z,a)}):g(z,A)}else d=null,e()}else d instanceof c?d.isDetached()?m(d,function(a){d.destroy();d=a.uid;e()}):(d=d.uid,e()):e()},getResponse:function(a){var c,f,l=this.getRuntime();if(f=l.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){f=new d(l.uid,f);if("blob"===a)return f;try{c=
new g;if(~b.inArray(a,["","text"]))return c.readAsText(f);if("json"===a&&window.JSON)return JSON.parse(c.readAsText(f))}finally{f.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});d("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(a,b){return a.Transporter={getAsBlob:function(a){var c=this.getRuntime();return(a=c.shimExec.call(this,
"Transporter","getAsBlob",a))?new b(c.uid,a):null}}});d("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(a,b,c,d,g){return a.Image={loadFromBlob:function(a){function b(a){e.shimExec.call(d,"Image","loadFromBlob",a.uid);d=e=null}var d=this,e=d.getRuntime();if(a.isDetached()){var g=new c;g.bind("TransportingComplete",function(){b(g.result.getSource())});g.transport(a.getSource(),
a.type,{ruid:e.uid})}else b(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(a,b){var c=this.getRuntime(),f=c.shimExec.call(this,"Image","getAsBlob",a,b);return f?new d(c.uid,f):null},getAsDataURL:function(){var a=this.getRuntime().Image.getAsBlob.apply(this,arguments);return a?(new g).readAsDataURL(a):null}}});d("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom",
"moxie/core/Exceptions","moxie/runtime/Runtime"],function(a,b,c,d,g){function h(a){var b=!1,c=null,d,e,f,g,l,k=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(m){var n=navigator.plugins["Silverlight Plug-In"];if(n){d=n.description;"1.0.30226.2"===d&&(d="2.0.30226.2");for(e=d.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(f=a.split(".");4<f.length;)f.pop();do g=parseInt(f[k],10),l=parseInt(e[k],10),k++;while(k<f.length&&g===l);g<=l&&!isNaN(g)&&
(b=!0)}}}catch(B){b=!1}return b}var l={};g.addConstructor("silverlight",function(r){var p=this,s;r=a.extend({xap_url:b.xap_url},r);g.call(this,r,"silverlight",{access_binary:g.capTrue,access_image_binary:g.capTrue,display_media:g.capTrue,do_cors:g.capTrue,drag_and_drop:!1,report_upload_progress:g.capTrue,resize_image:g.capTrue,return_response_headers:function(a){return a&&"client"===p.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(b){return"client"===
p.mode||!a.arrayDiff(b,[200,404])},select_file:g.capTrue,select_multiple:g.capTrue,send_binary_string:g.capTrue,send_browser_cookies:function(a){return a&&"browser"===p.mode},send_custom_headers:function(a){return a&&"client"===p.mode},send_multipart:g.capTrue,slice_blob:g.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:g.capTrue,use_http_method:function(b){return"client"===p.mode||!a.arrayDiff(b,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(b){return a.arrayDiff(b,
[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(b){return a.arrayDiff(b,["GET","POST"])?"client":["client","browser"]}});h("2.0.31005.0")&&"Opera"!==b.browser||(this.mode=!1);a.extend(this,{getShim:function(){return c.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return p.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML=
'<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+r.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+b.global_event_dispatcher+'"/></object>';s=setTimeout(function(){p&&!p.initialized&&p.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR))},
"Windows"!==b.OS?1E4:5E3)},destroy:function(a){return function(){a.call(p);clearTimeout(s);r=s=a=p=null}}(this.destroy)},l)});return l});d("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(a,b,c){return a.Blob=b.extend({},c)});d("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(a){return a.FileInput={init:function(a){this.getRuntime().shimExec.call(this,"FileInput","init",
function(a){for(var b="",c=0;c<a.length;c++)b+=(""!==b?"|":"")+a[c].title+" | *."+a[c].extensions.replace(/,/g,";*.");return b}(a.accept),a.name,a.multiple);this.trigger("ready")}}});d("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(a,b,c){return a.FileDrop={init:function(){var a=this.getRuntime(),d;d=a.getShimContainer();c.addEvent(d,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect=
"copy"},this.uid);c.addEvent(d,"dragenter",function(c){c.preventDefault();b.get(a.uid).dragEnter(c)&&c.stopPropagation()},this.uid);c.addEvent(d,"drop",function(c){c.preventDefault();b.get(a.uid).dragDrop(c)&&c.stopPropagation()},this.uid);return a.shimExec.call(this,"FileDrop","init")}}});d("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(a,b,c){return a.FileReader=b.extend({},c)});d("moxie/runtime/silverlight/file/FileReaderSync",
["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(a,b,c){return a.FileReaderSync=b.extend({},c)});d("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(a,b,c){return a.XMLHttpRequest=b.extend({},c)});d("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],
function(a,b,c){return a.Transporter=b.extend({},c)});d("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(a,b,c){return a.Image=b.extend({},c,{getInfo:function(){var a=["tiff","exif","gps"],c={meta:{}},d=this.getRuntime().shimExec.call(this,"Image","getInfo");d.meta&&b.each(a,function(a){var b=d.meta[a],e,f,h,k;if(b&&b.keys)for(c.meta[a]={},f=0,h=b.keys.length;f<h;f++)if(e=b.keys[f],k=b[e])/^(\d|[1-9]\d+)$/.test(k)?
k=parseInt(k,10):/^\d*\.\d+$/.test(k)&&(k=parseFloat(k)),c.meta[a][e]=k});c.width=parseInt(d.width,10);c.height=parseInt(d.height,10);c.size=parseInt(d.size,10);c.type=d.type;c.name=d.name;return c}})});d("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(a,b,c,d){var g={};c.addConstructor("html4",function(b){var l=this,k=c.capTest,h=c.capTrue;c.call(this,b,"html4",{access_binary:k(window.FileReader||window.File&&
File.getAsDataURL),access_image_binary:!1,display_media:k(g.Image&&(d.can("create_canvas")||d.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:k("Chrome"===d.browser&&28<=d.version||"IE"===d.browser&&10<=d.version),resize_image:function(){return g.Image&&l.can("access_binary")&&d.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(b){return"json"===b&&window.JSON?!0:!!~a.inArray(b,["text","document",""])},return_status_code:function(b){return!a.arrayDiff(b,
[200,404])},select_file:function(){return d.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return l.can("select_file")},summon_file_dialog:k("Firefox"===d.browser&&4<=d.version||"Opera"===d.browser&&12<=d.version||!!~a.inArray(d.browser,["Chrome","Safari"])),upload_filesize:h,use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}});a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(l);
a=l=null}}(this.destroy)});a.extend(this.getShim(),g)});return g});d("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(a,b,c,d,g,h){return a.FileInput=function(){function a(){var g=this,v=g.getRuntime(),t,z,A,w,x;x=b.guid("uid_");t=v.getShimContainer();m&&(z=c.get(m+"_form"))&&b.extend(z.style,{top:"100%"});A=document.createElement("form");A.setAttribute("id",
x+"_form");A.setAttribute("method","post");A.setAttribute("enctype","multipart/form-data");A.setAttribute("encoding","multipart/form-data");b.extend(A.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});w=document.createElement("input");w.setAttribute("id",x);w.setAttribute("type","file");w.setAttribute("name",q.name||"Filedata");w.setAttribute("accept",s.join(","));b.extend(w.style,{fontSize:"999px",opacity:0});A.appendChild(w);t.appendChild(A);b.extend(w.style,
{position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===h.browser&&10>h.version&&b.extend(w.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});w.onchange=function(){var b;this.value&&(b=this.files?this.files[0]:{name:this.value},p=[b],this.onchange=function(){},a.call(g),g.bind("change",function H(){var a=c.get(x),b=c.get(x+"_form"),d;g.unbind("change",H);g.files.length&&a&&b&&(d=g.files[0],a.setAttribute("id",d.uid),b.setAttribute("id",d.uid+"_form"),b.setAttribute("target",
d.uid+"_iframe"))},998),w=A=null,g.trigger("change"))};v.can("summon_file_dialog")&&(v=c.get(q.browse_button),d.removeEvent(v,"click",g.uid),d.addEvent(v,"click",function(a){w&&!w.disabled&&w.click();a.preventDefault()},g.uid));m=x;t=z=v=null}var m,p=[],s=[],q;b.extend(this,{init:function(b){var h=this,k=h.getRuntime(),m;q=b;s=b.accept.mimes||g.extList2mimes(b.accept,k.can("filter_by_extension"));m=k.getShimContainer();(function(){var a,g;a=c.get(b.browse_button);k.can("summon_file_dialog")&&("static"===
c.getStyle(a,"position")&&(a.style.position="relative"),g=parseInt(c.getStyle(a,"z-index"),10)||1,a.style.zIndex=g,m.style.zIndex=g-1);a=k.can("summon_file_dialog")?a:m;d.addEvent(a,"mouseover",function(){h.trigger("mouseenter")},h.uid);d.addEvent(a,"mouseout",function(){h.trigger("mouseleave")},h.uid);d.addEvent(a,"mousedown",function(){h.trigger("mousedown")},h.uid);d.addEvent(c.get(b.container),"mouseup",function(){h.trigger("mouseup")},h.uid);a=null})();a.call(this);m=null;h.trigger({type:"ready",
async:!0})},getFiles:function(){return p},disable:function(a){var b;if(b=c.get(m))b.disabled=!!a},destroy:function(){var a=this.getRuntime(),b=a.getShim(),a=a.getShimContainer();d.removeAllEvents(a,this.uid);d.removeAllEvents(q&&c.get(q.container),this.uid);d.removeAllEvents(q&&c.get(q.browse_button),this.uid);a&&(a.innerHTML="");b.removeInstance(this.uid);m=p=s=q=null}})}});d("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(a,b){return a.FileReader=
b});d("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),function(a,b,c,d,g,h,l,r){return a.XMLHttpRequest=function(){function a(b){var d=this,e,g,l,k=!1;if(u){e=u.id.replace(/_iframe$/,"");if(e=c.get(e+"_form")){g=e.getElementsByTagName("input");for(l=g.length;l--;)switch(g[l].getAttribute("type")){case "hidden":g[l].parentNode.removeChild(g[l]);
break;case "file":k=!0}g=[];k||e.parentNode.removeChild(e);e=null}setTimeout(function(){h.removeEvent(u,"load",d.uid);u.parentNode&&u.parentNode.removeChild(u);var a=d.getRuntime().getShimContainer();a.children.length||a.parentNode.removeChild(a);u=null;b()},1)}}var m,q,u;b.extend(this,{send:function(v,t){var z=this,A=z.getRuntime(),w,x,B,C;m=q=null;if(t instanceof r&&t.hasBlob()){if(C=t.getBlob(),w=C.uid,B=c.get(w),x=c.get(w+"_form"),!x)throw new g.DOMException(g.DOMException.NOT_FOUND_ERR);}else w=
b.guid("uid_"),x=document.createElement("form"),x.setAttribute("id",w+"_form"),x.setAttribute("method",v.method),x.setAttribute("enctype","multipart/form-data"),x.setAttribute("encoding","multipart/form-data"),x.setAttribute("target",w+"_iframe"),A.getShimContainer().appendChild(x);t instanceof r&&t.each(function(a,c){if(a instanceof l)B&&B.setAttribute("name",c);else{var d=document.createElement("input");b.extend(d,{type:"hidden",name:c,value:a});B?x.insertBefore(d,B):x.appendChild(d)}});x.setAttribute("action",
v.url);(function(){var c=A.getShimContainer()||document.body,f=document.createElement("div");f.innerHTML='<iframe id="'+w+'_iframe" name="'+w+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';u=f.firstChild;c.appendChild(u);h.addEvent(u,"load",function(){var c;try{c=u.contentWindow.document||u.contentDocument||window.frames[u.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(c.title)?m=c.title.replace(/^(\d+).*$/,"$1"):(m=200,q=b.trim(c.body.innerHTML),z.trigger({type:"progress",
loaded:q.length,total:q.length}),C&&z.trigger({type:"uploadprogress",loaded:C.size||1025,total:C.size||1025}))}catch(f){if(d.hasSameOrigin(v.url))m=404;else{a.call(z,function(){z.trigger("error")});return}}a.call(z,function(){z.trigger("load")})},z.uid)})();x.submit();z.trigger("loadstart")},getStatus:function(){return m},getResponse:function(a){if("json"===a&&"string"===b.typeOf(q)&&window.JSON)try{return JSON.parse(q.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(c){return null}return q},
abort:function(){var b=this;u&&u.contentWindow&&(u.contentWindow.stop?u.contentWindow.stop():u.contentWindow.document.execCommand?u.contentWindow.document.execCommand("Stop"):u.src="about:blank");a.call(this,function(){b.dispatchEvent("abort")})}})}});d("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(a,b){return a.Image=b});(function(c){for(var d=0;d<c.length;d++){for(var f=b,e=c[d],g=e.split(/[.\/]/),n=0;n<g.length-1;++n)f[g[n]]===a&&(f[g[n]]=
{}),f=f[g[n]];f[g[g.length-1]]=h[e]}})("moxie/core/utils/Basic moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Env moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/file/File moxie/file/FileInput moxie/file/FileDrop moxie/runtime/RuntimeTarget moxie/file/FileReader moxie/core/utils/Url moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/image/Image moxie/core/utils/Events".split(" "))})(this);
(function(){var b={},a=moxie.core.utils.Basic.inArray;(function d(h){var m,k;for(m in h)k=typeof h[m],"object"!==k||~a(m,["Exceptions","Env","Mime"])?"function"===k&&(b[m]=h[m]):d(h[m])})(window.moxie);b.Env=window.moxie.core.utils.Env;b.Mime=window.moxie.core.utils.Mime;b.Exceptions=window.moxie.core.Exceptions;window.mOxie=b;window.o||(window.o=b);return b})();(function(b,a,c){function d(a){function b(a,c,e){var f={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};f[a]?d[f[a]]=c:e||(d[a]=c)}var c=a.required_features,d={};"string"===typeof c?k.each(c.split(/\s*,\s*/),function(a){b(a,!0)}):"object"===typeof c?k.each(c,
function(a,c){b(c,a)}):!0===c&&(a.multipart||(d.send_binary_string=!0),0<a.chunk_size&&(d.slice_blob=!0),a.resize.enabled&&(d.send_binary_string=!0),k.each(a,function(a,c){b(c,!!a,!0)}));return d}var h=b.setTimeout,m={},k={VERSION:"2.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,
IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:a.mimes,ua:a.ua,typeOf:a.typeOf,extend:a.extend,guid:a.guid,get:function(b){var c=[],d;"array"!==a.typeOf(b)&&(b=[b]);for(var h=b.length;h--;)(d=a.get(b[h]))&&c.push(d);return c.length?c:null},each:a.each,getPos:a.getPos,getSize:a.getSize,xmlEncode:function(a){var b={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},c=/[<>&\"\']/g;return a?(""+a).replace(c,function(a){return b[a]?"&"+b[a]+";":a}):a},toArray:a.toArray,inArray:a.inArray,addI18n:a.addI18n,translate:a.translate,
isEmptyObj:a.isEmptyObj,hasClass:a.hasClass,addClass:a.addClass,removeClass:a.removeClass,getStyle:a.getStyle,addEvent:a.addEvent,removeEvent:a.removeEvent,removeAllEvents:a.removeAllEvents,cleanName:function(a){var b,c;c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<c.length;b+=2)a=a.replace(c[b],
c[b+1]);a=a.replace(/\s+/g,"_");return a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(a,b){var c="";k.each(b,function(a,b){c+=(c?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)});c&&(a+=(0<a.indexOf("?")?"&":"?")+c);return a},formatSize:function(a){function b(a,c){return Math.round(a*Math.pow(10,c))/Math.pow(10,c)}if(a===c||/\D/.test(a))return k.translate("N/A");var d=Math.pow(1024,4);return a>d?b(a/d,1)+" "+k.translate("tb"):a>(d/=1024)?b(a/d,1)+" "+k.translate("gb"):a>(d/=1024)?
b(a/d,1)+" "+k.translate("mb"):1024<a?Math.round(a/1024)+" "+k.translate("kb"):a+" "+k.translate("b")},parseSize:a.parseSizeStr,predictRuntime:function(b,c){var d,h;d=new k.Uploader(b);h=a.Runtime.thatCan(d.getOption().required_features,c||b.runtimes);d.destroy();return h},addFileFilter:function(a,b){m[a]=b}};k.addFileFilter("mime_types",function(a,b,c){a.length&&!a.regexp.test(b.name)?(this.trigger("Error",{code:k.FILE_EXTENSION_ERROR,message:k.translate("File extension error."),file:b}),c(!1)):
c(!0)});k.addFileFilter("max_file_size",function(a,b,c){a=k.parseSize(a);void 0!==b.size&&a&&b.size>a?(this.trigger("Error",{code:k.FILE_SIZE_ERROR,message:k.translate("File size error."),file:b}),c(!1)):c(!0)});k.addFileFilter("prevent_duplicates",function(a,b,c){if(a)for(a=this.files.length;a--;)if(b.name===this.files[a].name&&b.size===this.files[a].size){this.trigger("Error",{code:k.FILE_DUPLICATE_ERROR,message:k.translate("Duplicate file error."),file:b});c(!1);return}c(!0)});k.Uploader=function(b){function e(){var a,
b=0,c;if(this.state==k.STARTED){for(c=0;c<E.length;c++)a||E[c].status!=k.QUEUED?b++:(a=E[c],this.trigger("BeforeUpload",a)&&(a.status=k.UPLOADING,this.trigger("UploadFile",a)));b==E.length&&(this.state!==k.STOPPED&&(this.state=k.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",E))}}function g(a){a.percent=0<a.size?Math.ceil(a.loaded/a.size*100):100;n()}function n(){var a,b;F.reset();for(a=0;a<E.length;a++)b=E[a],b.size!==c?(F.size+=b.origSize,F.loaded+=b.loaded*b.origSize/b.size):
F.size=c,b.status==k.DONE?F.uploaded++:b.status==k.FAILED?F.failed++:F.queued++;F.size===c?F.percent=0<E.length?Math.ceil(F.uploaded/E.length*100):0:(F.bytesPerSec=Math.ceil(F.loaded/((+new Date-P||1)/1E3)),F.percent=0<F.size?Math.ceil(F.loaded/F.size*100):0)}function l(){var a=J[0]||O[0];return a?a.getRuntime().uid:!1}function r(b,c){if(b.ruid){var d=a.Runtime.getInfo(b.ruid);if(d)return d.can(c)}return!1}function p(b,c){var d=this,e=0,f=[],g={accept:b.filters.mime_types,runtime_order:b.runtimes,
required_caps:b.required_features,preferred_caps:K,swf_url:b.flash_swf_url,xap_url:b.silverlight_xap_url};k.each(b.runtimes.split(/\s*,\s*/),function(a){b[a]&&(g[a]=b[a])});b.browse_button&&k.each(b.browse_button,function(c){f.push(function(f){var h=new a.FileInput(k.extend({},g,{name:b.file_data_name,multiple:b.multi_selection,container:b.container,browse_button:c}));h.onready=function(){var b=a.Runtime.getInfo(this.ruid);a.extend(d.features,{chunks:b.can("slice_blob"),multipart:b.can("send_multipart"),
multi_selection:b.can("select_multiple")});e++;J.push(this);f()};h.onchange=function(){d.addFile(this.files)};h.bind("mouseenter mouseleave mousedown mouseup",function(d){L||(b.browse_button_hover&&("mouseenter"===d.type?a.addClass(c,b.browse_button_hover):"mouseleave"===d.type&&a.removeClass(c,b.browse_button_hover)),b.browse_button_active&&("mousedown"===d.type?a.addClass(c,b.browse_button_active):"mouseup"===d.type&&a.removeClass(c,b.browse_button_active)))});h.bind("error runtimeerror",function(){h=
null;f()});h.init()})});b.drop_element&&k.each(b.drop_element,function(b){f.push(function(c){var f=new a.FileDrop(k.extend({},g,{drop_zone:b}));f.onready=function(){var b=a.Runtime.getInfo(this.ruid);d.features.dragdrop=b.can("drag_and_drop");e++;O.push(this);c()};f.ondrop=function(){d.addFile(this.files)};f.bind("error runtimeerror",function(){f=null;c()});f.init()})});a.inSeries(f,function(){"function"===typeof c&&c(e)})}function s(b,c,d){var e=new a.Image;try{e.onload=function(){e.downsize(c.width,
c.height,c.crop,c.preserve_headers)},e.onresize=function(){d(this.getAsBlob(b.type,c.quality));this.destroy()},e.onerror=function(){d(b)},e.load(b)}catch(f){d(b)}}function q(b,c,e){function f(a,b,c){var d=y[a];switch(a){case "max_file_size":"max_file_size"===a&&(y.max_file_size=y.filters.max_file_size=b);break;case "chunk_size":if(b=k.parseSize(b))y[a]=b;break;case "filters":"array"===k.typeOf(b)&&(b={mime_types:b});c?k.extend(y.filters,b):y.filters=b;b.mime_types&&(y.filters.mime_types.regexp=function(a){var b=
[];k.each(a,function(a){k.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?b.push("\\.*"):b.push("\\."+a.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})});return new RegExp("("+b.join("|")+")$","i")}(y.filters.mime_types));break;case "resize":c?k.extend(y.resize,b,{enabled:!0}):y.resize=b;break;case "prevent_duplicates":y.prevent_duplicates=y.filters.prevent_duplicates=!!b;break;case "browse_button":case "drop_element":b=k.get(b);case "container":case "runtimes":case "multi_selection":case "flash_swf_url":case "silverlight_xap_url":y[a]=
b;c||(g=!0);break;default:y[a]=b}c||h.trigger("OptionChanged",a,b,d)}var h=this,g=!1;"object"===typeof b?k.each(b,function(a,b){f(b,a,e)}):f(b,c,e);e?(y.required_features=d(k.extend({},y)),K=d(k.extend({},y,{required_features:!0}))):g&&(h.trigger("Destroy"),p.call(h,y,function(b){b?(h.runtime=a.Runtime.getInfo(l()).type,h.trigger("Init",{runtime:h.runtime}),h.trigger("PostInit")):h.trigger("Error",{code:k.INIT_ERROR,message:k.translate("Init error.")})}))}function u(a,b){[].push.apply(E,b);a.trigger("QueueChanged");
a.refresh()}function v(a,b){if(y.unique_names){var c=b.name.match(/\.([^.]+)$/),d="part";c&&(d=c[1]);b.target_name=b.id+"."+d}}function t(b,c){function d(){0<l--?h(e,1E3):(c.loaded=p,b.trigger("Error",{code:k.HTTP_ERROR,message:k.translate("HTTP Error."),file:c,response:D.responseText,status:D.status,responseHeaders:D.getAllResponseHeaders()}))}function e(){var q,s,r,t;c.status!=k.DONE&&c.status!=k.FAILED&&b.state!=k.STOPPED&&(r={name:c.target_name||c.name},g&&m.chunks&&n.size>g?(t=Math.min(g,n.size-
p),q=n.slice(p,p+t)):(t=n.size,q=n),g&&m.chunks&&(b.settings.send_chunk_number?(r.chunk=Math.ceil(p/g),r.chunks=Math.ceil(n.size/g)):(r.offset=p,r.total=n.size)),D=new a.XMLHttpRequest,D.upload&&(D.upload.onprogress=function(a){c.loaded=Math.min(c.size,p+a.loaded);b.trigger("UploadProgress",c)}),D.onload=function(){400<=D.status?d():(l=b.settings.max_retries,t<n.size?(q.destroy(),p+=t,c.loaded=Math.min(p,n.size),b.trigger("ChunkUploaded",c,{offset:c.loaded,total:n.size,response:D.responseText,status:D.status,
responseHeaders:D.getAllResponseHeaders()}),"Android Browser"===a.Env.browser&&b.trigger("UploadProgress",c)):c.loaded=c.size,q=s=null,!p||p>=n.size?(c.size!=c.origSize&&(n.destroy(),n=null),b.trigger("UploadProgress",c),c.status=k.DONE,b.trigger("FileUploaded",c,{response:D.responseText,status:D.status,responseHeaders:D.getAllResponseHeaders()})):h(e,1))},D.onerror=function(){d()},D.onloadend=function(){this.destroy();D=null},b.settings.multipart&&m.multipart?(r.name=c.target_name||c.name,D.open("post",
f,!0),k.each(b.settings.headers,function(a,b){D.setRequestHeader(b,a)}),s=new a.FormData,k.each(k.extend(r,b.settings.multipart_params),function(a,b){s.append(b,a)}),s.append(b.settings.file_data_name,q),D.send(s,{runtime_order:b.settings.runtimes,required_caps:b.settings.required_features,preferred_caps:K,swf_url:b.settings.flash_swf_url,xap_url:b.settings.silverlight_xap_url})):(f=k.buildUrl(b.settings.url,k.extend(r,b.settings.multipart_params)),D.open("post",f,!0),D.setRequestHeader("Content-Type",
"application/octet-stream"),k.each(b.settings.headers,function(a,b){D.setRequestHeader(b,a)}),D.send(q,{runtime_order:b.settings.runtimes,required_caps:b.settings.required_features,preferred_caps:K,swf_url:b.settings.flash_swf_url,xap_url:b.settings.silverlight_xap_url})))}var f=b.settings.url,g=b.settings.chunk_size,l=b.settings.max_retries,m=b.features,p=0,n;c.loaded&&(p=c.loaded=g*Math.floor(c.loaded/g));n=c.getSource();b.settings.resize.enabled&&r(n,"send_binary_string")&&~a.inArray(n.type,["image/jpeg",
"image/png"])?s.call(this,n,b.settings.resize,function(a){n=a;c.size=a.size;e()}):e()}function z(a,b){g(b)}function A(a){if(a.state==k.STARTED)P=+new Date;else if(a.state==k.STOPPED)for(var b=a.files.length-1;0<=b;b--)a.files[b].status==k.UPLOADING&&(a.files[b].status=k.QUEUED,n())}function w(){D&&D.abort()}function x(a){n();h(function(){e.call(a)},1)}function B(a,b){b.file&&(b.file.status=k.FAILED,g(b.file),a.state==k.STARTED&&(a.trigger("CancelUpload"),h(function(){e.call(a)},1)))}function C(a){a.stop();
k.each(E,function(a){a.destroy()});E=[];J.length&&(k.each(J,function(a){a.destroy()}),J=[]);O.length&&(k.each(O,function(a){a.destroy()}),O=[]);K={};L=!1;P=D=null;F.reset()}var H=k.guid(),y,E=[],K={},J=[],O=[],P,F,L=!1,D;y={runtimes:a.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},
send_chunk_number:!0};q.call(this,b,null,!0);F=new k.QueueProgress;k.extend(this,{id:H,uid:H,state:k.STOPPED,features:{},runtime:null,files:E,settings:y,total:F,init:function(){var b=this;"function"==typeof y.preinit?y.preinit(b):k.each(y.preinit,function(a,c){b.bind(c,a)});y.browse_button&&y.url?(this.bind("FilesAdded",u),this.bind("CancelUpload",w),this.bind("BeforeUpload",v),this.bind("UploadFile",t),this.bind("UploadProgress",z),this.bind("StateChanged",A),this.bind("QueueChanged",n),this.bind("Error",
B),this.bind("FileUploaded",x),this.bind("Destroy",C),p.call(this,y,function(c){"function"==typeof y.init?y.init(b):k.each(y.init,function(a,c){b.bind(c,a)});c?(b.runtime=a.Runtime.getInfo(l()).type,b.trigger("Init",{runtime:b.runtime}),b.trigger("PostInit")):b.trigger("Error",{code:k.INIT_ERROR,message:k.translate("Init error.")})})):this.trigger("Error",{code:k.INIT_ERROR,message:k.translate("Init error.")})},setOption:function(a,b){q.call(this,a,b,!this.runtime)},getOption:function(a){return a?
y[a]:y},refresh:function(){J.length&&k.each(J,function(a){a.trigger("Refresh")});this.trigger("Refresh")},start:function(){this.state!=k.STARTED&&(this.state=k.STARTED,this.trigger("StateChanged"),e.call(this))},stop:function(){this.state!=k.STOPPED&&(this.state=k.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(a){L=a!==c?a:!0;J.length&&k.each(J,function(a){a.disable(L)});this.trigger("DisableBrowse",L)},getFile:function(a){var b;for(b=E.length-1;0<=b;b--)if(E[b].id===
a)return E[b]},addFile:function(b,c){function d(b,c){var e=[];a.each(f.settings.filters,function(a,c){m[c]&&e.push(function(d){m[c].call(f,a,b,function(a){d(!a)})})});a.inSeries(e,c)}function e(b){var l=a.typeOf(b);if(b instanceof a.File){if(!b.ruid&&!b.isDetached()){if(!n)return!1;b.ruid=n;b.connectRuntime(n)}e(new k.File(b))}else b instanceof a.Blob?(e(b.getSource()),b.destroy()):b instanceof k.File?(c&&(b.name=c),g.push(function(a){d(b,function(c){c||(p.push(b),f.trigger("FileFiltered",b));h(a,
1)})})):-1!==a.inArray(l,["file","blob"])?e(new a.File(null,b)):"node"===l&&"filelist"===a.typeOf(b.files)?a.each(b.files,e):"array"===l&&(c=null,a.each(b,e))}var f=this,g=[],p=[],n;n=l();e(b);g.length&&a.inSeries(g,function(){p.length&&f.trigger("FilesAdded",p)})},removeFile:function(a){a="string"===typeof a?a:a.id;for(var b=E.length-1;0<=b;b--)if(E[b].id===a)return this.splice(b,1)[0]},splice:function(a,b){var d=E.splice(a===c?0:a,b===c?E.length:b),e=!1;this.state==k.STARTED&&(e=!0,this.stop());
this.trigger("FilesRemoved",d);k.each(d,function(a){a.destroy()});this.trigger("QueueChanged");this.refresh();e&&this.start();return d},bind:function(a,b,c){var d=this;k.Uploader.prototype.bind.call(this,a,function(){var a=[].slice.call(arguments);a.splice(0,1,d);return b.apply(this,a)},0,c)},destroy:function(){this.trigger("Destroy");y=F=null;this.unbindAll()}})};k.Uploader.prototype=a.EventTarget.instance;k.File=function(){var b={};return function(c){k.extend(this,{id:k.guid(),name:c.name||c.fileName,
type:c.type||"",size:c.size||c.fileSize,origSize:c.size||c.fileSize,loaded:0,percent:0,status:k.QUEUED,lastModifiedDate:c.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var b=this.getSource().getSource();return-1!==a.inArray(a.typeOf(b),["blob","file"])?b:null},getSource:function(){return b[this.id]?b[this.id]:null},destroy:function(){var a=this.getSource();a&&(a.destroy(),delete b[this.id])}});b[this.id]=c}}();k.QueueProgress=function(){var a=this;a.size=0;a.loaded=0;a.uploaded=
0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}};b.plupload=k})(window,mOxie);(function(b,a){function c(a){return plupload.translate(a)||a}function d(a,d){d.contents().each(function(a,c){c=b(c);c.is(".plupload")||c.remove()});d.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+a+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+c("Select files")+'</div><div class="plupload_header_text">'+c("Add files to queue and click upload.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+
c("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+c("Status")+'</span></div><div class="plupload_file_size">'+c("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+a+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add" id="'+a+'_browse">'+c("Add")+'</a><a href="#" class="plupload_button plupload_start">'+
c("Upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+
a+'_count" name="'+a+'_count" value="0" /></div>')}var h={};b.fn.pluploadQueue=function(m){return m?(this.each(function(){function k(a){var c;a.status==plupload.DONE&&(c="plupload_done");a.status==plupload.FAILED&&(c="plupload_failed");a.status==plupload.QUEUED&&(c="plupload_delete");a.status==plupload.UPLOADING&&(c="plupload_uploading");c=b("#"+a.id).attr("class",c).find("a").css("display","block");a.hint&&c.attr("title",a.hint)}function f(){b("span.plupload_total_status",n).html(g.total.percent+
"%");b("div.plupload_progress_bar",n).css("width",g.total.percent+"%");b("span.plupload_upload_status",n).html(a.sprintf(c("Uploaded %d/%d files"),g.total.uploaded,g.files.length))}function e(){var d=b("ul.plupload_filelist",n).html(""),e=0,h;b.each(g.files,function(a,c){h="";c.status==plupload.DONE&&(c.target_name&&(h+='<input type="hidden" name="'+l+"_"+e+'_tmpname" value="'+plupload.xmlEncode(c.target_name)+'" />'),h+='<input type="hidden" name="'+l+"_"+e+'_name" value="'+plupload.xmlEncode(c.name)+
'" />',h+='<input type="hidden" name="'+l+"_"+e+'_status" value="'+(c.status==plupload.DONE?"done":"failed")+'" />',e++,b("#"+l+"_count").val(e));d.append('<li id="'+c.id+'"><div class="plupload_file_name"><span>'+c.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+c.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(c.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+h+"</li>");k(c);b("#"+c.id+".plupload_delete a").click(function(a){b("#"+
c.id).remove();g.removeFile(c);a.preventDefault()})});b("span.plupload_total_file_size",n).html(plupload.formatSize(g.total.size));0===g.total.queued?b("span.plupload_add_text",n).html(c("Add Files")):b("span.plupload_add_text",n).html(a.sprintf(c("%d files queued"),g.total.queued));b("a.plupload_start",n).toggleClass("plupload_disabled",g.files.length==g.total.uploaded+g.total.failed);d[0].scrollTop=d[0].scrollHeight;f();!g.files.length&&g.features.dragdrop&&g.settings.dragdrop&&b("#"+l+"_filelist").append('<li class="plupload_droptext">'+
c("Drag files here.")+"</li>")}var g,n,l,r;n=b(this);l=n.attr("id");l||(l=plupload.guid(),n.attr("id",l));r=n.html();d(l,n);m=b.extend({dragdrop:!0,browse_button:l+"_browse",container:l},m);m.dragdrop&&(m.drop_element=l+"_filelist");g=new plupload.Uploader(m);h[l]=g;g.bind("UploadFile",function(a,c){b("#"+c.id).addClass("plupload_current_file")});g.bind("Init",function(a,c){if(!m.unique_names&&m.rename)n.on("click","#"+l+"_filelist div.plupload_file_name span",function(c){var d=b(c.target),e,f,h=
"";e=a.getFile(d.parents("li")[0].id);f=e.name;if(c=/^(.+)(\.[^.]+)$/.exec(f))f=c[1],h=c[2];d.hide().after('<input type="text" />');d.next().val(f).focus().blur(function(){d.show().next().remove()}).keydown(function(a){var c=b(this);13==a.keyCode&&(a.preventDefault(),e.name=c.val()+h,d.html(e.name),c.blur())})});b("#"+l+"_container").attr("title","Using runtime: "+c.runtime);b("a.plupload_start",n).click(function(a){b(this).hasClass("plupload_disabled")||g.start();a.preventDefault()});b("a.plupload_stop",
n).click(function(a){a.preventDefault();g.stop()});b("a.plupload_start",n).addClass("plupload_disabled")});g.bind("Error",function(a,d){var e=d.file,f;e&&(f=d.message,d.details&&(f+=" ("+d.details+")"),d.code==plupload.FILE_SIZE_ERROR&&alert(c("Error: File too large:")+" "+e.name),d.code==plupload.FILE_EXTENSION_ERROR&&alert(c("Error: Invalid file extension:")+" "+e.name),e.hint=f,b("#"+e.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",f));d.code===plupload.INIT_ERROR&&
setTimeout(function(){delete h[l];g.destroy();n.html(r);g=n=r=null},1)});g.bind("PostInit",function(a){a.settings.dragdrop&&a.features.dragdrop&&b("#"+l+"_filelist").append('<li class="plupload_droptext">'+c("Drag files here.")+"</li>")});g.init();g.bind("StateChanged",function(){g.state===plupload.STARTED?(b("li.plupload_delete a,div.plupload_buttons",n).hide(),b("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",n).css("display","block"),b("span.plupload_upload_status",n).html("Uploaded "+
g.total.uploaded+"/"+g.files.length+" files"),m.multiple_queues&&b("span.plupload_total_status,span.plupload_total_file_size",n).show()):(e(),b("a.plupload_stop,div.plupload_progress",n).hide(),b("a.plupload_delete",n).css("display","block"),m.multiple_queues&&g.total.uploaded+g.total.failed==g.files.length&&(b(".plupload_buttons,.plupload_upload_status",n).css("display","inline"),b(".plupload_start",n).addClass("plupload_disabled"),b("span.plupload_total_status,span.plupload_total_file_size",n).hide()))});
g.bind("FilesAdded",e);g.bind("FilesRemoved",function(){var a=b("#"+l+"_filelist").scrollTop();e();b("#"+l+"_filelist").scrollTop(a)});g.bind("FileUploaded",function(a,b){k(b)});g.bind("UploadProgress",function(a,c){b("#"+c.id+" div.plupload_file_status",n).html(c.percent+"%");k(c);f()});m.setup&&m.setup(g)}),this):h[b(this[0]).attr("id")]}})(jQuery,mOxie);(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):b(window.jQuery)})(function(b){var a=0;b.ajaxTransport("iframe",function(c){if(c.async){var d=c.initialIframeSrc||"javascript:false;",h,m,k;return{send:function(f,e){h=b('<form style="display:none;"></form>');h.attr("accept-charset",c.formAcceptCharset);k=/\?/.test(c.url)?"&":"?";"DELETE"===c.type?(c.url=c.url+k+"_method=DELETE",c.type="POST"):"PUT"===c.type?(c.url=c.url+k+"_method=PUT",c.type="POST"):"PATCH"===c.type&&(c.url=
c.url+k+"_method=PATCH",c.type="POST");a+=1;m=b('<iframe src="'+d+'" name="iframe-transport-'+a+'"></iframe>').bind("load",function(){var a,f=b.isArray(c.paramName)?c.paramName:[c.paramName];m.unbind("load").bind("load",function(){var a;try{if(a=m.contents(),!a.length||!a[0].firstChild)throw Error();}catch(c){a=void 0}e(200,"success",{iframe:a});b('<iframe src="'+d+'"></iframe>').appendTo(h);window.setTimeout(function(){h.remove()},0)});h.prop("target",m.prop("name")).prop("action",c.url).prop("method",
c.type);c.formData&&b.each(c.formData,function(a,c){b('<input type="hidden"/>').prop("name",c.name).val(c.value).appendTo(h)});c.fileInput&&c.fileInput.length&&"POST"===c.type&&(a=c.fileInput.clone(),c.fileInput.after(function(b){return a[b]}),c.paramName&&c.fileInput.each(function(a){b(this).prop("name",f[a]||c.paramName)}),h.append(c.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),c.fileInput.removeAttr("form"));h.submit();a&&a.length&&c.fileInput.each(function(c,
d){var e=b(a[c]);b(d).prop("name",e.prop("name")).attr("form",e.attr("form"));e.replaceWith(d)})});h.append(m).appendTo(document.body)},abort:function(){m&&m.unbind("load").prop("src",d);h&&h.remove()}}}});b.ajaxSetup({converters:{"iframe text":function(a){return a&&b(a[0].body).text()},"iframe json":function(a){return a&&b.parseJSON(b(a[0].body).text())},"iframe html":function(a){return a&&b(a[0].body).html()},"iframe xml":function(a){return(a=a&&a[0])&&b.isXMLDoc(a)?a:b.parseXML(a.XMLDocument&&
a.XMLDocument.xml||b(a.body).html())},"iframe script":function(a){return a&&b.globalEval(b(a[0].body).text())}}})});(function(b){"function"===typeof define&&define.amd?define(["jquery","jquery.ui.widget"],b):b(window.jQuery)})(function(b){b.support.fileInput=!(/(Android (1\.[0156]|2\.[01]))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.[05]|3\.0))/.test(window.navigator.userAgent)||b('<input type="file">').prop("disabled"));b.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader);b.support.xhrFormDataFileUpload=!!window.FormData;b.support.blobSlice=
window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);b.widget("blueimp.fileupload",{options:{dropZone:b(document),pasteZone:b(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,
uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(a,c){a=this.messages[a]||a.toString();c&&b.each(c,function(b,c){a=a.replace("{"+b+"}",c)});return a},formData:function(a){return a.serializeArray()},add:function(a,c){if(a.isDefaultPrevented())return!1;(c.autoUpload||!1!==c.autoUpload&&b(this).fileupload("option","autoUpload"))&&c.process().done(function(){c.submit()})},processData:!1,
contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:b.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.bitrate=this.loaded=0;this.getBitrate=function(a,b,d){var h=a-this.timestamp;if(!this.bitrate||!d||h>d)this.bitrate=1E3/h*(b-this.loaded)*8,this.loaded=b,this.timestamp=a;return this.bitrate}},
_isXHRUpload:function(a){return!a.forceIframeTransport&&(!a.multipart&&b.support.xhrFileUpload||b.support.xhrFormDataFileUpload)},_getFormData:function(a){var c;return"function"===b.type(a.formData)?a.formData(a.form):b.isArray(a.formData)?a.formData:"object"===b.type(a.formData)?(c=[],b.each(a.formData,function(a,b){c.push({name:a,value:b})}),c):[]},_getTotal:function(a){var c=0;b.each(a,function(a,b){c+=b.size||1});return c},_initProgressObject:function(a){var c={loaded:0,total:0,bitrate:0};a._progress?
b.extend(a._progress,c):a._progress=c},_initResponseObject:function(a){var b;if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&delete a._response[b];else a._response={}},_onProgress:function(a,c){if(a.lengthComputable){var d=Date.now?Date.now():(new Date).getTime(),h;c._time&&c.progressInterval&&d-c._time<c.progressInterval&&a.loaded!==a.total||(c._time=d,h=Math.floor(a.loaded/a.total*(c.chunkSize||c._progress.total))+(c.uploadedBytes||0),this._progress.loaded+=h-c._progress.loaded,
this._progress.bitrate=this._bitrateTimer.getBitrate(d,this._progress.loaded,c.bitrateInterval),c._progress.loaded=c.loaded=h,c._progress.bitrate=c.bitrate=c._bitrateTimer.getBitrate(d,h,c.bitrateInterval),this._trigger("progress",b.Event("progress",{delegatedEvent:a}),c),this._trigger("progressall",b.Event("progressall",{delegatedEvent:a}),this._progress))}},_initProgressListener:function(a){var c=this,d=a.xhr?a.xhr():b.ajaxSettings.xhr();d.upload&&(b(d.upload).bind("progress",function(b){var d=
b.originalEvent;b.lengthComputable=d.lengthComputable;b.loaded=d.loaded;b.total=d.total;c._onProgress(b,a)}),a.xhr=function(){return d})},_isInstanceOf:function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(a){var c=this,d,h=a.files[0],m=a.multipart||!b.support.xhrFileUpload,k="array"===b.type(a.paramName)?a.paramName[0]:a.paramName;a.headers=b.extend({},a.headers);a.contentRange&&(a.headers["Content-Range"]=a.contentRange);m&&!a.blob&&this._isInstanceOf("File",
h)||(a.headers["Content-Disposition"]='attachment; filename="'+encodeURI(h.name)+'"');m?b.support.xhrFormDataFileUpload&&(a.postMessage?(d=this._getFormData(a),a.blob?d.push({name:k,value:a.blob}):b.each(a.files,function(c,e){d.push({name:"array"===b.type(a.paramName)&&a.paramName[c]||k,value:e})})):(c._isInstanceOf("FormData",a.formData)?d=a.formData:(d=new FormData,b.each(this._getFormData(a),function(a,b){d.append(b.name,b.value)})),a.blob?d.append(k,a.blob,h.name):b.each(a.files,function(f,e){(c._isInstanceOf("File",
e)||c._isInstanceOf("Blob",e))&&d.append("array"===b.type(a.paramName)&&a.paramName[f]||k,e,e.uploadName||e.name)})),a.data=d):(a.contentType=h.type||"application/octet-stream",a.data=a.blob||h);a.blob=null},_initIframeSettings:function(a){var c=b("<a></a>").prop("href",a.url).prop("host");a.dataType="iframe "+(a.dataType||"");a.formData=this._getFormData(a);a.redirect&&c&&c!==location.host&&a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?
(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(a){var c=b(a.fileInput),d=a.paramName;d?b.isArray(d)||(d=[d]):(d=[],c.each(function(){for(var a=b(this),c=a.prop("name")||"files[]",a=(a.prop("files")||[1]).length;a;)d.push(c),a-=1}),d.length||(d=[c.prop("name")||"files[]"]));return d},_initFormSettings:function(a){a.form&&a.form.length||(a.form=b(a.fileInput.prop("form")),
a.form.length||(a.form=b(this.options.fileInput.prop("form"))));a.paramName=this._getParamName(a);a.url||(a.url=a.form.prop("action")||location.href);a.type=(a.type||"string"===b.type(a.form.prop("method"))&&a.form.prop("method")||"").toUpperCase();"POST"!==a.type&&"PUT"!==a.type&&"PATCH"!==a.type&&(a.type="POST");a.formAcceptCharset||(a.formAcceptCharset=a.form.attr("accept-charset"))},_getAJAXSettings:function(a){a=b.extend({},this.options,a);this._initFormSettings(a);this._initDataSettings(a);
return a},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?"rejected":"pending"},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(a,c,d){var h=b.Deferred(),m=h.promise();c=c||this.options.context||m;!0===a?h.resolveWith(c,d):!1===a&&h.rejectWith(c,d);m.abort=h.promise;return this._enhancePromise(m)},_addConvenienceMethods:function(a,c){var d=this,h=function(a){return b.Deferred().resolveWith(d,
a).promise()};c.process=function(a,k){if(a||k)c._processQueue=this._processQueue=(this._processQueue||h([this])).pipe(function(){return c.errorThrown?b.Deferred().rejectWith(d,[c]).promise():h(arguments)}).pipe(a,k);return this._processQueue||h([this])};c.submit=function(){"pending"!==this.state()&&(c.jqXHR=this.jqXHR=!1!==d._trigger("submit",b.Event("submit",{delegatedEvent:a}),this)&&d._onSend(a,this));return this.jqXHR||d._getXHRPromise()};c.abort=function(){if(this.jqXHR)return this.jqXHR.abort();
this.errorThrown="abort";d._trigger("fail",null,this);return d._getXHRPromise(!1)};c.state=function(){if(this.jqXHR)return d._getDeferredState(this.jqXHR);if(this._processQueue)return d._getDeferredState(this._processQueue)};c.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===d._getDeferredState(this._processQueue)};c.progress=function(){return this._progress};c.response=function(){return this._response}},_getUploadedBytes:function(a){return(a=(a=(a=a.getResponseHeader("Range"))&&
a.split("-"))&&1<a.length&&parseInt(a[1],10))&&a+1},_chunkedUpload:function(a,c){a.uploadedBytes=a.uploadedBytes||0;var d=this,h=a.files[0],m=h.size,k=a.uploadedBytes,f=a.maxChunkSize||m,e=this._blobSlice,g=b.Deferred(),n=g.promise(),l,r;if(!(this._isXHRUpload(a)&&e&&(k||f<m))||a.data)return!1;if(c)return!0;if(k>=m)return h.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",h.error]);r=function(){var c=b.extend({},a),n=c._progress.loaded;c.blob=e.call(h,k,k+f,h.type);c.chunkSize=
c.blob.size;c.contentRange="bytes "+k+"-"+(k+c.chunkSize-1)+"/"+m;d._initXHRData(c);d._initProgressListener(c);l=(!1!==d._trigger("chunksend",null,c)&&b.ajax(c)||d._getXHRPromise(!1,c.context)).done(function(e,f,h){k=d._getUploadedBytes(h)||k+c.chunkSize;n+c.chunkSize-c._progress.loaded&&d._onProgress(b.Event("progress",{lengthComputable:!0,loaded:k-c.uploadedBytes,total:k-c.uploadedBytes}),c);a.uploadedBytes=c.uploadedBytes=k;c.result=e;c.textStatus=f;c.jqXHR=h;d._trigger("chunkdone",null,c);d._trigger("chunkalways",
null,c);k<m?r():g.resolveWith(c.context,[e,f,h])}).fail(function(a,b,e){c.jqXHR=a;c.textStatus=b;c.errorThrown=e;d._trigger("chunkfail",null,c);d._trigger("chunkalways",null,c);g.rejectWith(c.context,[a,b,e])})};this._enhancePromise(n);n.abort=function(){return l.abort()};r();return n},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(b);this._initProgressObject(b);
b._progress.loaded=b.loaded=b.uploadedBytes||0;b._progress.total=b.total=this._getTotal(b.files)||1;b._progress.bitrate=b.bitrate=0;this._active+=1;this._progress.loaded+=b.loaded;this._progress.total+=b.total},_onDone:function(a,c,d,h){var m=h._progress.total,k=h._response;h._progress.loaded<m&&this._onProgress(b.Event("progress",{lengthComputable:!0,loaded:m,total:m}),h);k.result=h.result=a;k.textStatus=h.textStatus=c;k.jqXHR=h.jqXHR=d;this._trigger("done",null,h)},_onFail:function(a,b,d,h){var m=
h._response;h.recalculateProgress&&(this._progress.loaded-=h._progress.loaded,this._progress.total-=h._progress.total);m.jqXHR=h.jqXHR=a;m.textStatus=h.textStatus=b;m.errorThrown=h.errorThrown=d;this._trigger("fail",null,h)},_onAlways:function(a,b,d,h){this._trigger("always",null,h)},_onSend:function(a,c){c.submit||this._addConvenienceMethods(a,c);var d=this,h,m,k,f,e=d._getAJAXSettings(c),g=function(){d._sending+=1;e._bitrateTimer=new d._BitrateTimer;return h=h||((m||!1===d._trigger("send",b.Event("send",
{delegatedEvent:a}),e))&&d._getXHRPromise(!1,e.context,m)||d._chunkedUpload(e)||b.ajax(e)).done(function(a,b,c){d._onDone(a,b,c,e)}).fail(function(a,b,c){d._onFail(a,b,c,e)}).always(function(a,b,c){d._onAlways(a,b,c,e);d._sending-=1;d._active-=1;if(e.limitConcurrentUploads&&e.limitConcurrentUploads>d._sending)for(a=d._slots.shift();a;){if("pending"===d._getDeferredState(a)){a.resolve();break}a=d._slots.shift()}0===d._active&&d._trigger("stop")})};this._beforeSend(a,e);return this.options.sequentialUploads||
this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(1<this.options.limitConcurrentUploads?(k=b.Deferred(),this._slots.push(k),f=k.pipe(g)):f=this._sequence=this._sequence.pipe(g,g),f.abort=function(){m=[void 0,"abort","abort"];return h?h.abort():(k&&k.rejectWith(e.context,m),g())},this._enhancePromise(f)):g()},_onAdd:function(a,c){var d=this,h=!0,m=b.extend({},this.options,c),k=c.files,f=k.length,e=m.limitMultiFileUploads,g=m.limitMultiFileUploadSize,n=m.limitMultiFileUploadSizeOverhead,
l=0,r=this._getParamName(m),p,s,q=0;!g||f&&void 0!==k[0].size||(g=void 0);if((m.singleFileUploads||e||g)&&this._isXHRUpload(m))if(m.singleFileUploads||g||!e)if(!m.singleFileUploads&&g)for(s=[],p=[],m=0;m<f;m+=1){if(l+=k[m].size+n,m+1===f||l+k[m+1].size+n>g||e&&m+1-q>=e)s.push(k.slice(q,m+1)),l=r.slice(q,m+1),l.length||(l=r),p.push(l),q=m+1,l=0}else p=r;else for(s=[],p=[],m=0;m<f;m+=e)s.push(k.slice(m,m+e)),l=r.slice(m,m+e),l.length||(l=r),p.push(l);else s=[k],p=[r];c.originalFiles=k;b.each(s||k,function(e,
f){var g=b.extend({},c);g.files=s?f:[f];g.paramName=p[e];d._initResponseObject(g);d._initProgressObject(g);d._addConvenienceMethods(a,g);return h=d._trigger("add",b.Event("add",{delegatedEvent:a}),g)});return h},_replaceFileInput:function(a){var c=a.clone(!0);b("<form></form>").append(c)[0].reset();a.after(c).detach();b.cleanData(a.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(b,h){return h===a[0]?c[0]:h});a[0]===this.element[0]&&(this.element=c)},_handleFileTreeEntry:function(a,
c){var d=this,h=b.Deferred(),m=function(b){b&&!b.entry&&(b.entry=a);h.resolve([b])},k;c=c||"";a.isFile?a._file?(a._file.relativePath=c,h.resolve(a._file)):a.file(function(a){a.relativePath=c;h.resolve(a)},m):a.isDirectory?(k=a.createReader(),k.readEntries(function(b){d._handleFileTreeEntries(b,c+a.name+"/").done(function(a){h.resolve(a)}).fail(m)},m)):h.resolve([]);return h.promise()},_handleFileTreeEntries:function(a,c){var d=this;return b.when.apply(b,b.map(a,function(a){return d._handleFileTreeEntry(a,
c)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(a){a=a||{};var c=a.items;return c&&c.length&&(c[0].webkitGetAsEntry||c[0].getAsEntry)?this._handleFileTreeEntries(b.map(c,function(a){var b;if(a.webkitGetAsEntry){if(b=a.webkitGetAsEntry())b._file=a.getAsFile();return b}return a.getAsEntry()})):b.Deferred().resolve(b.makeArray(a.files)).promise()},_getSingleFileInputFiles:function(a){a=b(a);var c=a.prop("webkitEntries")||a.prop("entries");if(c&&c.length)return this._handleFileTreeEntries(c);
c=b.makeArray(a.prop("files"));if(c.length)void 0===c[0].name&&c[0].fileName&&b.each(c,function(a,b){b.name=b.fileName;b.size=b.fileSize});else{a=a.prop("value");if(!a)return b.Deferred().resolve([]).promise();c=[{name:a.replace(/^.*\\/,"")}]}return b.Deferred().resolve(c).promise()},_getFileInputFiles:function(a){return a instanceof b&&1!==a.length?b.when.apply(b,b.map(a,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(a)},
_onChange:function(a){var c=this,d={fileInput:b(a.target),form:b(a.target.form)};this._getFileInputFiles(d.fileInput).always(function(h){d.files=h;c.options.replaceFileInput&&c._replaceFileInput(d.fileInput);!1!==c._trigger("change",b.Event("change",{delegatedEvent:a}),d)&&c._onAdd(a,d)})},_onPaste:function(a){var c=a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.items,d={files:[]};c&&c.length&&(b.each(c,function(a,b){var c=b.getAsFile&&b.getAsFile();c&&d.files.push(c)}),
!1!==this._trigger("paste",b.Event("paste",{delegatedEvent:a}),d)&&this._onAdd(a,d))},_onDrop:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var c=this,d=a.dataTransfer,h={};d&&d.files&&d.files.length&&(a.preventDefault(),this._getDroppedFiles(d).always(function(d){h.files=d;!1!==c._trigger("drop",b.Event("drop",{delegatedEvent:a}),h)&&c._onAdd(a,h)}))},_onDragOver:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var c=a.dataTransfer;c&&-1!==b.inArray("Files",
c.types)&&!1!==this._trigger("dragover",b.Event("dragover",{delegatedEvent:a}))&&(a.preventDefault(),c.dropEffect="copy")},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste}));b.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,
"paste");this._off(this.options.fileInput,"change")},_setOption:function(a,c){var d=-1!==b.inArray(a,this._specialOptions);d&&this._destroyEventHandlers();this._super(a,c);d&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var a=this.options;void 0===a.fileInput?a.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):a.fileInput instanceof b||(a.fileInput=b(a.fileInput));a.dropZone instanceof b||(a.dropZone=b(a.dropZone));
a.pasteZone instanceof b||(a.pasteZone=b(a.pasteZone))},_getRegExp:function(a){a=a.split("/");var b=a.pop();a.shift();return new RegExp(a.join("/"),b)},_isRegExpOption:function(a,c){return"url"!==a&&"string"===b.type(c)&&/^\/.*\/[igm]{0,3}$/.test(c)},_initDataAttributes:function(){var a=this,c=this.options;b.each(b(this.element[0].cloneNode(!1)).data(),function(b,h){a._isRegExpOption(b,h)&&(h=a._getRegExp(h));c[b]=h})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=
[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(a){var c=this;a&&!this.options.disabled&&(a.fileInput&&!a.files?this._getFileInputFiles(a.fileInput).always(function(b){a.files=b;c._onAdd(null,a)}):(a.files=b.makeArray(a.files),this._onAdd(null,a)))},send:function(a){if(a&&!this.options.disabled){if(a.fileInput&&!a.files){var c=
this,d=b.Deferred(),h=d.promise(),m,k;h.abort=function(){k=!0;if(m)return m.abort();d.reject(null,"abort","abort");return h};this._getFileInputFiles(a.fileInput).always(function(b){k||(b.length?(a.files=b,m=c._onSend(null,a).then(function(a,b,c){d.resolve(a,b,c)},function(a,b,c){d.reject(a,b,c)})):d.reject())});return this._enhancePromise(h)}a.files=b.makeArray(a.files);if(a.files.length)return this._onSend(null,a)}return this._getXHRPromise(!1,a&&a.context)}})});$(document).ready(function(){ab.connect("ws://demo.mpdtunes.com",function(a){sess=a;sess.subscribe("radio/station/"+usersStationId,onUpdate)},function(a,b){});$("#player").jPlayer({errorAlerts:!1,warningAlerts:!1,preload:"auto",swfPath:"includes/js",ready:function(){},progress:function(a){seekPercent=a.jPlayer.status.seekPercent;null==seekPercent&&(seekPercent=100,consoleLog("seekPercent was null, so setting it to ",seekPercent));if(100>seekPercent||!load_progress_complete)updateLoadProgressDisplay(seekPercent),
100==seekPercent&&(load_progress_complete=!0,updateLoadProgressDisplay(100))},stalled:function(a){playing&&(started&&(current_track_position=elapsed,waiting=!0,pauseProgress()),$.mobile.loading("show",theme.bars,"Stalled"))},waiting:function(a){playing&&started&&(current_track_position=elapsed,waiting=!0,pauseProgress());consoleLog("Inside waiting event handler",a);$.mobile.loading("show",theme.bars,"Waiting")},abort:function(a){$.mobile.loading("show",theme.bars,"Aborting")},error:function(a){consoleLog("Inside error event handler for player",
a.jPlayer.error)},warning:function(a){consoleLog("Inside warning event handler for player",a.jPlayer.warning)},loadstart:function(a){playing&&""!=a.jPlayer.status.src&&(consoleLog("current track position",current_track_position),0<current_track_position&&(a.jPlayer.status.src==playlist.tracks[track_position].file||a.jPlayer.status.src==playlist.tracks[track_position].file)&&!shuffle_queue?$.mobile.loading("show",theme.bars,"Resuming"):$.mobile.loading("show",theme.bars,"Loading"),started&&(waiting=
!0,pauseProgress()))},loadedmetadata:function(a){consoleLog("Inside loadedmetadata event handler",a);$.mobile.loading("show",theme.bars,"Metadata loaded")},durationchange:function(a){},play:function(a){consoleLog("Inside play event handler",a)},playing:function(a){trackTime=playlist.tracks[track_position].Time;consoleLog("Inside the jPlayer playing event handler");waiting=!1;startProgress(elapsed,trackTime,elapsed/trackTime*100);consoleLog("Inside playing event handler",a);$.mobile.loading("hide")},
timeupdate:function(a){},ended:function(a){},volumechange:function(a){consoleLog("Player volume set to "+a.jPlayer.options.volume)}});if("undefined"!==typeof playlist&&"undefined"!==typeof playlist.tracks&&"undefined"!==typeof playlist.tracks[track_position]){$("#artistDiv").html(playlist.tracks[track_position].artist);var b=playlist.tracks[track_position].Album,b=b.length>max_album_name_string_length?b.substring(0,max_album_name_string_length)+"...":b;$("#albumDiv").html(b).trigger("updatelayout");
0===playlist.tracks[track_position].file.indexOf("http://")?$("#trackDiv").html(playlist.tracks[track_position].file).trigger("updatelayout"):(b=playlist.tracks[track_position].Title,b=b.length>max_track_title_string_length?b.substring(0,max_track_title_string_length)+"...":b,$("#trackDiv").html(b).trigger("updatelayout"))}});function control_mpd(b,a){var c="/musicpd/index",d=!1,h=!1,m=!1,k="Loading",f=0;switch(b){case "mpdidling":c="/musicpd/control/mpdidling";break;case "idle":c="/musicpd/control/idle";break;case "noidle":c="/musicpd/control/noidle";break;case "play":c="/musicpd/control/play";break;case "pause":c="/musicpd/control/pause";break;case "stop":c="/musicpd/control/stop";break;case "next":c="/musicpd/control/next";break;case "previous":c="/musicpd/control/previous";break;case "skip":c="/musicpd/control/skip";
break;case "crossfade":c="/musicpd/control/crossfade";break;case "mixrampdb":c="/musicpd/control/mixrampdb";break;case "mixrampdelay":c="/musicpd/control/mixrampdelay";break;case "random":c="/musicpd/control/random";break;case "repeat":c="/musicpd/control/repeat";break;case "setvol":c="/musicpd/control/volume";break;case "mute":c="/musicpd/control/mute";break;case "reset":c="/musicpd/control/reset";break;case "status":c="/musicpd/control/status";break;case "save_playlist":h=!0;k="Saving playlist";
c="/musicpd/playlist/save";d=!0;break;case "delete_playlist":h=!0;k="Deleting playlist";c="/musicpd/playlist/delete";d=!0;break;case "track_add":c="/musicpd/playlist/add/track";break;case "move_track":c="/musicpd/playlist/move/track";break;case "track_move":c="/musicpd/playlist/move/track";break;case "track_remove":c="/musicpd/playlist/remove/track";break;case "remove":f=3E3;h=!0;k="Removing track";c="/musicpd/playlist/remove/track";break;case "clear":f=3E3;h=!0;k="Clearing playlist";c="/musicpd/playlist/clear";
break;case "add":f=1E3;h=!0;m=!1;k="Adding track";c="/musicpd/playlist/add/track";break;case "add_url":c="/musicpd/playlist/add/url";break;case "add_all":f=3E3;h=!0;k="Adding tracks";c="/musicpd/playlist/add/tracks";d=!0;break;case "add_albums":f=3E3;h=!0;k="Adding albums";c="/musicpd/playlist/add/albums";d=!0;break;case "update":f=3E3;h=!0;k="Refreshing MPD";c="/musicpd/control/refresh";break;default:c="/musicpd/control/"+b}post_data="";if("undefined"!==typeof a){for(parameter in a)post_data+=parameter+
"="+encodeURIComponent(a[parameter])+"&";post_data=post_data.substring(0,post_data.length-1)}h&&(0==f&&($.mobile.loadingMessage=k),$.mobile.loading("show","a",k,m));$.ajax({type:"POST",url:c,async:!0,dataType:"json",data:post_data,success:function(a){h&&(""!=a.message?($.mobile.loading("hide"),$.mobile.loadingMessage=a.message,$.mobile.loading("show",a.success?theme.body:"r",a.message,m),f=3E3,d=!1,setTimeout(function(){$.mobile.loading("hide");$.mobile.loadingMessage="Loading"},f)):0==f?($.mobile.loading("hide"),
$.mobile.loadingMessage="Loading"):setTimeout(function(){$.mobile.loading("hide")},f));if(a.success){switch(a.action){case "clear":clearQueue();break;case "remove":removeQueuedTrack(a.id,a.index);$.mobile.loading("hide");$.mobile.loadingMessage="Loading";break;case "pause":control_mpd("noidle");break;case "add_all":$.mobile.loading("hide"),$.mobile.loadingMessage="Loading"}"undefined"==typeof a.mpdidling||a.mpdidling||(control_mpd("idle"),control_mpd("mpdidling"))}d&&$("#header-back-link").trigger("click")}})}
;var trackProgress,started=!1,waiting=!1,elapsed=0;window.onerror=function(){return!0};function startProgress(b,a){consoleLog("inside startProgress, trackStart: "+b+" and trackEnd: "+a);!1===started&&(started=!0,0<b&&(elapsed=b),trackProgress=setInterval(function(){updatePlayProgressDisplay(elapsed,a,elapsed/a*100);elapsed++},1E3))}function pauseProgress(){window.clearInterval(trackProgress);started=!1}function resetProgress(){window.clearInterval(trackProgress);elapsed=0;started=!1}
function get_timer_display(b){minutes=hours="-";seconds="--";time_display=hours+":"+minutes+":"+seconds;if("Infinity:NaN"==b)return time_display="<font style='font-size:12px;'>\u221e</font>",b="#FFFFFF",b=0==(new Date).getSeconds()%2?"#FFFFFF":"#000000",$("#streamProgressDiv").css("background-color",b),time_display;if(0<=b){var a=Date.parse((new Date).toDateString());b=new Date(parseInt(a)+1E3*parseInt(b));time_display=b.toTimeString();time_display=time_display.substr(0,time_display.indexOf(" "));
0==parseInt(b.getHours())&&(time_display=time_display.substr(time_display.indexOf(":")+1,5))}return time_display}function initialize_timer_display(){$("#trackPlayDuration").html("-:--");$("#playProgressDiv").css("width",0);$("#playProgressDiv").css("background-color","#FFFFFF");$("#loadProgressDiv").css("width","100%");$("#loadProgressDiv").css("background","rgba(0, 0, 0, .4)");$("#loadProgressDiv").css("border","1px inset #888888");$("#trackTotalDuration").html("-:--")}
function fade_out_current_track(){0<out_volume_left_to_fade&&(out_faded_volume=out_volume_left_to_fade/volume_fade,consoleLog("Setting player volume to: "+out_faded_volume),$("#player").jPlayer("volume",out_faded_volume),out_volume_left_to_fade--)}
function fade_in_next_track(){0<volume_fade-in_volume_left_to_fade&&0<=in_volume_left_to_fade&&(in_faded_volume=(volume_fade-in_volume_left_to_fade)/volume_fade,consoleLog("Setting player volume to: "+out_faded_volume),$("#player").jPlayer("volume",out_faded_volume),in_volume_left_to_fade--)}function updatePlayProgressDisplay(b,a,c){$("#trackTotalDuration").html(get_timer_display(a));$("#playProgressDiv").css("width",c+"%");$("#trackPlayDuration").html(get_timer_display(b))}
function updateLoadProgressDisplay(b){$("#loadProgressDiv").css("width",b+"%")}
function getNextTrackPosition(b,a,c){consoleLog("Inside getNextTrackPosition - destination ",b);consoleLog("Inside getNextTrackPosition - currentTrackPosition ","'"+a+"'");consoleLog("Inside getNextTrackPosition - currentPlaylistLength ",c);consoleLog("Inside getNextTrackPosition - currentPlaylistLength minus 1 ",c-1);var d=a;switch(b){case "next":a==c-1?d=0:d++;break;case "previous":0==a?d=c-1:d--;break;case "beginning":d=0;break;case "same":break;default:d=Math.floor(b)==b&&$.isNumeric(b)?b:!1}return d}
function processTimeUpdate(b,a,c){1<b&&($.mobile.loading("hide"),$.mobile.loadingMessage="Loading");updatePlayProgressDisplay(b,a,c)}
function updatePlayerDisplay(b,a){b&&"pause"==(a||"play")?($("#jukebox #playpause").attr("data-icon","play"),$("#jukebox #playpause").buttonMarkup("refresh"),$("#jukebox #playpause").removeClass("ui-icon-pause").addClass("ui-icon-play"),$("#playerCurrentlyPlayingDiv").slideUp({duration:default_easout_duration,easing:default_easout_equation,complete:function(){$("#trackProgressDiv").slideUp({duration:default_easout_duration,easing:default_easout_equation,complete:function(){}})}})):($("#jukebox #playpause").attr("data-icon",
"pause"),$("#jukebox #playpause").buttonMarkup("refresh"),$("#jukebox #playpause").removeClass("ui-icon-play").addClass("ui-icon-pause"),"none"==$("#playerCurrentlyPlayingDiv").css("display")&&$("#playerCurrentlyPlayingDiv").slideDown({duration:default_easin_duration,easing:default_easin_equation,complete:function(){$("#trackProgressDiv").slideDown({duration:default_easin_duration,easing:default_easin_equation,complete:function(){}})}}))}
function skipto(b,a){trackStart=0|a;0==trackStart&&(elapsed=0);$.mobile.loading("hide");$.mobile.loadingMessage="Loading";if("undefined"===typeof playlist.tracks)return!1;load_progress_complete=!1;track_position=getNextTrackPosition(b,track_position,playlist.tracks.length);updateCurrentTrackInfo(playlist.tracks[track_position]);trackEnd=playlist.tracks[track_position].Time;updatePlayerDisplay(playing);consoleLog("Checking to see if the player's srcSet is true or false",$("#player").data("jPlayer").status);
$("#player").data("jPlayer").status.srcSet||$("#player").jPlayer("setMedia",{mp3:usersStream});"same"==b?0==trackStart?control_mpd("play"):(post={parameters:[{position:trackStart}]},control_mpd("play",post.parameters[0])):"next"==b?(initialize_timer_display(),control_mpd("next")):"previous"==b?(initialize_timer_display(),control_mpd("previous")):"beginning"!=b&&track_position&&(post={parameters:[{index:track_position}]},control_mpd("skip",post.parameters[0]));playing||($("#player").jPlayer("play"),
playing=!0)}
function updateCurrentTrackInfo(b){consoleLog("Trying to set the info about the song being played using the track object",b);document.getElementById("currentalbumart");document.getElementById("playerCurrentlyPlayingDiv");$("#currentAlbumArtImg").attr("src",b.Art);$("#artistDiv").html(b.Artist);var a=b.Album,a=a.length>max_album_name_string_length?a.substring(0,max_album_name_string_length)+"...":a;$("#albumDiv").html(a).trigger("updatelayout");0===b.file.indexOf("http://")?$("#trackDiv").html(b.file).trigger("updatelayout"):(b=
b.Title,b=b.length>max_track_title_string_length?b.substring(0,max_track_title_string_length)+"...":b,$("#trackDiv").html(b).trigger("updatelayout"));$("#playerCurrentlyPlayingDiv").css("max-width",.9*$(window).width())}
function crossfadePlayers(b){b/=90;$("#"+priPlayerID).jPlayer("volume",0);$.timer(b,function(a){var b=$("#"+secPlayerID).jPlayer("getData","volume")-1;$("#"+secPlayerID).jPlayer("volume",b);1>b&&($("#"+secPlayerID).jPlayer("stop"),a.stop())});$("#"+secPlayerID+"_elements").hide();$.timer(b/2,function(a){var b=$("#"+priPlayerID).jPlayer("getData","volume")+2;$("#"+priPlayerID).jPlayer("volume",b);90<b&&a.stop()});$("#"+priPlayerID+"_elements").show()};function consoleLog(b,a){a=a||"";"console"in window&&"log"in window.console&&debug&&(console.log(b),""!=a&&console.log(a))}
function processIncomingMessage(b){if("undefined"!=typeof b.action)switch(b.action){case "idle":"undefined"!=typeof b.track&&(track_position==b.track.Pos||waiting||movePlayerHead(b.track));break;case "play":case "previous":case "next":case "skip":"undefined"!=typeof b.track&&movePlayerHead(b.track);break;case "add":case "clear":"undefined"!=typeof b.playlist&&syncPlaylist(b.playlist)}}
function movePlayerHead(b){consoleLog("Moving playerHead to newTrack");consoleLog(b);resetProgress();track_position=b.Pos;updateCurrentTrackInfo(playlist.tracks[track_position]);trackStart=0;"undefined"!=typeof b.seekTo&&(elapsed=trackStart=b.seekTo);trackEnd=b.Time;consoleLog("track event calling startProgress("+trackStart+", "+trackEnd+")");startProgress(trackStart,trackEnd)}
function syncPlaylist(b){consoleLog("Syncing playlist to updatedPlaylist");"undefined"!=typeof b.tracks&&0<b.tracks.length&&(playlist=b)}function onUpdate(b,a){consoleLog(b);consoleLog(a);"undefined"!=typeof a.topic&&a.topic.match(/^radio\/station\/[0-9]+$/i)&&"undefined"!=typeof a.msg&&processIncomingMessage(a.msg)};function get_mpd_playlist(b){var a;$.ajax({type:"POST",url:"/musicpd/query",async:!1,data:"query=playlist",success:function(c){a=c;b&&(a=shuffle_playlist(a))}});return a}
function shuffle_playlist(b){b=$.parseJSON(b);shuffled_playlist='{ "tracks" : [';count_of_tracks=number_of_tracks=b.tracks.length;for(i=0;i<number_of_tracks;i++){var a=Math.floor(Math.random()*count_of_tracks);shuffled_playlist=1==count_of_tracks?shuffled_playlist+JSON.stringify(b.tracks[a]):shuffled_playlist+(JSON.stringify(b.tracks[a])+", ");count_of_tracks--}return shuffled_playlist+="]}"}function unshuffle_playlist(){return unshuffled_playlist=$.parseJSON(get_mpd_playlist())};function clearQueue(){$.mobile.loading("show");track_position=0;playlist={tracks:[]};$("#jukebox #playpause").attr("data-icon","play");$("#jukebox #playpause").removeClass("ui-icon-pause").addClass("ui-icon-play");shuffle_queue=!1;$("#shuffle").attr("data-theme",theme.buttons);$("#shuffle").attr("data-icon","shuffle");$("#shuffle").removeClass(theme.actions).addClass(theme.buttons);$("#player").data("jPlayer").status.srcSet&&($("#player").jPlayer("pause"),$("#player").jPlayer("clearMedia"));current_track_position=
0;playing=!1;paused=!0;setTimeout(function(){$("#trackProgressDiv").slideUp("slow");$("#playerCurrentlyPlayingDiv").slideUp("slow",function(){$.mobile.loading("hide")});initialize_timer_display()},1E3)}function removeQueuedTrack(b,a){$("#"+b).slideUp("slow",function(){delete playlist.tracks[a];$("#"+b).remove()})};$("body").on("pagebeforeshow","#setup",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a")});$("body").on("pagebeforeshow","#edit_site_config",function(b,a){"undefined"!=typeof theme?$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body):$("body").attr("class","ui-mobile-viewport ui-overlay-a");$("div.required-field-error").prev().css("border","2px solid #CC0000")});
$("body").on("pagebeforeshow","#error",function(b,a){"undefined"!=typeof theme?$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body):$("body").attr("class","ui-mobile-viewport ui-overlay-a")});$("body").on("pagebeforeshow","#setup_success",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a")});
$("body").on("pagebeforeshow","#login",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a");$("#login_form a.ui-btn").removeClass("ui-btn-hover-g");$("div.required-field-error").prev().css("border","2px solid #CC0000")});$("body").on("pageinit","#register_form",function(b,a){Recaptcha.destroy();Recaptcha.create(recaptcha_public_key,recaptcha_widget_name,recaptcha_options);set_recaptcha_padding_and_width()});
$("body").on("pagebeforeshow","#register_form",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a");$("div.required-field-error").prev().css("border","2px solid #CC0000")});$("body").on("pagehide","#register_form",function(b,a){});$("body").on("pageshow","#register_form",function(b,a){Recaptcha.destroy();Recaptcha.create(recaptcha_public_key,recaptcha_widget_name,recaptcha_options);set_recaptcha_padding_and_width();$("div.required-field-error").prev().css("border","2px solid #CC0000")});
$("body").on("pagebeforeshow","#paypal",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a")});$("body").on("pagebeforeshow","#paypal_payment_cancelled",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-a")});$("body").on("click","#login_form a.ui-btn",function(b){$(this).addClass("ui-btn-hover-g")});$("body").on("click","#register_form a.ui-btn",function(b){$(this).addClass("ui-btn-hover-g")});$("body").on("click","#login_submit",function(b){$("#login_submit").parent().addClass("ui-btn-hover-g")});
$("body").on("click","#register_submit",function(b){$("#register_submit").parent().addClass("ui-btn-hover-g")});$("body").on("click","#paypal_submit",function(b){$("#paypal_submit").parent().addClass("ui-btn-hover-g")});$("body").on("click","#refresh_captcha",function(b){b.preventDefault();$("#refresh_captcha").parent().addClass("ui-btn-hover-g");refresh_recaptcha()});
$("body").on("click","#switch_type_audio",function(b){b.preventDefault();$("#switch_type_audio").parent().addClass("ui-btn-hover-g");setTimeout(function(){$("#switch_type_audio").parent().removeClass("ui-btn-hover-g")},500);Recaptcha.switch_type("audio")});$("body").on("click","#switch_type_image",function(b){b.preventDefault();$("#switch_type_image").parent().addClass("ui-btn-hover-g");setTimeout(function(){$("#switch_type_image").parent().removeClass("ui-btn-hover-g")},500);Recaptcha.switch_type("image")});
$("body").on("orientationchange","#register_form",function(b,a){set_recaptcha_padding_and_width()});function set_recaptcha_padding_and_width(){var b=$('div[role="dialog"]').width(),b=Math.floor(.98*b);280<b&&(b=Math.floor((b-280)/2),$("#recaptcha_image").css("padding-left",b+"px"),$("#recaptcha_image img").css("cursor","pointer"),$("#recaptcha_image img").css("width","280px !important"),$("#recaptcha_image img:hover").css("width","280px !important"))}
function refresh_recaptcha(){$("#recaptcha_image").fadeOut(100,function(){$("#recaptcha_image").parent().append("<img style='padding-top:15px;' src='images/ajax-loader-fast.gif' />");Recaptcha.reload();set_recaptcha_padding_and_width()});setTimeout(function(){$("img:last").remove();$("#recaptcha_image").fadeIn(500);$("#register_form div.ui-btn").removeClass("ui-btn-hover-g")},2E3)}
function change_page(b,a,c,d,h,m,k,f,e){$.mobile.changePage(b||"home",{transition:a||"fade",reloadPage:c||!1,showLoadMsg:d||!1,changeHash:h||!1,type:m||"get",data:k||"",reverse:f||!1,allowSamePageTransition:e||!1})}function incremental_scroll_up(){var b=$("html,body").height();current_scroll_position=$(window).scrollTop();b=current_scroll_position-b;0>b&&(b=0);$("html,body").animate({scrollTop:b},1E3,function(){})}
function incremental_scroll_down(b){b=$("html,body").height();current_scroll_position=$(window).scrollTop();var a=0;0<current_scroll_position&&(a=current_scroll_position);a+=b;$("html,body").animate({scrollTop:a},1E3,function(){});$("#index").lazyloader("loadMore")}function attach_window_scroll_event(b){$(window).scroll(function(){window_scroll_event_just_fired||mousewheel_event_just_fired||(window_scroll_event_just_fired=!0);setTimeout(function(){window_scroll_event_just_fired=!1},1E3)})};(function(){function b(b,d){return b.section(d.get("json"),d,{block:a},null)}function a(a,b){return a.write("<li class='ui-li-has-thumb'><a href='").reference(b.get("href"),b,"h").write("' class='ui-link-inherit' data-transition='").reference(b.get("transition"),b,"h").write("'><img src='").reference(b.get("art"),b,"h").write("' class='ui-li-thumb album-art-img' /><h3 class='ui-li-heading album-name-heading'>").reference(b.get("name"),b,"h").write("</h3><span class='ui-li-count ui-btn-up-").reference(b.get("theme_buttons"),
b,"h").write(" ui-btn-corner-all'>").reference(b.get("count_bubble_value"),b,"h").write("</span><p class='ui-li-aside ui-li-desc'>").reference(b.get("total_length"),b,"h").write("</p></a></li>")}dust.register("albums",b);return b})();(function(){function b(b,d){return b.section(d.get("json"),d,{block:a},null)}function a(a,b){return a.write("<li><a href='").reference(b.get("href"),b,"h").write("' data-transition='").reference(b.get("transition"),b,"h").write("'>").reference(b.get("name"),b,"h").write("<span class='ui-li-count ui-btn-up-").reference(b.get("theme_buttons"),b,"h").write(" ui-btn-corner-all'>").reference(b.get("count_bubble_value"),b,"h").write("</span></a></li>")}dust.register("artists",b);return b})();(function(){function b(b,d){return b.section(d._get(!1,["json"]),d,{block:a},null)}function a(a,b){return a.write("<li id='").reference(b._get(!1,["id"]),b,"h").write("' style='position:relative;' class='ui-li-has-thumb' data-queue-track-index='").reference(b._get(!1,["index"]),b,"h").write("' data-queue-track-title='").reference(b._get(!1,["Title"]),b,"h").write("' data-queue-track-file='").reference(b._get(!1,["file"]),b,"h").write("' class='ui-li-has-thumb ui-btn ui-btn-icon-right'><a href='#queueTrackPopupMenu' data-rel=\"popup\" data-icon=\"none\" class=\"ui-link-inherit\"><img src='").reference(b._get(!1,
["Art"]),b,"h").write("' class='ui-li-thumb track-item-image' /><h3 class='track-title-heading ui-li-heading'>").reference(b._get(!1,["Track"]),b,"h").write(" - ").reference(b._get(!1,["Title"]),b,"h").write("</h3><p class='ui-li-aside ui-li-desc'>").reference(b._get(!1,["length"]),b,"h").write("</p></a><a href='' data-icon='move' class='").reference(b._get(!1,["theme_icon_class"]),b,"h").write(" ui-li-link-alt ui-btn ui-btn-up-").reference(b._get(!1,["theme_buttons"]),b,"h").write(" move' data-theme='").reference(b._get(!1,
["theme_buttons"]),b,"h").write("' title='").reference(b._get(!1,["anchorTitle"]),b,"h").write("'>").reference(b._get(!1,["anchorTitle"]),b,"h").write("</a></li>")}dust.register("queue",b);return b})();(function(){function b(b,d){return b.section(d.get("json"),d,{block:a},null)}function a(a,b){return a.write("<li class='ui-li-has-thumb' data-icon='plus'><a href='' onclick='post = { \"parameters\" : [ { \"file\" : \"").reference(b.get("file"),b,"h").write("\" } ] }; control_mpd( \"add\", post.parameters[0] );' class='ui-link-inherit' title='").reference(b.get("title"),b,"h").write("'><img src='").reference(b.get("art"),b,"h").write("' class='ui-li-thumb track-item-image' /><h3 class='track-title-heading ui-li-heading'>").reference(b.get("name"),
b,"h").write("</h3><p class='ui-li-aside ui-li-desc'>").reference(b.get("length"),b,"h").write("</p></a></li>")}dust.register("tracks",b);return b})();(function(){function b(b,d){return b.section(d._get(!1,["json"]),d,{block:a},null)}function a(a,b){return a.write("<li id='").reference(b._get(!1,["id"]),b,"h").write("' style='position:relative;' data-theme='").reference(b._get(!1,["theme_buttons"]),b,"h").write("' data-playlist-track-index='").reference(b._get(!1,["index"]),b,"h").write("' data-playlist-track-file='").reference(b._get(!1,["file"]),b,"h").write("' class='ui-li-has-thumb ui-btn ui-btn-icon-right'><a href='").reference(b._get(!1,["href"]),
b,"h").write("' data-rel='popup'><img src='").reference(b._get(!1,["Art"]),b,"h").write("' class='ui-li-thumb track-item-image' /><h3 class='track-title-heading ui-li-heading'>").reference(b._get(!1,["Track"]),b,"h").write(" - ").reference(b._get(!1,["Title"]),b,"h").write("</h3><p class='ui-li-aside ui-li-desc'>").reference(b._get(!1,["length"]),b,"h").write("</p></a><a href='' data-icon='move' class='").reference(b._get(!1,["theme_icon_class"]),b,"h").write(" ui-li-link-alt ui-btn ui-btn-up-").reference(b._get(!1,
["theme_buttons"]),b,"h").write(" move' data-theme='").reference(b._get(!1,["theme_buttons"]),b,"h").write("' title='").reference(b._get(!1,["anchorTitle"]),b,"h").write("'>").reference(b._get(!1,["Title"]),b,"h").write("</a></li>")}dust.register("playlistTracks",b);return b})();$("body").on("lazyloadercreate","#index",function(b){});$("body").on("lazyloaderbeforecreate","#index",function(b){});$("body").on("lazyloaderdestroy","#index",function(b){});$("body").on("lazyloaderdoneloading","#index",function(b){$.mobile.loading("hide");$.mobile.loadingMessage="Loading"});$("body").on("lazyloaderalldone","#index",function(b){$.mobile.loading("hide");$.mobile.loadingMessage="Loading"});
$("body").on("lazyloaderbusy","#index",function(b){$.mobile.loading("hide");$.mobile.loadingMessage="Loading"});$("body").on("lazyloadererror","#index",function(b){});$("body").on("lazyloaderreset","#index",function(b){});$("body").on("lazyloaderresetall","#index",function(b){});
$("body").on("pageinit","#index",function(b,a){$("#index").lazyloader();$("#index").lazyloader("reInitialize",{},{clearUrl:"/session/clear"},{});$.mobile.lazyloader.prototype.timeoutOptions.mousewheel=300;$.mobile.lazyloader.prototype.timeoutOptions.scrollstart=700;$.mobile.lazyloader.prototype.timeoutOptions.scrollstop=100;$.mobile.lazyloader.prototype.timeoutOptions.showprogress=100;$("body").enableSelection();control_mpd("status")});$("body").on("pageinit","#genres",function(b,a){});
$("body").on("pageinit","#queue",function(b,a){threshold=2.5*$(window).height();var c={threshold:threshold,retrieve:20,retrieved:20,bubbles:!0,offset:playlist_index_offset},d={retrieve:c.retrieve,retrieved:c.retrieved,offset:c.offset};$("#index").lazyloader("reInitialize",c,{pageId:"queue",templateType:"dust",templateId:"queue",templatePrecompiled:!0,mainId:"queueTracksList",progressDivId:"lazyloaderProgressDiv",moreUrl:"/queue/more",clearUrl:"/session/clear",JSONP:!1,JSONPCallback:"callback"},d);
$("#queueTracksList").sortable({disabled:!1,axis:"y",containment:"parent",distance:1,opacity:.7,scroll:!0,scrollSensitivity:160,scrollSpeed:30,revert:!0,placeholder:"ui-state-highlight-sortable",items:"li",handle:"a.move",delay:800});$("body").disableSelection()});
$("body").on("pageinit","#artists",function(b,a){$("#index").lazyloader("reset","albums");threshold=$(window).height();var c={threshold:threshold,retrieve:20,retrieved:20,bubbles:!0,offset:0},d={retrieve:c.retrieve,retrieved:c.retrieved,offset:c.offset};$("#index").lazyloader("reInitialize",c,{pageId:"artists",templateType:"dust",templateId:"artists",templatePrecompiled:!0,mainId:"artistsList",progressDivId:"lazyloaderProgressDiv",moreUrl:"/artists/more",clearUrl:"/session/clear"},d)});
$("body").on("pageinit","#save_playlist",function(b,a){$("body").enableSelection();$("#index").lazyloader("reset","queue")});
$("body").on("pageinit","#albums",function(b,a){threshold=$(window).height();var c={threshold:threshold,retrieve:20,retrieved:20,bubbles:!0},d={retrieve:c.retrieve,retrieved:c.retrieved,offset:c.offset};$("#index").lazyloader("reInitialize",c,{pageId:"albums",templateType:"dust",templateId:"albums",templatePrecompiled:!0,mainId:"albumsList",progressDivId:"lazyloaderProgressDiv",moreUrl:"/albums/more",clearUrl:"/session/clear"},d)});
$("body").on("pageinit","#playlists",function(b,a){$("#index").lazyloader("reset","playlistTracksPage");$("body").enableSelection()});
$("body").on("pageinit","#playlistTracksPage",function(b,a){threshold=2.5*$(window).height();var c={threshold:threshold,retrieve:50,retrieved:50,bubbles:!0,offset:0},d={retrieve:c.retrieve,retrieved:c.retrieved,offset:c.offset};$("#index").lazyloader("reInitialize",c,{pageId:"playlistTracksPage",templateType:"dust",templateId:"playlistTracks",templatePrecompiled:!0,mainId:"playlistTracks",progressDivId:"lazyloaderProgressDiv",moreUrl:"/playlist/tracks/more",clearUrl:"/session/clear"},d);$("#playlistTracks").sortable({disabled:!1,
axis:"y",containment:"parent",distance:1,opacity:.7,scroll:!0,scrollSensitivity:160,scrollSpeed:30,revert:!0,placeholder:"ui-state-highlight-sortable",items:"li",handle:"a.move",delay:800});$("body").disableSelection()});$("body").on("pageinit","#settings",function(b,a){$("#settings").on("change","#theme_id",function(a,b){"0"==$("#theme_id :selected").val()&&$.mobile.changePage("/settings/custom/theme",{allowSamePageTransition:!0,transition:"slideup",reloadPage:!1,showLoadMsg:!0,changeHash:!1})})});
$("body").on("pagebeforeshow","#music_uploader",function(b,a){$("div.plupload_header").addClass("ui-bar-"+theme.bars).attr("role","banner")});
$("body").on("pageinit","#music_uploader",function(b,a){$(function(){$("#uploader").pluploadQueue({runtimes:"html5",url:"/upload/music",max_file_size:"192mb",unique_names:!0,multiple_queues:!0,resize:{width:320,height:240,quality:90},filters:[{title:"MP3 files",extensions:"mp3"},{title:"OGG files",extensions:"ogg"}],init:{Refresh:function(a){},StateChanged:function(a){a.state==plupload.STOPPED&&control_mpd("update")},QueueChanged:function(a){},UploadProgress:function(a,b){},FilesAdded:function(a,
b){},FilesRemoved:function(a,b){},FileUploaded:function(a,b,h){},ChunkUploaded:function(a,b,h){},Error:function(a,b){}}});$("form").submit(function(a){var b=$("#uploader").pluploadQueue();0<b.files.length?(b.bind("StateChanged",function(){b.files.length===b.total.uploaded+b.total.failed&&$("form")[0].submit()}),b.start()):alert("You must queue at least one file.");return!1})})});$("body").on("pageshow","#register_form",function(b,a){});
$("body").on("pageshow","#index",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body);$("#playerCurrentlyPlayingDiv").css("max-width",.9*$(window).width()).trigger("updatelayout");$("body").enableSelection();$("#index").lazyloader("resetAll")});$("body").on("pageshow","#artists",function(b,a){$.mobile.loading("hide")});$("body").on("pageshow","#genres",function(b,a){$("#index").lazyloader("reset","artists");$.mobile.loading("hide")});
$("body").on("pageshow","#playlists",function(b,a){$.mobile.loading("hide")});$("body").on("pageshow","#stations",function(b,a){$.mobile.loading("hide")});$("body").on("pageshow","#queue",function(b,a){$.mobile.loading("hide");$("#currentlyPlayingArtistDiv").css("max-width",.6*$(window).width());$("#currentlyPlayingAlbumDiv").css("max-width",.6*$(window).width());$("#currentlyPlayingTrackDiv").css("max-width",.6*$(window).width())});
$("body").on("pageshow","#admin",function(b,a){$.mobile.loading("hide");"undefined"!=typeof a.prevPage[0]&&$.mobile.loading("hide");$.mobile.activeBtnClass="ui-btn-hover-"+theme.active});$("body").on("pageshow","#setup",function(b,a){$.mobile.loading("hide");$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body);$.mobile.activeBtnClass="ui-btn-hover-"+theme.active});
$("body").on("pageshow","#music_uploader",function(b,a){$('*[data-role="button"]').each(function(a){$(this).attr("data-theme",theme.buttons).removeClass("ui-btn-up-"+theme.buttons).addClass("ui-btn-up-"+theme.buttons)})});
$("body").on("pageshow","#save_playlist",function(b,a){$("div.required-field-error").prev().css("border","2px solid #CC0000");if("undefined"!=typeof a.prevPage[0]&&"save_playlist"==a.prevPage[0].id){var c=!0;$("div.required-field-error").each(function(a){c=!1});c&&($.mobile.loadingMessage="Please wait",$.mobile.loading("show"),goBackTimer=setTimeout(function(){$.mobile.loading("hide");$.mobile.loadingMessage="Please wait";history.go(-1)},1E3))}});
$("body").on("pageshow","#admin_payments",function(b,a){$("div.required-field-error").prev().css("border","2px solid #CC0000");"undefined"!=typeof a.prevPage[0]&&"admin_payments"==a.prevPage[0].id&&window.scrollTo(0,1)});$("body").on("pageshow","#edit_site_config",function(b,a){$("div.required-field-error").prev().css("border","2px solid #CC0000");"undefined"!=typeof a.prevPage[0]&&"edit_site_config"==a.prevPage[0].id&&window.scrollTo(0,1)});
$("body").on("pageshow","#edit_user_config",function(b,a){$("div.required-field-error").prev().css("border","2px solid #CC0000");"undefined"!=typeof a.prevPage[0]&&"edit_user_config"==a.prevPage[0].id&&window.scrollTo(0,1)});$("body").on("pageshow","#playlists",function(b,a){});
$("body").on("pageshow","#account",function(b,a){$.mobile.activeBtnClass="ui-btn-hover-"+theme.active;$("div.required-field-error").prev().css("border","2px solid #CC0000");"undefined"!=typeof a.prevPage[0]&&"account"==a.prevPage[0].id&&window.scrollTo(0,1)});
$.widget("blueimp.fileupload",$.blueimp.fileupload,{options:{acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,processQueue:{action:"validate",acceptFileTypes:"@",disabled:"@disableValidation"}},processActions:{validate:function(b,a){if(a.disabled)return b;var c=$.Deferred(),d=b.files[b.index];a.acceptFileTypes.test(d.type)?c.resolveWith(this,[b]):(d.error="Invalid file type.",c.rejectWith(this,[b]));return c.promise()}}});
$("body").on("pageshow","#station",function(b,a){$("#station_image_file").fileupload({url:"/upload/station/icon",replaceFileInput:!1,sequentialUploads:!0,dataType:"json",acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,maxFileSize:5242880,add:function(a,b){var h=[];$("#station_image_file_div").children().removeClass("required-field");$("#station_image_file_div").closest(".station-field-divs").height(80).find("div.required-field-error").remove();consoleLog("The file being uploaded is as follows",b.originalFiles);
/^image\/(gif|jpe?g|png)$/i.test(b.originalFiles[0].type)||h.push("The selected file is not an allowed type");5242880<b.originalFiles[0].size&&h.push("The selected file is larger than 5MB");if(0<h.length){$("#station_image_file_div").children().addClass("required-field");var m='<div class="error-message-divs">'+h.join('</div><div class="error-message-divs">')+"</div>";extraHeight=20*h.length;currentHeight=$("#station_image_file_div").closest(".station-field-divs").height();$("#station_image_file_div").closest(".station-field-divs").height(currentHeight+
extraHeight).append('<div class="required-field-error">'+m+"</div>")}else b.submit()},start:function(a){$.mobile.loadingMessage="Uploading image";$.mobile.loading("show");consoleLog("File upload started")},progress:function(a,b){var h=parseInt(b.loaded/b.total*100,10);$.mobile.loadingMessage=h+"%";consoleLog(h)},done:function(a,b){consoleLog("File upload complete");consoleLog("e",a);consoleLog("data",b);consoleLog("Setting the uploaded_image element src to: /"+b.result.baseurl+b.result.filename);
$("#uploaded_image").attr("src","/"+b.result.baseurl+b.result.filename);$("#station_icon_id").val(b.result.id);$.mobile.loading("hide");$.mobile.loadingMessage="Loading"},fail:function(a,b){consoleLog("File upload failed");$.mobile.loading("hide");$.mobile.loadingMessage="Loading"}});$("div.required-field-error").prev().css("border","2px solid #CC0000");$("#saved_successfully").removeClass("success-top-padding");"undefined"!=typeof a.prevPage[0]&&"station"==a.prevPage[0].id&&window.scrollTo(0,1)});
$("body").on("pageshow","#login",function(b,a){});$("body").on("pagehide","#create_new_theme",function(b,a){0==$("#theme_id option:selected").val()&&($("#theme_id option:selected").val("1"),$("#theme_id").selectmenu("refresh",!0))});$("body").on("pagebeforeshow","#index",function(b,a){});$("body").on("pagebeforeshow","#station",function(b,a){});
$("body").on("pagebeforeshow","#queue",function(b,a){$("#currentlyPlayingArtistDiv").css("max-width",.6*$(window).width());$("#currentlyPlayingAlbumDiv").css("max-width",.6*$(window).width());$("#currentlyPlayingTrackDiv").css("max-width",.6*$(window).width())});$("body").on("pagebeforeshow","#account",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body);$.mobile.activeBtnClass="ui-btn-hover-"+theme.active});
$("body").on("pagebeforeshow","#admin",function(b,a){$("body").attr("class","ui-mobile-viewport ui-overlay-"+theme.body)});$("body").on("pagebeforechange","#artists",function(b,a){});$("body").on("pagebeforechange","#albums",function(b,a){});$("body").on("pagebeforechange","#tracks",function(b,a){});
$("body").on("change","#volume_control",function(){just_swiped_right=just_swiped_left=!0;waiting_to_adjust_volume||(waiting_to_adjust_volume=!0,setTimeout(function(){new_volume=$("#volume_control").val();post={parameters:[{volume:new_volume}]};control_mpd("setvol",post.parameters[0]);just_swiped_right=just_swiped_left=waiting_to_adjust_volume=!1},1E3))});
$("body").on("change","#xfade_control",function(){just_swiped_right=just_swiped_left=!0;waiting_to_adjust_xfade||(waiting_to_adjust_xfade=!0,setTimeout(function(){new_xfade_value=$("#xfade_control").val();post={parameters:[{crossfade:new_xfade_value}]};control_mpd("crossfade",post.parameters[0]);just_swiped_right=just_swiped_left=waiting_to_adjust_xfade=!1},500))});
$("body").on("change","#mixrampdb_control",function(){just_swiped_right=just_swiped_left=!0;waiting_to_adjust_mixrampdb||(waiting_to_adjust_mixrampdb=!0,setTimeout(function(){new_mixrampdb_value=$("#mixrampdb_control").val();post={parameters:[{mixrampdb:new_mixrampdb_value}]};control_mpd("mixrampdb",post.parameters[0]);just_swiped_right=just_swiped_left=waiting_to_adjust_mixrampdb=!1},500))});
$("body").on("change","#mixrampdelay_control",function(){just_swiped_right=just_swiped_left=!0;waiting_to_adjust_mixrampdelay||(waiting_to_adjust_mixrampdelay=!0,setTimeout(function(){new_mixrampdelay_value=$("#mixrampdelay_control").val();post={parameters:[{mixrampdelay:new_mixrampdelay_value}]};control_mpd("mixrampdelay",post.parameters[0]);just_swiped_right=just_swiped_left=waiting_to_adjust_mixrampdelay=!1},500))});
$("body").on("change","#volume_fade_control",function(){just_swiped_right=just_swiped_left=!0;waiting_to_adjust_volume_fade||(waiting_to_adjust_volume_fade=!0,setTimeout(function(){new_volume_fade_value=$("#volume_fade_control").val();just_swiped_right=just_swiped_left=waiting_to_adjust_volume_fade=!1},500))});$("body").on("change","#operating_mode",function(b,a){mode="Streaming"==$("#operating_mode :selected").text()?"streaming":"localplay"});
$("body").on("change","#station_visibility",function(b,a){var c="on"==$("#station_visibility").prop("value")?"off":"on";$("#station_visibility").prop("value",c).checkboxradio("refresh")});$("body").on("change","#user_account_active",function(b,a){var c="on"==$("#user_account_active").prop("value")?"off":"on";$("#user_account_active").prop("value",c).checkboxradio("refresh")});
$("body").on("change","#paypal_sandbox_mode",function(b,a){var c="on"==$("#paypal_sandbox_mode").prop("value")?"off":"on";$("#paypal_sandbox_mode").prop("value",c).checkboxradio("refresh")});$("body").on("click","#playpause",function(b){b.preventDefault();$.mobile.loading("hide");$.mobile.loadingMessage="Loading";playing?(updatePlayerDisplay(playing,"pause"),$("#player").jPlayer("pause"),current_track_position=elapsed,control_mpd("pause"),playing=!1,paused=!0,pauseProgress()):skipto("same",current_track_position)});
$("body").on("click","#next",function(b){b.preventDefault();skipto("next")});$("body").on("click","#prev",function(b){b.preventDefault();skipto("previous")});$("body").on("click",'#repeatOptionsPopup ul li a[data-id="repeatOff"]',function(b,a){post={parameters:[{repeat:"0"}]};control_mpd("repeat",post.parameters[0]);$("#repeat").removeClass("ui-btn-"+theme.actions).attr("data-theme",theme.buttons).attr("data-icon","repeat").addClass("ui-btn-"+theme.buttons);$("#repeatOptionsPopup").popup("close")});
$("body").on("click",'#repeatOptionsPopup ul li a[data-id="repeatTrack"]',function(b,a){post={parameters:[{repeat:"1",option:"track"}]};control_mpd("repeat",post.parameters[0]);$("#repeat").removeClass("ui-btn-"+theme.buttons).attr("data-theme",theme.actions).attr("data-icon","repeat").addClass("ui-btn-"+theme.actions);$("#repeatOptionsPopup").popup("close")});
$("body").on("click",'#repeatOptionsPopup ul li a[data-id="repeatPlaylist"]',function(b,a){post={parameters:[{repeat:"1",option:"playlist"}]};control_mpd("repeat",post.parameters[0]);$("#repeat").removeClass("ui-btn-"+theme.buttons).attr("data-theme",theme.actions).attr("data-icon","repeat").addClass("ui-btn-"+theme.actions);$("#repeatOptionsPopup").popup("close")});
$("body").on("click","#shuffle",function(b){"undefined"!==typeof playlist.tracks?0<playlist.tracks.length?(shuffle_queue?(shuffle_queue=!1,$("#shuffle").removeClass("ui-btn-"+theme.actions).attr("data-theme",theme.buttons).attr("data-icon","shuffle").addClass("ui-btn-"+theme.buttons),post={parameters:[{random:"0"}]}):(shuffle_queue=!0,$("#shuffle").removeClass("ui-btn-"+theme.buttons).attr("data-theme",theme.actions).attr("data-icon","shuffle").addClass("ui-btn-"+theme.actions),post={parameters:[{random:"1"}]}),
control_mpd("random",post.parameters[0])):($.mobile.loading("show",theme.bars,"Nothing to shuffle",!0),setTimeout(function(){$.mobile.loading("hide")},2E3)):($.mobile.loading("show",theme.bars,"Nothing to shuffle",!0),setTimeout(function(){$.mobile.loading("hide")},2E3))});
$("body").on("click","#confirm_delete_yes",function(){var b=$("#item_type").val(),a=$("#item_name").val();"playlist"==b?(post={parameters:[{playlist_name:a}]},control_mpd("delete_playlist",post.parameters[0]),history.go(-2)):"station"==b?(b=$("#item_id").val(),$.mobile.loadingMessage="Deleting Station",$.mobile.loading("show"),$.ajax({type:"POST",url:"/stations/delete",async:!0,data:"station_id="+b,success:function(a){$.mobile.loading("hide");$.mobile.loadingMessage="Loading";history.go(-2)}})):"user"==
b&&(b=$("#item_id").val(),$.mobile.loadingMessage="Deleting User Account",$.mobile.loading("show"),$.ajax({type:"POST",url:"/user/"+b+"/delete",async:!0,data:"user_id="+b,success:function(a){$.mobile.loading("hide");$.mobile.loadingMessage="Loading";history.go(-2)}}))});$("body").on("click","#confirm_delete_no",function(){$(".ui-dialog").dialog("close")});
$("body").on("click","#apply_settings_yes",function(){setTimeout(function(){$.mobile.loadingMessage="Please wait";$.mobile.loading("show");setTimeout(function(){location.reload(!0)},500)},2E3)});$("body").on("click","#apply_settings_no",function(){});
$("body").on("click","#create_theme_save",function(b,a){b.preventDefault();var c=$("#theme_name").val(),d=$("#icon_color").val(),h=$("#icon_disc").val(),m=$("#bars_letter_code").val(),k=$("#buttons_letter_code").val(),f=$("#body_letter_code").val(),e=$("#controls_letter_code").val(),g=$("#action_letter_code").val(),n=$("#active_state_letter_code").val();"undefined"!=typeof c&&""!=c?($.mobile.loadingMessage="Saving Theme",$.mobile.loading("show"),$.ajax({type:"POST",url:"/settings/create/theme",async:!0,
data:"theme_name="+c+"&icon_color="+d+"&icon_disc="+h+"&bars_letter_code="+m+"&buttons_letter_code="+k+"&body_letter_code="+f+"&controls_letter_code="+e+"&action_letter_code="+g+"&active_state_letter_code="+n,success:function(a){$.mobile.loading("hide");$.mobile.loadingMessage="Loading";history.go(-1)}})):$("#theme_name").css("border","2px solid #CC0000")});
$("body").on("click","#close_station",function(b,a){b.preventDefault();var c=0,d;for(d in $.mobile.urlHistory.stack)0<$.mobile.urlHistory.stack[d].url.indexOf("stations#&ui-state=dialog")&&(c+=1);window.history.go(-1*(c+1))});$("body").on("click","#close_database",function(b,a){b.preventDefault();var c=0,d;for(d in $.mobile.urlHistory.stack)0<$.mobile.urlHistory.stack[d].url.indexOf("setup/database")&&(c+=1);window.history.go(-1*c)});
$("body").on("click","#close_payments",function(b,a){b.preventDefault();var c=0,d;for(d in $.mobile.urlHistory.stack)0<$.mobile.urlHistory.stack[d].url.indexOf("admin/payments")&&(c+=1);window.history.go(-1*c)});$("body").on("click","#close_user",function(b,a){b.preventDefault();var c=0,d;for(d in $.mobile.urlHistory.stack)0<$.mobile.urlHistory.stack[d].url.indexOf("edit/user")&&(c+=1);window.history.go(-1*c)});
$(window).on("orientationchange",function(b){setTimeout(function(){$("#playerCurrentlyPlayingDiv").css("max-width",.9*$(window).width());$("#playerCurrentlyPlayingDiv").width(.9*$(window).width())},400)});
$("body").on("click","#volume_crossfade_form_save",function(b,a){b.preventDefault();var c=$("#is_admin_user").val(),d=$("#volume_control").val(),h=$("#xfade_control").val(),m=$("#mixrampdb_control").val(),k=$("#mixrampdelay_control").val(),f=$("#volume_fade_control").val();("undefined"==typeof d||""==d||0>d)&&c&&(d=5);if("undefined"==typeof h||""==h)h=5;if("undefined"==typeof m||""==m)m=-17;if("undefined"==typeof k||""==k)k=5;if("undefined"==typeof f||""==f)f=5;$.mobile.loadingMessage="Saving Settings";
$.mobile.loading("show");$.ajax({type:"POST",url:"/settings/save/volume",async:!0,data:"volume="+d+"&crossfade="+h+"&volume_fade="+f+"&mixrampdb="+m+"&mixrampdelay="+k,success:function(a){saved=$.parseJSON(a);$.mobile.loading("hide");$.mobile.loadingMessage="Loading";$("#volume_crossfade").dialog("close")}})});
$("body").on("click","#settingsPopupMenu ul li #volume_crossfade_button",function(b,a){$.mobile.changePage("/settings/volume",{allowSamePageTransition:!0,transition:"pop",reloadPage:!1,showLoadMsg:!1,changeHash:!0})});
$("body").on("click",'#settingsPopupMenu ul div[data-role="collapsible-set"] div[data-role="collapsible"] ul li a',function(b,a){var c=b.target.getAttribute("data-id"),d=b.target.getAttribute("data-item-id");b.target.getAttribute("data-item-name");"changeLanguage"==c?"undefined"!=typeof d&&($.mobile.loadingMessage="Setting Language",$.mobile.loading("show"),c=$("#currently_selected_theme_id").val(),$.ajax({type:"POST",url:"/settings/save/language",async:!0,data:"language_id="+d+"&theme_id="+c,success:function(a){saved=
$.parseJSON(a);$("ul#availableLanguages li").find("a.ui-icon-check").removeClass("ui-icon-check").addClass("ui-icon-minus");$('ul#availableLanguages li a[data-item-id="'+d+'"]').removeClass("ui-icon-minus").addClass("ui-icon-check").closest("li").attr("data-icon","check");$.mobile.loading("hide");$.mobile.loadingMessage="Loading";$.mobile.changePage("/settings/apply",{allowSamePageTransition:!0,transition:"pop",reloadPage:!1,showLoadMsg:!1,changeHash:!0})}})):"changeTheme"==c&&("0"==d?$.mobile.changePage("/settings/custom/theme",
{allowSamePageTransition:!0,transition:"pop",reloadPage:!1,showLoadMsg:!1,changeHash:!0}):"undefined"!=typeof d&&($.mobile.loadingMessage="Applying Theme",$.mobile.loading("show"),c=$("#currently_selected_language_id").val(),$.ajax({type:"POST",url:"/settings/save/theme",async:!0,data:"theme_id="+d+"&language_id="+c,success:function(a){saved=$.parseJSON(a);var b,c,f,e,g,n;a=theme.icon;b=theme.disc;c=theme.body;f=theme.bars;e=theme.buttons;g=theme.controls;n=theme.actions;theme.icon=saved.icon;theme.disc=
saved.disc;theme.body=saved.body;theme.bars=saved.bars;theme.buttons=saved.buttons;theme.controls=saved.controls;theme.actions=saved.actions;theme.active=saved.active;$.mobile.loadingMessageTheme=theme.bars;"b"===a&&"b"!==theme.icon&&$(".inner-body").removeClass("ui-alt-icon");"w"===a&&"b"===theme.icon&&$(".inner-body").addClass("ui-alt-icon");"y"===b&&"y"!==theme.disc&&$(".inner-body").addClass("ui-nodisc-icon");"n"===b&&"y"===theme.disc&&$(".inner-body").removeClass("ui-nodisc-icon");$("#prev").attr("data-theme",
theme.controls).removeClass("ui-btn-"+e).removeClass("ui-btn-"+g).addClass("ui-btn-"+theme.controls);$("#playpause").attr("data-theme",theme.controls).removeClass("ui-btn-"+e).removeClass("ui-btn-"+g).addClass("ui-btn-"+theme.controls);$("#next").attr("data-theme",theme.controls).removeClass("ui-btn-"+e).removeClass("ui-btn-"+g).addClass("ui-btn-"+theme.controls);$('div[data-role="page"]').each(function(a){$(this).attr("data-theme",theme.buttons);$(this).attr("data-divider-theme",theme.bars);$(this).removeClass("ui-page-theme-"+
c).addClass("ui-page-theme-"+theme.body)});$('div[data-role="popup"]').each(function(a){$(this).attr("data-theme",theme.body).attr("data-overlay-theme",theme.body).removeClass("ui-body-"+c).addClass("ui-body-"+theme.body)});$('div[data-role="collapsible-set"]').each(function(a){$(this).attr("data-theme",theme.actions).removeClass("ui-group-theme-"+n).addClass("ui-group-theme-"+theme.actions)});$('div[data-role="header"]').each(function(a){$(this).attr("data-theme",theme.buttons).attr("data-divider-theme",
theme.bars).removeClass("ui-bar-"+f).addClass("ui-bar-"+theme.bars)});$('div[data-role="content"]').each(function(a){$(this).attr("data-theme",theme.buttons).attr("data-divider-theme",theme.bars)});$('div[data-role="footer"]').each(function(a){$(this).attr("data-theme",theme.buttons).attr("data-divider-theme",theme.bars).removeClass("ui-bar-"+f).addClass("ui-bar-"+theme.bars)});$('*[data-role="button"]').each(function(a){$(this).attr("data-theme",theme.buttons).removeClass("ui-btn-"+e).addClass("ui-btn-"+
theme.buttons)});$("#index").removeClass("ui-page-theme-"+c).addClass("ui-page-theme-"+theme.body);$("#libraryNav").attr("data-theme",theme.buttons).attr("data-divider-theme",theme.buttons);$("#libraryNav").removeClass("ui-group-theme-"+e).addClass("ui-group-theme-"+theme.buttons);$('#libraryNav li[data-role="list-divider"]').removeClass("ui-btn-"+e).removeClass("ui-btn-"+f).removeClass("ui-bar-"+f).addClass("ui-bar-"+theme.bars);$("#adminNav").attr("data-theme",theme.buttons).attr("data-divider-theme",
theme.buttons);$("#adminNav").removeClass("ui-group-theme-"+e).addClass("ui-group-theme-"+theme.buttons);$('#adminNav li[data-role="list-divider"]').removeClass("ui-btn-"+e).removeClass("ui-btn-"+f).removeClass("ui-bar-"+f).addClass("ui-bar-"+theme.bars);$("#settingsPopupMenu-screen").removeClass("ui-overlay-"+c).addClass("ui-overlay-"+theme.body);$('div[data-role="collapsible"] h2 a').each(function(a){$(this).removeClass("ui-btn-"+n).addClass("ui-btn-"+theme.actions)});$('div[data-role="collapsible"] div.ui-collapsible-content').removeClass("ui-body-"+
n).addClass("ui-body-"+theme.actions);$("#settingsPopupMenu ul").not('div[data-role="collapsible"] ul').each(function(a){$(this).attr("data-theme",theme.buttons).attr("data-divider-theme",theme.bars).removeClass("ui-group-theme-"+e).addClass("ui-group-theme-"+theme.buttons)});$('div[data-role="collapsible"] div.ui-collapsible-content ul').attr("data-theme",theme.actions).removeClass("ui-group-theme-"+n).removeClass("ui-group-theme-"+e).addClass("ui-group-theme-"+theme.actions);$("ul#availableThemes li").find("a.ui-icon-check").removeClass("ui-icon-check").addClass("ui-icon-minus");
$('ul#availableThemes li a[data-item-id="'+d+'"]').removeClass("ui-icon-minus").addClass("ui-icon-check").closest("li").attr("data-icon","check");$.mobile.loading("hide");$.mobile.loadingMessage="Loading"}})))});$("body").on("popupafterclose","#settingsPopupMenu",function(b,a){$("#settings_button").removeClass("ui-btn-hover-"+theme.actions).addClass("ui-btn-up-"+theme.buttons);$("#settingsPopupMenu .ui-collapsible").each(function(a){$(this).trigger("collapse")})});
$("body").on("sortstart","#queueTracksList",function(b,a){fromIndexOfItemBeingSorted=$(b.target).children().index(a.item[0])-1;$(b.target).children().eq(fromIndexOfItemBeingSorted);$("#queueTracksList").listview("refresh")});
$("body").on("sortupdate","#queueTracksList",function(b,a){toIndexOfItemBeingSorted=$(b.target).children().index(a.item[0])-1;movedTrack=playlist.tracks[fromIndexOfItemBeingSorted];var c=$("#queueTrack_"+fromIndexOfItemBeingSorted);movedTrack.mpd_index=toIndexOfItemBeingSorted.toString();delete playlist.tracks[fromIndexOfItemBeingSorted];if(fromIndexOfItemBeingSorted<toIndexOfItemBeingSorted)playlist.tracks=$.map(playlist.tracks,function(a){if("undefined"!=typeof a){if(parseInt(a.mpd_index)>fromIndexOfItemBeingSorted&&
parseInt(a.mpd_index)<=toIndexOfItemBeingSorted){var b=a.mpd_index,c=(parseInt(a.mpd_index)-1).toString();a.mpd_index=c;$("#queueTrack_"+b).attr("data-queue-track-index",c).attr("id","queueTrack_"+c)}return a}return null});else if(fromIndexOfItemBeingSorted>toIndexOfItemBeingSorted){for(i=playlist.tracks.length-1;0<=i;i--)if("undefined"!=typeof playlist.tracks[i]&&parseInt(playlist.tracks[i].mpd_index)>=toIndexOfItemBeingSorted&&parseInt(playlist.tracks[i].mpd_index)<fromIndexOfItemBeingSorted){var d=
playlist.tracks[i].mpd_index,h=(parseInt(playlist.tracks[i].mpd_index)+1).toString();$("#queueTrack_"+d).attr("data-queue-track-index",h).attr("id","queueTrack_"+h)}playlist.tracks=$.map(playlist.tracks,function(a){return"undefined"!=typeof a?(parseInt(a.mpd_index)>=toIndexOfItemBeingSorted&&parseInt(a.mpd_index)<fromIndexOfItemBeingSorted&&(console.log(parseInt(a.mpd_index)+" >= "+toIndexOfItemBeingSorted+" && "+parseInt(a.mpd_index)+" < "+fromIndexOfItemBeingSorted),a.mpd_index=(parseInt(a.mpd_index)+
1).toString()),a):null})}c.attr("data-queue-track-index",toIndexOfItemBeingSorted).attr("id","queueTrack_"+toIndexOfItemBeingSorted);playlist.tracks.splice(toIndexOfItemBeingSorted,0,movedTrack);post={parameters:[{from_pos:fromIndexOfItemBeingSorted,to_pos:toIndexOfItemBeingSorted}]};control_mpd("move_track",post.parameters[0]);a.item[0].dataset.queueTrackIndex=toIndexOfItemBeingSorted});
$("body").on("sortstop","#queueTracksList",function(b,a){$(a.item[0]).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);$("#queueTracksList").listview("refresh")});
$("body").on("click","#queue #queueTracksList li",function(b,a){var c=$(b.target).closest("li"),d=c.attr("data-queue-track-index"),h=c.attr("data-queue-track-file"),c=c.attr("id");idOfQueueTrackJustClicked="queueTrack_"+d;var m=$("#"+this.id),m=$("#queueTracksList li").index(m)-1;options={corners:!0,shadow:!0,history:!1,positionTo:this,transition:"pop"};$("#queueTrackPopupMenu").popup("open",options);$('#queueTrackPopupMenu a[data-id="playQueueTrack"]').attr("data-queue-track-index",d).attr("data-queue-track-true-index",
m).attr("data-queue-track-file",h);$('#queueTrackPopupMenu a[data-id="removeFromQueue"]').attr("data-queue-track-index",d).attr("data-queue-track-true-index",m).attr("data-source-id",c)});
$("body").on("click",'#queueTrackPopupMenu ul li a[data-id="playQueueTrack"]',function(b){var a=b.target.getAttribute("data-queue-track-index");$(b.target).children().index(this);b.target.getAttribute("data-queue-track-true-index");$("#queueTrack_"+a).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);$("#queueTrackPopupMenu").one("popupafterclose",function(b){skipto(a);$("html,body").animate({scrollTop:0},1200,function(){change_page("home",$.mobile.defaultPageTransition,
!1,!1,!0,null,null,!0,!1)})});$("#queueTrackPopupMenu").popup("close")});
$("body").on("click",'#queueTrackPopupMenu ul li a[data-id="removeFromQueue"]',function(b,a){var c=b.target.getAttribute("data-queue-track-index");$(b.target).children().index(this);var d=b.target.getAttribute("data-queue-track-true-index");$("#queueTrack_"+c).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);var h=b.target.getAttribute("data-source-id");$("#queueTrackPopupMenu").one("popupafterclose",function(a){post={parameters:[{index:d,id:h}]};control_mpd("remove",
post.parameters[0])});$("#queueTrackPopupMenu").popup("close")});$("body").on("popupafterclose","#queueTrackPopupMenu",function(b,a){""!==idOfQueueTrackJustClicked&&$("#"+idOfQueueTrackJustClicked).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons)});$("body").on("sortstart","#playlistTracks",function(b,a){fromIndexOfItemBeingSorted=$(b.target).children().index(a.item[0])-1;$(b.target).children().eq(fromIndexOfItemBeingSorted);$("#playlistTracks").listview("refresh")});
$("body").on("sortupdate","#playlistTracks",function(b,a){var c=a.item.context.parentElement.dataset.playlistName;toIndexOfItemBeingSorted=$(b.target).children().index(a.item[0])-1;post={parameters:[{playlist_name:c,from_pos:fromIndexOfItemBeingSorted,to_pos:toIndexOfItemBeingSorted}]};control_mpd("track_move",post.parameters[0]);a.item[0].dataset.playlistTrackIndex=toIndexOfItemBeingSorted});
$("body").on("sortstop","#playlistTracks",function(b,a){$(a.item[0]).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);$("#playlistTracks").listview("refresh")});
$("body").on("click","#playlistTracksPage #playlistTracks li",function(b,a){var c=$(b.target).closest("li"),d=c.attr("data-playlist-track-index"),h=c.attr("data-playlist-track-file"),c=c.attr("id");idOfPlaylistTrackJustClicked="playlistTrack_"+d;var m=$("#"+this.id),m=$("#playlistTracks li").index(m)-1;options={corners:!0,shadow:!0,history:!1,positionTo:this,transition:"pop"};$("#playlistTrackPopupMenu").popup("open",options);$('#playlistTrackPopupMenu a[data-id="addTrackToQueue"]').attr("data-playlist-track-index",
d).attr("data-playlist-track-file",h);$('#playlistTrackPopupMenu a[data-id="removeFromPlaylist"]').attr("data-playlist-track-index",d).attr("data-playlist-track-true-index",m).attr("data-source-id",c)});$("body").on("click","#settings_button",function(b,a){options={corners:!0,shadow:!0,history:!1,positionTo:this,transition:"slidedown"};$("#settingsPopupMenu").popup("open",options)});
$("body").on("click",'#playlistTrackPopupMenu ul li a[data-id="addTrackToQueue"]',function(b){var a=b.target.getAttribute("data-playlist-track-index");$(b.target).children().index(this);b=b.target.getAttribute("data-playlist-track-file");$("#playlistTrack_"+a).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);post={parameters:[{file:b}]};control_mpd("add",post.parameters[0]);$("#playlistTrackPopupMenu").popup("close")});
$("body").on("click",'#playlistTrackPopupMenu ul li a[data-id="removeFromPlaylist"]',function(b,a){var c=b.target.getAttribute("data-playlist-track-index");$(b.target).children().index(this);b.target.getAttribute("data-playlist-track-true-index");$("#playlistTrack_"+c).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);var d=b.target.getAttribute("data-source-id");$("#playlistTrackPopupMenu").popup("close");$("#"+d).slideUp("slow",function(){post={parameters:[{playlist_name:$("#playlistTracks").attr("data-playlist-name"),
pos:c}]};control_mpd("track_remove",post.parameters[0]);$("#"+d).remove()})});
$("body").on("click","#albumTracksPage #albumTracks li",function(b,a){var c=$(b.target).closest("li"),d=c.attr("data-album-track-index"),h=c.attr("data-album-track-file"),c=c.attr("id");idOfAlbumTrackJustClicked="albumTrack_"+d;var m={corners:!0,shadow:!0,history:!1,positionTo:this,transition:"pop"};$("#albumTrackPopupMenu").popup("open",m);$('#albumTrackPopupMenu ul li a[data-id="addTrackToQueue"]').attr("data-album-track-index",d).attr("data-album-track-file",h);$('#albumTrackPopupMenu ul div #availablePlaylists a[data-id="addTrackToPlaylist"]').attr("data-album-track-index",
d).attr("data-album-track-file",h).attr("data-source-id",c)});$("body").on("popupafterclose","#playlistTrackPopupMenu",function(b,a){""!==idOfPlaylistTrackJustClicked&&$("#"+idOfPlaylistTrackJustClicked).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons)});$("body").on("popupafterclose","#albumTrackPopupMenu",function(b,a){""!==idOfAlbumTrackJustClicked&&$("#"+idOfAlbumTrackJustClicked).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons)});
$("body").on("click",'#albumTrackPopupMenu ul li a[data-id="addTrackToQueue"]',function(b){var a=b.target.getAttribute("data-album-track-index");b=b.target.getAttribute("data-album-track-file");$("#albumTrack_"+a).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);post={parameters:[{file:b}]};control_mpd("add",post.parameters[0]);$("#albumTrackPopupMenu").popup("close")});
$("body").on("click",'#albumTrackPopupMenu ul div #availablePlaylists a[data-id="addTrackToPlaylist"]',function(b,a){var c=$(b.target).closest("li").attr("data-playlist-name"),d=b.target.getAttribute("data-album-track-index"),h=b.target.getAttribute("data-album-track-file");$("#albumTrack_"+d).removeClass("ui-btn-hover-"+theme.action).addClass("ui-btn-up-"+theme.buttons);post={parameters:[{playlist_name:c,file:h}]};control_mpd("track_add",post.parameters[0]);$("#albumTrackPopupMenu").popup("close")});
var mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,touchHandled;
function simulateMouseEvent(b,a){var c,d,h,m;b.originalEvent.type.match(/^touch/)?(c=b.touches[0].screenX,d=b.touches[0].screenY,h=b.touches[0].clientX,m=b.touches[0].clientY):b.originalEvent.type.match(/^(mouse|click)/)?(c=b.originalEvent.screenX,d=b.originalEvent.screenY,h=b.originalEvent.clientX,m=b.originalEvent.clientY):m=h=d=c=0;var k=document.createEvent("MouseEvents");k.initMouseEvent(a,!0,!0,window,1,c,d,h,m,!1,!1,!1,!1,0,null);b.target.dispatchEvent(k)}
$("body").on("taphold","#playlistTracksPage #playlistTracks li a.move .ui-btn-inner",function(b,a){"undefined"!=typeof navigator.notification&&navigator.notification.vibrate(50);$(b.target).closest("li")});$("body").on("focusin",'#artists input[data-type="search"], #albums input[data-type="search"]',function(b,a){$.mobile.loadingMessage="Retrieving all";$.mobile.loading("show");$("#index").lazyloader("option","retrieve","all").lazyloader("refresh","parameter","retrieve").lazyloader("loadMore",0)});
